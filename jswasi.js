if(typeof window==="undefined"){
var i="wash-cache",c=["./jswasi.js"];self.addEventListener("install",async()=>{await(await caches.open(i)).addAll(c)});async function n(e){return caches.match(e).then(async t=>{if(t===void 0&&(e.mode==="no-cors"&&(e=new Request(e.url,{cache:e.cache,credentials:"omit",headers:e.headers,integrity:e.integrity,destination:e.destination,keepalive:e.keepalive,method:e.method,mode:e.mode,redirect:e.redirect,referrer:e.referrer,referrerPolicy:e.referrerPolicy,signal:e.signal})),t=await fetch(e)),t.status===0)return t;let a=new Headers(t.headers);return a.set("Cross-Origin-Embedder-Policy","require-corp"),a.set("Cross-Origin-Opener-Policy","same-origin"),new Response(t.body,{status:t.status,statusText:t.statusText,headers:a})})}self.addEventListener("fetch",e=>{let t=e,a=t.request;t.respondWith(n(a))});
}else{
var fh=Object.defineProperty;var uh=(r,e,t)=>e in r?fh(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var fr=(r,e,t)=>(uh(r,typeof e!="symbol"?e+"":e,t),t);var Hf=URL.createObjectURL(new Blob([function(){var r=BigInt(1),e=BigInt(2),t=BigInt(4),n=BigInt(8),i=BigInt(16),s=BigInt(32),a=BigInt(64),o=BigInt(128),c=BigInt(256),f=BigInt(512),l=BigInt(1024),h=BigInt(2048),_=BigInt(4096),m=BigInt(8192),I=BigInt(16384),b=BigInt(32768),H=BigInt(65536),M=BigInt(131072),K=BigInt(262144),V=BigInt(524288),ie=BigInt(1048576),he=BigInt(2097152),Ae=BigInt(4194304),tt=BigInt(8388608),pn=BigInt(16777216),Sn=BigInt(33554432),Kt=BigInt(67108864),Xt=BigInt(134217728),Vn=BigInt(268435456),zn=BigInt(536870911),qt=r|e|i|o|he|Xt,Hr=r|a|i|o|he|Xt,Pt=0,gn=1,Ke=2,ve=3,vn=0,Ca=1,me=2,Oa=0,xa=1,jn=2,Wa=0,Kn=2,yf=1<<0,If=1<<1,Ra=0,Fa=1,Pi=2,Mi=3,Yr=4,Da=5,Na=6,mn=7;function $i(ge){let Z=[],lt="",Me=ge,dt="",wt=0;for(;Me!=="";)Me.indexOf("/")!==-1?dt=Me.substr(0,Me.indexOf("/")):dt=Me,Me=Me.substr(dt.length+1),dt===".."?wt>0&&(wt-=1):dt==="."||dt!=""&&(Z[wt]=dt,wt+=1);return lt=`/${Z.slice(0,wt).join("/")}`,lt=lt.replace("/./","/"),lt}function nr(ge){let Z=Math.trunc(ge),lt=BigInt(Math.round((ge-Z)*1e6));return BigInt(Z)*BigInt(1e6)+lt}function Gi(ge,Z){switch(ge){case gn:return nr(performance.now());case Pt:return nr(Date.now());case Ke:case ve:return nr(performance.now())-Z;default:return nr(performance.now())-Z}}var ka=0xc0000000n,Hi=30n,En=0x3fff0000n,Vr=16n,La=0x0000ff00n,Ba=8n,Ua=0x000000ffn,Xn=0n;function qn(ge){return{rw:Number((ge&ka)>>Hi),size:Number((ge&En)>>Vr),func:Number((ge&Ua)>>Xn),driver:Number((ge&La)>>Ba)}}var zr=nr(performance.now()),Mt,Ge,Yi,Er,Xe;onmessage=async ge=>{if(!Mt&&ge.data[0]==="start"){Mt=!0,[,Ge,Yi,Er,Xe]=ge.data;try{await yr()}catch(Z){se(["console",`Worker failed: ${Z}`])}}};function se(ge){postMessage([Yi,...ge])}function z(ge){Xe.DEBUG&&!(Xe.DEBUG==="0"||Xe.DEBUG==="false"||Xe.DEBUG==="")&&se(["console",ge])}function ir(ge){z("calling close()"),se(["proc_exit",ge]),self.close()}var Vi={0:xa,1:jn,2:Oa};function Pa(ge=!1){let Z;function lt(N){Z=N.exports}function Me(N,O){z(`environ_sizes_get(0x${N.toString(16)}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=Object.keys(Xe).length;k.setUint32(N,G,!0);let P=Object.entries(Xe).reduce((U,[x,B])=>U+new TextEncoder().encode(`${x}=${B}\0`).byteLength,0);return k.setUint32(O,P,!0),0}function dt(N,O){z(`environ_get(${N.toString(16)}, ${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new Uint8Array(Z.memory.buffer);return Object.entries(Xe).forEach(([P,U],x)=>{k.setUint32(N+x*4,O,!0);let B=new TextEncoder().encode(`${P}=${U}\0`);G.set(B,O),O+=B.byteLength}),0}function wt(N,O){z(`args_sizes_get(${N.toString(16)}, ${O.toString(16)})`);let k=new DataView(Z.memory.buffer);return k.setUint32(N,Er.length,!0),k.setUint32(O,new TextEncoder().encode(Er.join("")).byteLength+Er.length,!0),0}function ji(N,O){z(`args_get(${N}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new Uint8Array(Z.memory.buffer);return Er.forEach((P,U)=>{k.setUint32(N+U*4,O,!0);let x=new TextEncoder().encode(`${P}\0`);G.set(x,O),O+=x.byteLength}),0}function Ki(N,O){z(`fd_fdstat_get(${N}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new SharedArrayBuffer(4+24),P=new Int32Array(G,0,1);P[0]=-1;let U=new Uint8Array(G,4,1),x=new BigUint64Array(G,8,1),B=new BigUint64Array(G,16,1),$=new Uint8Array(G,24,1);se(["fd_fdstat_get",{sharedBuffer:G,fd:N}]),Atomics.wait(P,0,-1);let Y=Atomics.load(P,0);return Y!==0?(z(`fd_fdstat_get returned ${Y}`),Y):(k.setUint8(O,U[0]),k.setUint32(O+2,$[0],!0),k.setBigUint64(O+8,x[0],!0),k.setBigUint64(O+16,B[0],!0),z(`fd_fdstat_get returned ${Y} {file_type: ${U[0]} file_flags: 0 rights_base: ${x[0]} rights_inheriting: ${B}}`),0)}function Ma(N,O,k,G){z(`fd_write(${N}, ${O}, ${k}, ${G})`);let P=new DataView(Z.memory.buffer),U=0,x=[];for(let fe=0;fe<k;fe+=1){let de=O+fe*8,_e=P.getUint32(de,!0),Oe=P.getUint32(de+4,!0),We=new Uint8Array(Z.memory.buffer,_e,Oe);for(let we=0;we<We.byteLength;we+=1)x.push(We[we]);U+=We.byteLength}let B=new SharedArrayBuffer(4+4+U),$=new Int32Array(B,0,1),Y=new Int32Array(B,4,1);$[0]=-1;let q=Uint8Array.from(x);se(["fd_write",{sharedBuffer:B,fd:N,content:q}]),Atomics.wait($,0,-1);let Q=Atomics.load($,0);return Q===0?(z(`fd_write written ${Y} bytes.`),P.setUint32(G,Y[0],!0)):z(`fd_write returned ${Q}.`),Q}function Jn(N){z(`proc_exit(${N})`),ir(N)}function Qn(N,O){z(`random_get(${N}, ${O})`);let k=new Uint8Array(Z.memory.buffer),G=new Uint8Array(O);return crypto.getRandomValues(G),k.set(G,N),0}function Xi(N){return $e()}function Zn(N,O,k){return z(`clock_time_get(${N}, ${O}, ${k})`),new DataView(Z.memory.buffer).setBigUint64(k,Gi(N,zr),!0),0}function $a(N){z(`fd_close(${N})`);let O=new SharedArrayBuffer(4),k=new Int32Array(O,0,1);return k[0]=-1,se(["fd_close",{sharedBuffer:O,fd:N}]),Atomics.wait(k,0,-1),Atomics.load(k,0)}function Ga(N,O){z(`fd_filestat_get(${N}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new SharedArrayBuffer(4+64),P=new Int32Array(G,0,1);P[0]=-1;let U=new DataView(G,4);se(["fd_filestat_get",{sharedBuffer:G,fd:N}]),Atomics.wait(P,0,-1);let x=Atomics.load(P,0);if(x!==0)return z(`fd_filestat_get returned ${x}`),x;let B=U.getBigUint64(0,!0),$=U.getBigUint64(8,!0),Y=U.getUint8(16),q=U.getBigUint64(24,!0),Q=U.getBigUint64(32,!0),fe=U.getBigUint64(40,!0),de=U.getBigUint64(48,!0),_e=U.getBigUint64(56,!0);return ge?(k.setBigUint64(O,B,!0),k.setBigUint64(O+8,$,!0),k.setUint8(O+16,Y),k.setUint32(O+20,Number(q),!0),k.setBigUint64(O+24,Q,!0),k.setBigUint64(O+32,fe,!0),k.setBigUint64(O+40,de,!0),k.setBigUint64(O+48,_e,!0)):(k.setBigUint64(O,B,!0),k.setBigUint64(O+8,$,!0),k.setUint8(O+16,Y),k.setBigUint64(O+24,q,!0),k.setBigUint64(O+32,Q,!0),k.setBigUint64(O+40,fe,!0),k.setBigUint64(O+48,de,!0),k.setBigUint64(O+56,_e,!0)),z(`fd_filestat_get returned ${x} {dev: ${B} ino: ${$} fileType: ${Y} nlink: ${q} size: ${Q} atim: ${fe} mtim: ${de} ctim: ${_e}}`),0}function Ha(N,O,k,G){z(`fd_read(${N}, ${O}, ${k}, ${G})`);let P=new DataView(Z.memory.buffer),U=new Uint8Array(Z.memory.buffer),x=0;for(let B=0;B<k;B+=1){let $=P.getUint32(O+8*B,!0),Y=P.getUint32(O+8*B+4,!0),q=new SharedArrayBuffer(4+4+Y),Q=new Int32Array(q,0,1);Q[0]=-1;let fe=new Int32Array(q,4,1),de=new Uint8Array(q,8,Y);se(["fd_read",{sharedBuffer:q,fd:N,len:Y,offset:void 0}]),Atomics.wait(Q,0,-1);let _e=Atomics.load(Q,0);if(_e!==0)return _e;U.set(de,$),x+=fe[0]}return N>2&&z(`fd_read read ${x} bytes.`),P.setUint32(G,x,!0),0}function Ya(N,O,k,G,P){N>2&&z(`fd_pread(${N}, ${O}, ${k}, ${P})`);let U=new DataView(Z.memory.buffer),x=new Uint8Array(Z.memory.buffer),B=0;for(let $=0;$<k;$+=1){let Y=U.getUint32(O+8*$,!0),q=U.getUint32(O+8*$+4,!0),Q=new SharedArrayBuffer(4+4+q),fe=new Int32Array(Q,0,1);fe[0]=-1;let de=new Int32Array(Q,4,1),_e=new Uint8Array(Q,8,q);se(["fd_pread",{sharedBuffer:Q,fd:N,len:q,offset:G}]),Atomics.wait(fe,0,-1);let Oe=Atomics.load(fe,0);if(Oe!==0)return Oe;x.set(_e,Y),B+=de[0]}return N>2&&z(`fd_pread read ${B} bytes.`),U.setUint32(P,B,!0),0}function Va(N,O,k,G,P){z(`fd_readdir(${N}, ${O}, ${k}, ${G}, ${P})`);let U=new DataView(Z.memory.buffer),x=new Uint8Array(Z.memory.buffer),B=new SharedArrayBuffer(4+4+k),$=new Int32Array(B,0,1);$[0]=-1;let Y=new Uint32Array(B,4,1),q=new Uint8Array(B,8);se(["fd_readdir",{sharedBuffer:B,fd:N,cookie:G,bufLen:k}]),Atomics.wait($,0,-1);let Q=Atomics.load($,0);return Q!==0?Q:(x.set(q,O),U.setUint32(P,Y[0],!0),0)}function qi(N,O,k,G){z(`fd_seek(${N}, ${O}, ${k}, ${G})`);let P=new DataView(Z.memory.buffer),U=new SharedArrayBuffer(4+4+8),x=new Int32Array(U,0,1);x[0]=-1;let B=new BigUint64Array(U,8,1),$=ge?Vi[k]:k;se(["fd_seek",{sharedBuffer:U,fd:N,offset:O,whence:$}]),Atomics.wait(x,0,-1);let Y=Atomics.load(x,0);return z(`fd_seek returned ${Y}, file_pos = ${B[0]}`),Y!==0?Y:(P.setBigUint64(G,B[0],!0),0)}function za(N,O,k){let G=new Uint8Array(Z.memory.buffer),P=new TextDecoder().decode(G.slice(O,O+k));z(`path_create_directory(${N}, ${P}, ${k}) [path=${P}]`);let U=new SharedArrayBuffer(4),x=new Int32Array(U,0,1);return x[0]=-1,se(["path_create_directory",{sharedBuffer:U,fd:N,path:P}]),Atomics.wait(x,0,-1),Atomics.load(x,0)}function ja(N,O,k,G,P){let U=new DataView(Z.memory.buffer),x=new Uint8Array(Z.memory.buffer),B=new TextDecoder().decode(x.slice(k,k+G));z(`path_filestat_get(${N}, ${O}, ${B}, ${G}, 0x${P.toString(16)}) [path=${B}]`);let $=new SharedArrayBuffer(4+64),Y=new Int32Array($,0,1);Y[0]=-1;let q=new DataView($,4);se(["path_filestat_get",{sharedBuffer:$,fd:N,path:B,lookupFlags:O}]),Atomics.wait(Y,0,-1);let Q=Atomics.load(Y,0);if(z(`path_filestat_get returned ${Q}`),Q!==0)return Q;let fe=q.getBigUint64(0,!0),de=q.getBigUint64(8,!0),_e=q.getUint8(16),Oe=q.getBigUint64(24,!0),We=q.getBigUint64(32,!0),we=q.getBigUint64(40,!0),ht=q.getBigUint64(48,!0),rt=q.getBigUint64(56,!0);return ge?(U.setBigUint64(P,fe,!0),U.setBigUint64(P+8,de,!0),U.setUint8(P+16,_e),U.setUint32(P+20,Number(Oe),!0),U.setBigUint64(P+24,We,!0),U.setBigUint64(P+32,we,!0),U.setBigUint64(P+40,ht,!0),U.setBigUint64(P+48,rt,!0)):(U.setBigUint64(P,fe,!0),U.setBigUint64(P+8,de,!0),U.setUint8(P+16,_e),U.setBigUint64(P+24,Oe,!0),U.setBigUint64(P+32,We,!0),U.setBigUint64(P+40,we,!0),U.setBigUint64(P+48,ht,!0),U.setBigUint64(P+56,rt,!0)),0}function Ka(N,O,k,G,P,U,x,B,$){let Y=new DataView(Z.memory.buffer),q=new Uint8Array(Z.memory.buffer),Q=new TextDecoder().decode(q.slice(k,k+G));z(`path_open(dirFd=${N}, lookupFlags=${O}, pathPtr=0x${k.toString(16)}, pathLen=${G}, openFlags=${P}, fsRightsBase=${U}, fsRightsInheriting=${x}, fdFlags=${B}, openedFdPtr=0x${$.toString(16)}) [path=${Q}]`);let fe=new SharedArrayBuffer(4+4),de=new Int32Array(fe,0,1);de[0]=-1;let _e=new Int32Array(fe,4,1);se(["path_open",{sharedBuffer:fe,dirFd:N,path:Q,lookupFlags:O,openFlags:P,fsRightsBase:U,fsRightsInheriting:x,fdFlags:B}]),Atomics.wait(de,0,-1);let Oe=Atomics.load(de,0);return Oe!==0?Oe:(Y.setUint32($,_e[0],!0),0)}function Ji(N,O){let{command:k,buf_len:G,buf_ptr:P}=JSON.parse(N),U=new TextDecoder().decode(new Uint8Array(Z.memory.buffer,P,G));switch(k){case"spawn":{if(O.byteLength<8)return{exitStatus:42,outputSize:0};let x=new SharedArrayBuffer(4+4),B=new Int32Array(x,0,1);B[0]=-1;let{path:$,args:Y,extended_env:q,redirects_ptr:Q,n_redirects:fe,background:de}=JSON.parse(U);z(`${$} ${Y} ${q} ${de} ${Q}, ${fe}`);let _e=new DataView(Z.memory.buffer),Oe=[],We=Q;for(let Gt=0;Gt<fe;Gt++){let At=We,yn=_e.getUint32(We+8,!0),Kr=_e.getUint32(We+8+4,!0);We+=8+4+4;let ar={type:Kr,fd_dst:yn,path:void 0,fd_src:void 0};switch(Kr){case Ra:case Fa:case Pi:case Mi:{let Xr=_e.getUint32(At,!0),or=_e.getUint32(At+4,!0),is=new TextDecoder().decode(_e.buffer.slice(Xr,Xr+or));ar.path=is;break}case Yr:case Da:case Na:{let Xr=_e.getUint32(At,!0);ar.fd_src=Xr;break}case mn:break;default:return z(`Spawn: redirect type ${Kr} not found.`),{exitStatus:28,outputSize:0}}Oe.push(ar),z(`Redirect[${Gt}] = type: ${ar.type}, fd_dst: ${ar.fd_dst}, path: ${ar.path}, fd_src: ${ar.fd_src}`)}se(["spawn",{path:$,args:Y,env:{...Xe,...q},sharedBuffer:x,background:de,redirects:Oe}]),Atomics.wait(B,0,-1);let we=Atomics.load(B,0),ht=new Int32Array(x,4,1),rt=new Uint32Array(2),$t=0;rt[0]=0,rt[1]=Atomics.load(ht,0),we!==0&&(z(`error: spawned process returned ${we}`),we===45?(rt[0]=45,$t=1):$t=we);let sr=new Uint8Array(rt.buffer,0,8);return O.set(sr,0),{exitStatus:$t,outputSize:8}}case"chdir":{let x=new SharedArrayBuffer(4),B=new Int32Array(x,0,1);B[0]=-1;let{dir:$}=JSON.parse(U);z(`chdir(${$})`);let Y=$i($);se(["chdir",{dir:Y,sharedBuffer:x}]),Atomics.wait(B,0,-1);let q=Atomics.load(B,0);return z(`chdir returned ${q}`),{exitStatus:q,outputSize:0}}case"getcwd":{let{buf_len:x}=JSON.parse(U);z(`getcwd(${x})`);let B=new SharedArrayBuffer(4+4+x),$=new Int32Array(B,0,1),Y=new Uint32Array(B,4,1),q=new Uint8Array(B,8,x);$[0]=-1,se(["getcwd",{bufLen:x,sharedBuffer:B}]),Atomics.wait($,0,-1);let Q=Atomics.load($,0),fe=Q===0?new TextDecoder().decode(q.slice(0,Y[0])):void 0;return z(`getcwd returned ${fe}`),O.byteLength<=Y[0]?{exitStatus:42,outputSize:0}:(O.set(q.slice(0,Y[0]),0),O.set([0],Y[0]),{exitStatus:Q,outputSize:Y[0]})}case"set_env":{let x=new SharedArrayBuffer(4),B=new Int32Array(x,0,1);B[0]=-1;let{key:$,value:Y}=JSON.parse(U);return z(`set_env(${$}, ${Y})`),se(["set_env",{key:$,value:Y,sharedBuffer:x}]),Atomics.wait(B,0,-1),Atomics.load(B,0)===0&&(Y===void 0?delete Xe[$]:Xe[$]=Y),{exitStatus:0,outputSize:0}}case"set_echo":{let x=new SharedArrayBuffer(4),B=new Int32Array(x,0,1);B[0]=-1;let{echo:$}=JSON.parse(U);return z(`set_echo(${$})`),se(["set_echo",{shouldEcho:$,sharedBuffer:x}]),Atomics.wait(B,0,-1),{exitStatus:0,outputSize:0}}case"isatty":{if(O.byteLength<4)return{exitStatus:42,outputSize:0};let x=new SharedArrayBuffer(8),B=new Int32Array(x,0,1);B[0]=-1;let{fd:$}=JSON.parse(U);z(`isatty(${$})`),se(["isatty",{sharedBuffer:x,fd:$}]),Atomics.wait(B,0,-1);let Y=Atomics.load(B,0),q=new Uint8Array(x,4,4);return O.set(q.slice(0,4),0),{exitStatus:Y,outputSize:4}}case"getpid":{if(O.byteLength<4)return{exitStatus:42,outputSize:0};let x=new SharedArrayBuffer(8),B=new Int32Array(x,0,1),$=new Int32Array(x,4,1);B[0]=-1,$[0]=-1,z("getpid()"),se(["getpid",{sharedBuffer:x}]),Atomics.wait(B,0,-1);let Y=new Uint8Array(x,4,4);return O.set(Y,0),{exitStatus:0,outputSize:4}}case"event_source_fd":{if(O.byteLength<4)return{exitStatus:42,outputSize:0};let{event_mask:x}=JSON.parse(U),B=new SharedArrayBuffer(4+4),$=new Int32Array(B,0,1);if(z(`event_source_fd(${x})`),x===Wa||x>=1<<Kn)return{exitStatus:28,outputSize:0};$[0]=-1,se(["event_source_fd",{sharedBuffer:B,eventMask:x}]),Atomics.wait($,0,-1);let Y=Atomics.load($,0),q=new Uint8Array(B,4,4);return O.set(q,0),{exitStatus:Y,outputSize:4}}case"attach_sigint":{let{event_source_fd:x}=JSON.parse(U),B=new SharedArrayBuffer(4+4),$=new Int32Array(B,0,1);return $[0]=-1,z(`attach_sigint(${x})`),se(["attach_sigint",{sharedBuffer:B,fd:x}]),Atomics.wait($,0,-1),{exitStatus:Atomics.load($,0),outputSize:0}}case"clean_inodes":{let x=new SharedArrayBuffer(4),B=new Int32Array(x,0,1);return z("clean_inodes()"),B[0]=-1,se(["clean_inodes",{sharedBuffer:x}]),Atomics.wait(B,0,-1),{exitStatus:Atomics.load(B,0),outputSize:0}}case"kill":{let{process_id:x,signal:B}=JSON.parse(U),$=new SharedArrayBuffer(4),Y=new Int32Array($,0,1);return Y[0]=-1,z(`kill(${x}, ${B})`),se(["kill",{sharedBuffer:$,processId:x,signalNumber:B}]),Atomics.wait(Y,0,-1),{exitStatus:Atomics.load(Y,0),outputSize:0}}case"ioctl":{let{fd:x,cmd:B}=JSON.parse(U),{size:$,rw:Y,func:q}=qn(BigInt(B)),Q=new SharedArrayBuffer(4+$),fe=new Int32Array(Q,0,1),de=new Uint8Array(Q,4,$);z(`ioctl(${x}, ${B})`),fe[0]=-1,(Y===3||Y===1)&&de.set(O),se(["ioctl",{sharedBuffer:Q,fd:x,command:q}]),Atomics.wait(fe,0,-1);let _e=0;return(Y===3||Y===2)&&(O.set(de),_e=$),{exitStatus:Atomics.load(fe,0),outputSize:_e}}case"mount":{let{source_fd:x,source:B,source_len:$,target_fd:Y,target:q,target_len:Q,filesystemtype:fe,filesystemtype_len:de,mountflags:_e,data:Oe,data_len:We}=JSON.parse(U),we=new Uint8Array(Z.memory.buffer),ht=new TextDecoder().decode(we.slice(B,B+$)),rt=new TextDecoder().decode(we.slice(q,q+Q)),$t=new TextDecoder().decode(we.slice(fe,fe+de)),sr=new TextDecoder().decode(we.slice(Oe,Oe+We));z(`mount(${x}, "${ht}", ${$}, ${Y}, "${rt}", ${Q}, "${$t}", ${de}, ${_e}, "${sr}", ${We})`);let Gt=new SharedArrayBuffer(4),At=new Int32Array(Gt,0,1);At[0]=-1,se(["mount",{sharedBuffer:Gt,sourceFd:x,sourcePath:ht,targetFd:Y,targetPath:rt,filesystemType:$t,mountFlags:_e,data:sr}]),Atomics.wait(At,0,-1);let yn=Atomics.load(At,0);return z(`mount returned ${yn}`),{exitStatus:yn,outputSize:0}}case"umount":{let{path:x,path_len:B}=JSON.parse(U),$=new Uint8Array(Z.memory.buffer),Y=new TextDecoder().decode($.slice(x,x+B));z(`umount("${Y}", ${B}`);let q=new SharedArrayBuffer(4),Q=new Int32Array(q,0,1);Q[0]=-1,se(["umount",{path:Y,sharedBuffer:q}]),Atomics.wait(Q,0,-1);let fe=Atomics.load(Q,0);return z(`umount returned ${fe}`),{exitStatus:fe,outputSize:0}}default:throw z(`Special command ${k} not found.`),Error(`Special command '${k} not found.`)}}function Xa(N,O,k,G,P,U){z(`path_readlink(${N}, ${O}, ${k}, ${G}, ${P}, ${U})`);let x=new Uint8Array(Z.memory.buffer),B=new DataView(Z.memory.buffer),$=new TextDecoder().decode(x.slice(O,O+k));if(z(`path is ${$}, buffer_len = ${P}, fd = ${N}`),$[0]==="!"){let _e=G!==0?new Uint8Array(Z.memory.buffer,G,P):new Uint8Array,{exitStatus:Oe,outputSize:We}=Ji($.slice(1),_e);return Oe!==42&&G!==0&&B.setUint32(U,We,!0),Oe}let Y=new SharedArrayBuffer(4+P+4),q=new Int32Array(Y,0,1);q[0]=-1;let Q=new Int32Array(Y,4,1),fe=new Uint8Array(Y,8,P);se(["path_readlink",{sharedBuffer:Y,fd:N,path:$,bufferLen:P}]),Atomics.wait(q,0,-1);let de=Atomics.load(q,0);return de!==0?de:(x.set(fe,G),B.setUint32(U,Q[0],!0),0)}function Qi(N,O,k){z(`path_remove_directory(${N}, ${O}, ${k})`);let G=new Uint8Array(Z.memory.buffer),P=new TextDecoder().decode(G.slice(O,O+k)),U=new SharedArrayBuffer(4),x=new Int32Array(U,0,1);return x[0]=-1,se(["path_remove_directory",{sharedBuffer:U,fd:N,path:P}]),Atomics.wait(x,0,-1),Atomics.load(x,0)}function qa(N,O,k,G,P,U){let x=new Uint8Array(Z.memory.buffer),B=new TextDecoder().decode(x.slice(O,O+k)),$=new TextDecoder().decode(x.slice(P,P+U));z(`path_rename(${N}, ${B}, ${k}, ${G}, ${$}, ${U})`);let Y=new SharedArrayBuffer(4),q=new Int32Array(Y,0,1);return q[0]=-1,se(["path_rename",{sharedBuffer:Y,oldFd:N,oldPath:B,newFd:G,newPath:$}]),Atomics.wait(q,0,-1),Atomics.load(q,0)}function Ja(N,O,k){z(`path_unlink_file(${N}, ${O}, ${k})`);let G=new Uint8Array(Z.memory.buffer),P=new TextDecoder().decode(G.slice(O,O+k)),U=new SharedArrayBuffer(4),x=new Int32Array(U,0,1);return x[0]=-1,se(["path_unlink_file",{sharedBuffer:U,fd:N,path:P}]),Atomics.wait(x,0,-1),Atomics.load(x,0)}function Zi(){return $e()}function Qa(N,O){z(`fd_prestat_get(${N}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new SharedArrayBuffer(4+4+1),P=new Int32Array(G,0,1);P[0]=-1;let U=new Int32Array(G,4,1),x=new Uint8Array(G,8,1);se(["fd_prestat_get",{sharedBuffer:G,fd:N}]),Atomics.wait(P,0,-1);let B=Atomics.load(P,0);return B===0?(k.setUint8(O,x[0]),k.setUint32(O+4,U[0],!0),z(`fd_prestat_get returned filetype type ${x[0]} of size ${U[0]}`)):z(`fd_prestat_get returned ${B}`),B}function Ir(N,O,k){z(`fd_prestat_dir_name(${N}, 0x${O.toString(16)}, ${k})`);let G=new Uint8Array(Z.memory.buffer),P=new SharedArrayBuffer(4+k),U=new Int32Array(P,0,1);U[0]=-1;let x=new Uint8Array(P,4,k);se(["fd_prestat_dir_name",{sharedBuffer:P,fd:N,pathLen:k}]),Atomics.wait(U,0,-1);let B=Atomics.load(U,0);B===0&&G.set(x,O);let $=new TextDecoder().decode(G.slice(O,O+k));return z(`prestat returned ${B}, "${$}" of size ${k}`),B}function Za(){return $e()}function jr(){return $e()}function eo(){return $e()}function to(N,O,k,G,P){z(`path_symlink(0x${N.toString(16)}, ${O}, ${k}, 0x${G.toString(16)}, ${P})`);let U=new Uint8Array(Z.memory.buffer),x=new TextDecoder().decode(U.slice(N,N+O)),B=new TextDecoder().decode(U.slice(G,G+P));z(`path_symlink: ${B} --> ${x}`);let $=new SharedArrayBuffer(4),Y=new Int32Array($,0,1);Y[0]=-1,se(["path_symlink",{sharedBuffer:$,targetPath:x,linkFd:k,linkPath:B}]),Atomics.wait(Y,0,-1);let q=Atomics.load(Y,0);return z(`path_symlink returned ${q}`),q}function es(N,O,k,G,P,U,x){z(`path_link(${N}, ${O}, ${k}, ${G}, ${P}, ${U}, ${x})`);let B=new Uint8Array(Z.memory.buffer),$=new TextDecoder().decode(B.slice(k,k+G)),Y=new TextDecoder().decode(B.slice(U,U+x));z(`path_link: ${Y} -> ${$}`);let q=new SharedArrayBuffer(4),Q=new Int32Array(q,0,1);return Q[0]=-1,se(["path_link",{sharedBuffer:q,oldFd:N,oldFlags:O,oldPath:$,newFd:P,newPath:Y}]),Atomics.wait(Q,0,-1),Atomics.load(Q,0)}function ro(N,O,k,G){z(`poll_oneoff(${N}, ${O}, ${k}, ${G})`);let P=new DataView(Z.memory.buffer),U=new SharedArrayBuffer(32*k);var x=BigInt(Number.MAX_SAFE_INTEGER);let B=new Array,$,Y;for(let de=0;de<k;de+=1){let _e=P.getBigUint64(N,!0);N+=8;let Oe=P.getUint8(N);N+=1;let We;switch(Oe){case vn:{N+=7;let we=P.getUint32(N,!0);N+=8;let ht=P.getBigUint64(N,!0);N+=8;let rt=P.getBigUint64(N,!0);N+=8;let $t=P.getUint16(N,!0);N+=8;let sr=$t===1;z(`clockId = ${we}, timeout = ${ht}, precision = ${rt}, absolute = ${sr}`);let Gt=Gi(we,zr),At=sr?ht:Gt+ht;x>At&&(x=At,Y={clockId:we,timeout:ht,precision:rt,flags:$t},$=_e);continue}case me:case Ca:{N+=7;let we=P.getUint32(N,!0);N+=32,z(`read data from fd = ${we}`),We={fd:we};break}default:return 28}We&&B.push({userdata:_e,eventType:Oe,event:We})}Y&&B.push({userdata:$,eventType:vn,event:Y});let q=new SharedArrayBuffer(4+4),Q=new Int32Array(q,0,2);Q[0]=-1,Q[1]=0,B.length>0&&(se(["poll_oneoff",{sharedBuffer:q,subs:B,eventBuf:U,timeout:x}]),Atomics.wait(Q,0,-1));let fe=Q[1];return new Uint8Array(Z.memory.buffer,O,fe*32).set(new Uint8Array(U,0,fe*32)),P.setInt32(G,fe,!0),0}let $e=()=>(z(`> Entering stub ${new Error().stack.split(`
`)[2].trim().split(" ")[1]}`),0);function ei(){return $e()}function ti(){return $e()}function ri(){return $e()}function ts(N,O){z(`fd_fdstat_set_flags(${N}, ${O})`);let k=new SharedArrayBuffer(4),G=new Int32Array(k,0,1);G[0]=-1,se(["fd_fdstat_set_flags",{sharedBuffer:k,fd:N,flags:O}]),Atomics.wait(G,0,-1);let P=Atomics.load(G,0);return z(`fd_fdstat_set_flags returned error: ${P}`),P}function no(){return $e()}function io(N,O){z(`fd_renumber(${N}, ${O})`);let k=new SharedArrayBuffer(4),G=new Int32Array(k,0,1);G[0]=-1,se(["fd_renumber",{sharedBuffer:k,fd:N,newFd:O}]),Atomics.wait(G,0,-1);let P=Atomics.load(G,0);return z(`fd_renumber returned error: ${P}`),P}function so(N,O){z(`fd_tell(${N}, 0x${O.toString(16)})`);let k=new DataView(Z.memory.buffer),G=new SharedArrayBuffer(8+4),P=new BigInt64Array(G,0,1),U=new Int32Array(G,8,1);U[0]=-1,se(["fd_tell",{sharedBuffer:G,fd:N}]),Atomics.wait(U,0,-1);let x=Atomics.load(U,0);return x===0?(k.setBigUint64(O,P[0],!0),z(`fd_tell returned offset: ${P[0]}`)):z(`fd_tell returned error: ${x}`),x}function ao(N,O,k,G,P,U,x){z(`path_filestat_set_times(${N}, ${O}, ${k}, ${G}, ${P}, ${U}, ${x})`);let B=new Uint8Array(Z.memory.buffer),$=new TextDecoder().decode(B.slice(k,k+G)),Y=new SharedArrayBuffer(4),q=new Int32Array(Y,0,1);q[0]=-1,se(["path_filestat_set_times",{sharedBuffer:Y,fd:N,flags:O,path:$,st_atim:P,st_mtim:U,fst_flags:x}]),Atomics.wait(q,0,-1);let Q=Atomics.load(q,0);return z(`path_filestat_set_times returned ${Q}`),Q}function oo(){return $e()}function rs(){return $e()}function co(){return $e()}function ni(){return $e()}function fo(){return $e()}function ns(){return $e()}function Jt(N,O,k,G){z(`fd_filestat_set_times(${N}, ${O}, ${k}, ${G})`);let P=new SharedArrayBuffer(4),U=new Int32Array(P,0,1);U[0]=-1,se(["fd_filestat_set_times",{sharedBuffer:P,fd:N,st_atim:O,st_mtim:k,fst_flags:G}]),Atomics.wait(U,0,-1);let x=Atomics.load(U,0);return z(`fd_filestat_set_times returned ${x}`),x}return{setModuleInstance:lt,environ_sizes_get:Me,args_sizes_get:wt,fd_prestat_get:Qa,fd_fdstat_get:Ki,fd_filestat_get:Ga,fd_read:Ha,fd_write:Ma,fd_prestat_dir_name:Ir,environ_get:dt,args_get:ji,poll_oneoff:ro,proc_exit:Jn,fd_close:$a,fd_seek:qi,random_get:Qn,clock_time_get:Zn,fd_readdir:Va,path_create_directory:za,path_filestat_get:ja,path_link:es,path_open:Ka,path_readlink:Xa,path_remove_directory:Qi,path_rename:qa,path_unlink_file:Ja,sched_yield:Zi,fd_datasync:Za,fd_filestat_set_size:jr,fd_sync:eo,path_symlink:to,clock_res_get:Xi,fd_advise:ns,fd_allocate:ti,fd_fdstat_set_flags:ts,fd_fdstat_set_rights:ri,fd_tell:so,fd_filestat_set_times:Jt,fd_pread:Ya,fd_advice:ei,fd_pwrite:no,fd_renumber:io,path_filestat_set_times:ao,proc_raise:oo,sock_accept:rs,sock_recv:co,sock_send:ni,sock_shutdown:fo}}async function zi(ge,Z){let lt=WebAssembly.Module.imports(ge),Me;if(lt[0].module==="wasi_unstable")Me=Z(!0);else if(lt[0].module==="wasi_snapshot_preview1")Me=Z(!1);else throw Error("Unsupported wasm format");let dt={wasi_snapshot_preview1:Me,wasi_unstable:Me};if(WebAssembly.instantiate){z("WebAssembly.instantiate");let wt=await WebAssembly.instantiate(ge,dt);Me.setModuleInstance(wt);try{wt.exports._start(),ir(0)}catch(ji){z(`error: ${ji}`),ir(255)}}else z("WebAssembly.instantiate is not supported")}async function yr(){if(Mt&&Ge){z("Loading a module");try{await zi(Ge,Pa)}catch(ge){z(`Failed instantiating WASM module: ${ge}`),ir(255)}z("done.")}else setTimeout(()=>{yr()},0)}}.toString().slice(11,-1)],{type:"text/javascript"}));var Yf=BigInt(1),ci=BigInt(2),Vf=BigInt(4),Cg=BigInt(8),zf=BigInt(16),jf=BigInt(32),An=BigInt(64),Kf=BigInt(128),Og=BigInt(256),xg=BigInt(512),Wg=BigInt(1024),Rg=BigInt(2048),Fg=BigInt(4096),Dg=BigInt(8192),Ng=BigInt(16384),kg=BigInt(32768),Lg=BigInt(65536),Bg=BigInt(131072),Io=BigInt(262144),Ug=BigInt(524288),Pg=BigInt(1048576),fi=BigInt(2097152),Mg=BigInt(4194304),Xf=BigInt(8388608),$g=BigInt(16777216),Gg=BigInt(33554432),Hg=BigInt(67108864),qf=BigInt(134217728),Yg=BigInt(268435456),Be=BigInt(536870911),Jf=Yf|ci|zf|Kf|fi|qf,wo=Yf|An|zf|Kf|fi|qf,Qf=wo;var Zf=0,br=1,ls=2;var Ye=1,nt=2,Qr=4,bn=8,eu=0;var tu=2,Tn=0,Tr=1,Cn=2,Ao=1,bo=2,To=4,Co=8;var Ht=0;var ru=1<<0,Yt=1<<1,Oo=0,xo=1,Wo=2,Ro=3,nu=4,iu=5,su=6,au=7;var ui=class{fdstat;path;async getFdstat(){return this.fdstat}async initialize(e){return this.path=e,0}getPath(){return this.path}async setFdstatFlags(e){return this.fdstat.fs_flags=e,0}async setFdstatRights(e,t){return this.fdstat.fs_rights_base=e,this.fdstat.fs_rights_inheriting=t,0}async ioctl(e,t){return 59}async mountFs(e){return{err:58,fs:void 0}}},Cr=class extends ui{isatty(){return!1}async readdir(e){return{err:54,dirents:void 0}}},Or=class extends ui{async close(){return 31}async read(e,t){return{err:31,buffer:void 0}}async read_str(){return{err:31,content:void 0}}async pread(e,t){return{err:31,buffer:void 0}}async arrayBuffer(){return{err:31,buffer:void 0}}async write(e){return{err:31,written:-1n}}async pwrite(e,t){return{err:31,written:-1n}}async seek(e,t){return{err:31,offset:-1n}}async writableStream(){return{err:31,stream:void 0}}isatty(){return!1}async truncate(e){return 31}addPollSub(e,t,n){return Promise.resolve({userdata:e,error:58,eventType:t,nbytes:0n})}},On=class extends ui{constructor(e,t,n){super(),this.fdstat={fs_flags:e,fs_rights_base:t,fs_rights_inheriting:n,fs_filetype:2}}async getFilestat(){return{err:8,filestat:void 0}}async setFilestatTimes(e,t){return 8}async close(){return 8}async read(e,t){return{err:8,buffer:void 0}}async read_str(){return{err:8,content:void 0}}async pread(e,t){return{err:8,buffer:void 0}}async arrayBuffer(){return{err:8,buffer:void 0}}async write(e){return{err:8,written:-1n}}async pwrite(e,t){return{err:8,written:-1n}}async seek(e,t){return{err:8,offset:-1n}}async readdir(e){return{err:8,dirents:void 0}}async writableStream(){return{err:8,stream:void 0}}async truncate(e){return 8}addPollSub(e,t,n){return Promise.resolve({userdata:e,error:58,eventType:t,nbytes:0n})}};var en=class extends On{eventMask;signalSub;events;stopResolver;constructor(e,t,n,i){super(e,t,n),this.eventMask=i,this.events=Ht,this.stopResolver=void 0,this.signalSub=void 0}getFilestat(){return Promise.resolve({err:0,filestat:{dev:0n,ino:0n,filetype:this.fdstat.fs_filetype,nlink:0n,size:0n,mtim:0n,atim:0n,ctim:0n}})}async setFilestatTimes(e,t){return 0}async close(){return this.stopResolver&&this.stopResolver.resolve(this),0}async read(e,t){if(e<4)return{err:42,buffer:void 0};let n=new ArrayBuffer(4),i=new Uint32Array(n);return i[0]=this.events,this.events=Ht,Promise.resolve({err:0,buffer:n})}isatty(){return!1}addPollSub(e,t,n){return new Promise(i=>{this.events!==Ht?i({userdata:e,eventType:this.events,nbytes:4n,error:0}):this.signalSub={pid:n,userdata:e,tag:t,resolve:i}})}sendEvents(e){this.events|=e&this.eventMask,this.events!==Ht&&this.signalSub!==void 0&&(this.signalSub.resolve({userdata:this.signalSub.userdata,error:0,eventType:br,nbytes:4n}),this.signalSub=void 0)}obtainEvents(e){let t=this.events&e;return this.events^=t,t}makeNotifier(e){return this.eventMask&Yt?(this.stopResolver!==void 0&&this.stopResolver.resolve(this),this.stopResolver=e,0):(e.reject(),28)}};function ou(r){let e=[],t="",n=r,i="",s=0;for(;n!=="";)n.indexOf("/")!==-1?i=n.substr(0,n.indexOf("/")):i=n,n=n.substr(i.length+1),i===".."?s>0&&(s-=1):i==="."||i!=""&&(e[s]=i,s+=1);return t=`/${e.slice(0,s).join("/")}`,t=t.replace("/./","/"),t}function Do(r){let e=Math.trunc(r),t=BigInt(Math.round((r-e)*1e6));return BigInt(e)*BigInt(1e6)+t}function Ve(r){return r=="/"?"/":r.slice(r.lastIndexOf("/")+1)}function Vt(r){let e=r.lastIndexOf("/");return e<1&&e++,r.slice(0,e)}function ds(r){switch(r.toLowerCase().trim()){case"yes":case"on":case"true":return!0;case"no":case"off":case"false":return!1;default:return}}function ze(r){return`[${String((window.performance.now()/1e3).toFixed(6)).padStart(12," ")}] ${r}`}function hs(r){let e=["B","kB","MB","GB","TB","PB"],t=r,n=0;for(;t>=1024&&n+1<e.length;)t/=1024,n+=1;return`${t.toFixed(1)}${e[n]}`}async function cu(r,e,t,n,i){let s=i.getDesc(1),a=`  PID TTY          TIME CMD\r
`;for(let[o,c]of Object.entries(r.processInfos)){let f=new Date,l=Math.floor(f.getTime()/1e3)-c.timestamp,h=l%60,_=(l-h)/60%60,m=(l-h-_*60)/60/60;a+=`${`     ${o}`.slice(-5)} pts/0    ${`00${m}`.slice(-2)}:${`00${_}`.slice(-2)}:${`00${h}`.slice(-2)} ${c.cmd.split("/").slice(-1)[0]}\r
`}return a+=`-1 pts/0    00:00:00 ps\r
`,await s.write(new TextEncoder().encode(a)),s.close(),0}async function fu(r,e,t,n,i){let s=i.getDesc(1),a=performance.memory.jsHeapSizeLimit,o=performance.memory.usedJSHeapSize,c="",f="",l="";t.length>1&&t[1]==="-h"?(c=hs(a),f=hs(o),l=hs(a-o)):(c=`${Math.round(a/1024)}`,f=`${Math.round(o/1024)}`,l=`${Math.round((a-o)/1024)}`);let h=`               total        used   available\r
`;return h+=`Mem:      ${`          ${c}`.slice(-10)}  ${`          ${f}`.slice(-10)}  ${`          ${l}`.slice(-10)}\r
`,await s.write(new TextEncoder().encode(h)),0}async function uu(r,e,t,n,i){return location.reload(),0}function li(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function hh(r,e){let t=Promise.resolve().then(()=>{let n=indexedDB.open(r);return n.onupgradeneeded=()=>n.result.createObjectStore(e),li(n)});return(n,i)=>t.then(s=>i(s.transaction(e,n).objectStore(e)))}var No;function _s(){return No||(No=hh("keyval-store","keyval")),No}function lu(r,e=_s()){return e("readonly",t=>li(t.get(r)))}function du(r,e,t=_s()){return t("readwrite",n=>(n.put(e,r),li(n.transaction)))}function hu(r,e=_s()){return e("readwrite",t=>(t.delete(r),li(t.transaction)))}function _h(r,e){return r("readonly",t=>(t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},li(t.transaction)))}function _u(r=_s()){let e=[];return _h(r,t=>e.push(t.key)).then(()=>e)}async function ko(r){hu(r)}async function ur(r){return lu(r)}async function xr(r,e){du(r,e)}async function pu(){return _u()}async function nn(r){return(await(await navigator.storage.getDirectory()).resolve(r)).join("/")}async function Su(r,e){return navigator.storage.getDirectory().then(async t=>await t.getDirectoryHandle(r,{create:e}))}function sn(r,e){switch(r.name){case"NotAllowedError":return 2;case"TypeMismatchError":return e?54:31;case"NotFoundError":return 44;case"InvalidModificationError":return 55;case"QuotaExceededError":return 19;default:return 28}}function gu(r,e,t,n,i){r.keepMetadata=i,r.keepMetadata&&(r.metadataPath=""),r.fdstat={fs_flags:e,fs_rights_base:t,fs_rights_inheriting:n,fs_filetype:void 0}}async function hi(r){r.keepMetadata&&r.metadataPath===""&&(r.metadataPath=await nn(r.handle))}async function vu(r,e,t){if(r.keepMetadata){let n=await ur(r.metadataPath);e!==void 0&&(n.atim=e),t!==void 0&&(n.mtim=t),(e!==void 0||t!==void 0)&&await xr(r.metadataPath,n)}return 0}var ps=class extends Cr{handle;metadataPath;keepMetadata;cursor;writer;file;constructor(e,t,n,i,s){super(),this.handle=e,this.cursor=0n,gu(this,t,n,i,s),this.file=void 0}async initialize(e){let t=await super.initialize(e);if(t!==0)return t;await hi(this);let n=BigInt((await this.__getFile()).file?.size),i;if(this.keepMetadata){let s=await ur(this.metadataPath);if(s==null)return 44;i=s.filetype}else i=ps.defaultFilestat.filetype;return this.fdstat.fs_filetype=i,this.fdstat.fs_flags&1&&(this.cursor=n),0}async getWriter(){return this.writer||(this.writer=await this.handle.createWritable({keepExistingData:!0})),this.writer}async __getFile(){if(!this.file)try{let e=await this.handle.getFile();return this.file=e,{err:0,file:e}}catch{return{err:2,file:void 0}}return{err:0,file:this.file}}async read(e){let{err:t,file:n}=await this.__getFile();if(t!==0)return{err:t,buffer:void 0};let i=Number(this.cursor)+e,s=await n.slice(Number(this.cursor),Number(i)).arrayBuffer();return this.cursor+=BigInt(s.byteLength),{err:0,buffer:s}}async read_str(){let{err:e,file:t}=await this.__getFile();return e!==0?{err:e,content:void 0}:{err:0,content:await t.text()}}async pread(e,t){let{err:n,file:i}=await this.__getFile();if(n!==0)return{err:n,buffer:void 0};let s=BigInt((await this.__getFile()).file?.size),a=s<t+BigInt(e)?s:this.cursor+BigInt(e);return{err:0,buffer:await i.slice(Number(t),Number(a)).arrayBuffer()}}async seek(e,t){let n=BigInt((await this.__getFile()).file?.size);switch(t){case Tr:if(this.cursor+e<0n)return{offset:this.cursor,err:28};this.cursor+=e;break;case Tn:if(e<0n)return{offset:this.cursor,err:28};this.cursor=e;break;case Cn:if(n<-e)return{offset:this.cursor,err:28};this.cursor=n+e;break;default:return{offset:this.cursor,err:28}}return{err:0,offset:this.cursor}}async setFilestatTimes(e,t){return vu(this,e,t)}async write(e){await(await this.getWriter()).write({type:"write",position:Number(this.cursor),data:e});let t=BigInt(e.byteLength);return this.cursor+=t,{err:0,written:t}}async pwrite(e,t){await(await this.getWriter()).write({type:"write",position:Number(t),data:e});let n=BigInt(e.byteLength);return{err:0,written:n}}async writableStream(){return{err:0,stream:await this.getWriter()}}async truncate(e){try{await(await this.getWriter()).write({type:"truncate",size:Number(e)})}catch(t){return t instanceof DOMException?sn(t,!1):28}return await this.flush(),this.cursor=0n,0}async arrayBuffer(){let e=await(await this.handle.getFile()).arrayBuffer();return{err:0,buffer:e}}async flush(){if(this.writer){let e=this.writer;this.writer=null;try{await e?.close()}catch{}}}async close(){return await this.flush(),0}async getFilestat(){let e=this.keepMetadata?await ur(this.metadataPath):ps.defaultFilestat;return e===void 0?{err:56,filestat:void 0}:(e.size=BigInt((await this.__getFile()).file?.size),{err:0,filestat:e})}async addPollSub(e,t,n){let i=BigInt(this.file?this.file.size:(await this.__getFile()).file.size);return{userdata:e,error:0,eventType:t,nbytes:i}}},zt=ps;fr(zt,"defaultFilestat",{dev:0n,ino:0n,filetype:4,nlink:1n,size:0n,atim:0n,mtim:0n,ctim:0n});var Ss=class extends Or{handle;metadataPath;keepMetadata;entries;constructor(e,t,n,i,s){super(),this.handle=e,gu(this,t,n,i,s),this.fdstat.fs_filetype=3,this.entries=[]}async initialize(e){let t=await super.initialize(e);return t!==0?t:(await hi(this),0)}async getFilestat(){if(this.keepMetadata){let e=await ur(this.metadataPath);return e===void 0?{err:56,filestat:void 0}:{err:0,filestat:e}}else return{err:0,filestat:Ss.defaultFilestat}}async setFilestatTimes(e,t){return vu(this,e,t)}async readdir(e){let t=0;if(e||this.entries.length===0){this.entries=[];var n=1n;for await(let[i,s]of this.handle.entries()){if(i.endsWith(".crswap"))continue;let a;this.keepMetadata?a=await ur(`${this.metadataPath}/${i}`):a=s instanceof FileSystemDirectoryHandle?Ss.defaultFilestat:zt.defaultFilestat,a===void 0?t=56:this.entries.push({d_next:n++,d_ino:a.ino,name:i,d_type:a.filetype})}}return{err:t,dirents:this.entries}}},Wt=Ss;fr(Wt,"defaultFilestat",{dev:0n,ino:0n,filetype:3,nlink:1n,size:4096n,atim:0n,mtim:0n,ctim:0n});var xn=class{rootHandle;keepMetadata;fsname(){return"FsaFilesystem"}getRootHandle(){return this.rootHandle}async getHandle(e,t,n){let i,s,a=!0,o=n===void 0?this.getRootHandle():n;try{for(e.startsWith("/")?s=1:s=0,i=e.indexOf("/",s);i!=-1;i=e.indexOf("/",s))o=await o.getDirectoryHandle(e.slice(s,i)),s=i+1;let c;a=t;let f=e.slice(s);return f===""?c=o:t?c=await o.getDirectoryHandle(f):c=await o.getFileHandle(f),{handle:c,err:0,index:-1}}catch(c){let f;try{f=sn(c,a)}catch{f=28}return{index:i,err:f,handle:o}}}async unlinkat(e,t,n){let i;if(e!==void 0)if(e instanceof Wt)i=e.handle;else return 28;let{err:s,handle:a}=await this.getHandle(Vt(t),!0,i);if(s!==0)return s;let o=Ve(t);try{let c=(await this.getHandle(o,n,a)).err;return c!==0?c:(a.removeEntry(o,{recursive:!1}),await ko(`${await nn(a)}/${t}`),0)}catch(c){let f=28;return c instanceof DOMException&&(f=sn(c,!0)),f}}async mkdirat(e,t){let n;if(e!==void 0)if(e instanceof Wt)n=e.handle;else return 28;let{err:i,handle:s}=await this.getHandle(Vt(t),!0,n);if(i!==0)return i;let a=Ve(t);if({err:i}=await this.getHandle(a,!0,s),i===0)return 20;if(i!==44)return i;try{s=await s.getDirectoryHandle(t,{create:!0})}catch(o){if(o instanceof DOMException){let c=sn(o,!0);if(c!==0)return c}}return this.keepMetadata&&await xr(await nn(s),{dev:0n,ino:0n,filetype:3,nlink:1n,size:4096n,mtim:0n,atim:0n,ctim:0n}),0}async symlinkat(e,t,n){let i;if(t!==void 0)if(t instanceof Wt)i=t.handle;else return 28;let{err:s,handle:a}=await this.getHandle(Vt(n),!0,i);if(s!==0)return s;let o=Ve(n);if({err:s}=await this.getHandle(o,!1,a),s===0||s===31)return 20;if(s!==44)return s;let c=await a.getFileHandle(n,{create:!0}),f=await c.createWritable();return await f.write(e),await f.close(),this.keepMetadata&&await xr(await nn(c),{dev:0n,ino:0n,filetype:7,nlink:1n,size:BigInt(e.length),mtim:0n,atim:0n,ctim:0n}),0}async getFilestat(e){if(this.keepMetadata){let t=this.getRootHandle().name+e,n=await ur(t);return{filestat:n,err:n?0:44}}else{let{err:t}=await this.getHandle(e,!0,void 0);switch(t){case 54:return{err:0,filestat:Wt.defaultFilestat};case 0:return{err:0,filestat:zt.defaultFilestat};default:return{err:t,filestat:void 0}}}}async open(e,t,n,i,s,a,o){let c=await this.getHandle(e,!0,void 0),f=c.err,l=c.index,h;switch(f){case 0:{n&Ye?n&Qr?f=20:f=31:f=c.err,l=c.index,h=new Wt(c.handle,a,i,s,this.keepMetadata);break}case 54:if(l===-1){if(n&nt&&!(t&1))break;let _=await this.getHandle(Ve(e),!1,c.handle);_.err===0&&(n&Ye&&n&Qr?f=20:n&nt||(f=_.err),h=new zt(_.handle,a,i,s,this.keepMetadata));break}else if(t&1){let _=await this.getHandle(Ve(e.slice(0,l)),!1,c.handle);_.err===0&&(h=new zt(_.handle,a,i,s,this.keepMetadata));break}case 44:{if(n&Ye&&l===-1)try{let _=await c.handle.getFileHandle(Ve(e),{create:!0});f=0,h=new zt(_,a,i,s,this.keepMetadata),this.keepMetadata&&(h.metadataPath=await nn(_),await xr(h.metadataPath,{dev:0n,ino:0n,filetype:4,nlink:1n,size:0n,mtim:0n,atim:0n,ctim:0n}))}catch(_){_ instanceof DOMException?f=sn(_,!1):f=28}break}}return{err:f,index:l,desc:h}}async renameat(e,t,n,i){if(e!==void 0&&!(e instanceof Wt))return 28;let{handle:a,err:o}=await this.getHandle(t,!1,e.handle);if(o===31)return 75;if(o!==0)return o;let c=new zt(a,0,Be,Be,this.keepMetadata);await hi(c);let f=await c.getFilestat();if(f.err!==0)return f.err;if(f.filestat.filetype===7)return 75;if(n!==void 0&&!(n instanceof Wt))return 28;let{handle:l,err:h}=await this.getHandle(Vt(i),!0,n.handle);if(h!==0)return h;let _=await l.getFileHandle(Ve(i),{create:!0}),m=new zt(_,0,Be,Be,this.keepMetadata);for(await hi(m);;){let{err:I,buffer:b}=await c.read(2048);if(I!==0)return I;if(b.byteLength===0)break;if((await m.write(b)).err!==0)return I}return await c.close(),await m.close(),await xr(m.metadataPath,f.filestat),await this.unlinkat(e,t,!1),0}async initialize(e){let t=e;this.keepMetadata=t.keepMetadata===void 0?!1:ds(t.keepMetadata);let n=t.create===void 0?!1:ds(t.create);if(t.prompt===void 0?!1:ds(t.prompt)){if(this.keepMetadata||t.name!==void 0||n)return 28;try{this.rootHandle=await showDirectoryPicker()}catch{return 44}}else t.name!==void 0&&(this.rootHandle=await Su(t.name,n),this.keepMetadata&&await ur(t.name)===void 0&&await xr(t.name,Wt.defaultFilestat));return 0}async mknodat(e,t,n,i){return 28}async cleanup(){if(!this.keepMetadata)return;let e=this.rootHandle.name;await Promise.all((await pu()).map(async t=>{t.startsWith(e)&&(await this.open(t.replace(e,""),0,0,Be,Be,0,0)).err===44&&await ko(t)}))}};async function ms(r,e){let[t,n,i]=r.data,s=e.processInfos[t].cmd,a=s.substr(s.lastIndexOf("/")+1);switch(n){case"console":{console.log(`%c [dbg (%c${a}:${t}%c)] %c ${i}`,"background:black; color: white;","background:black; color:yellow;","background: black; color:white;","background:default; color: default;");break}case"proc_exit":{e.processInfos[t].env.DEBUG==="1"&&console.log(`%c [dbg (%c${a}:${t}%c)] %c exited with result code ${i}`,"background:black; color: white;","background:black; color:yellow;","background: black; color:white;","background:default; color: default;"),await e.terminateProcess(t,i),t===0&&(window.alive=!1,window.exitCode=i);break}case"chdir":{let{dir:c,sharedBuffer:f}=i,l=new Int32Array(f,0,1);e.processInfos[t].cwd=c,Atomics.store(l,0,0),Atomics.notify(l,0);break}case"getcwd":{let{bufLen:c,sharedBuffer:f}=i,l=new Int32Array(f,0,1),h=new Uint32Array(f,4,1),_=new Uint8Array(f,8,c),m=0,I=e.processInfos[t].cwd;c<I.length?(h[0]=c,m=42):(h[0]=I.length,_.set(new TextEncoder().encode(I),0)),Atomics.store(l,0,m),Atomics.notify(l,0);break}case"isatty":{let{sharedBuffer:c,fd:f}=i,l=new Int32Array(c,0,1),h=new Int32Array(c,4,1),_,{fds:m}=e.processInfos[t];m.getDesc(f)!==void 0?(h[0]=Number(m.getDesc(f).isatty()),_=0):_=8,Atomics.store(l,0,_),Atomics.notify(l,0);break}case"getpid":{let{sharedBuffer:c}=i,f=new Int32Array(c,0,1),l=new Int32Array(c,4,1);l[0]=e.processInfos[t].id,Atomics.store(f,0,0),Atomics.notify(f,0);break}case"set_env":{let{key:c,value:f,sharedBuffer:l}=i,h=new Int32Array(l,0,1);e.processInfos[t].env[c]=f,Atomics.store(h,0,0),Atomics.notify(h,0);break}case"set_echo":{let{shouldEcho:c,sharedBuffer:f}=i,l=new Int32Array(f,0,1);e.processInfos[t].shouldEcho=c==="1",Atomics.store(l,0,0),Atomics.notify(l,0);break}case"spawn":{let{path:c,args:f,env:l,sharedBuffer:h,background:_,redirects:m}=i,I=new Int32Array(h,0,1),b=new Int32Array(h,4,1);b[0]=-1,f.splice(0,0,c.split("/").pop());let H=0,M=e.processInfos[t].fds.clone();for(let V=0;V<m.length&&H==0;V++){let ie=m[V],he=ie.type,Ae=ie.fd_dst;switch(he){case Oo:case xo:case Wo:case Ro:{let tt=ie.path,pn=Ye,Sn=0,Kt=0n;switch(he){case Oo:{pn=0,Kt|=ci;break}case xo:{pn|=bn,Kt|=An;break}case Wo:{Sn|=1,Kt|=An;break}case Ro:{Kt|=ci|An;break}default:{H=1,console.log(`Spawn: program should not enter here for redirect type ${ie.type}.`);continue}}let{desc:Xt,err:Vn}=await e.filesystem.open(tt,1,pn,Sn,Kt,Kt,t);if(Vn!==0){console.log(`Spawn: cannot open file, error: ${Vn}`),H=1;break}let zn=M.getDesc(Ae);zn!==void 0&&zn.close(),M.setFd(Ae,new St(Xt));break}case nu:case iu:case su:{if(M.getDesc(ie.fd_src)!==void 0){let tt=M.getDesc(Ae);tt!==void 0&&tt.close(),M.duplicateFd(ie.fd_src,Ae)}else console.log(`Spawn: cannot duplicate fd=${ie.fd_src}, it is closed.`),H=1;break}case au:{let tt=M.getDesc(Ae);tt!==void 0?(tt.close(),M.freeFd(Ae)):(console.log(`Spawn: cannot close fd=${ie.fd_src}, it is already closed.`),H=1);break}default:console.log(`Spawn: redirect type ${ie.type} not found.`),H=1}}if(H!=0){Atomics.store(I,0,H),Atomics.notify(I,0);break}let K=!0;switch(c){case"/usr/bin/ps":{let V=await cu(e,t,f,l,M);Atomics.store(I,0,V),Atomics.notify(I,0);break}case"/usr/bin/free":{let V=await fu(e,t,f,l,M);Atomics.store(I,0,V),Atomics.notify(I,0);break}case"/usr/bin/reset":{let V=await uu(e,t,f,l,M);Atomics.store(I,0,V),Atomics.notify(I,0);break}default:{K=!1;let V=e.processInfos[t].terminationNotifier;if(V!==null?V.obtainEvents(Yt)!=0:!1){M.tearDown(),Atomics.store(I,0,130),Atomics.notify(I,0);break}try{let he=await e.spawnProcess(t,_?null:I,c,M,f,l,_,e.processInfos[t].cwd);if(Atomics.store(b,0,he),l.DEBUG==="1"){let Ae=c.split("/").slice(-1)[0];console.log(`%c [dbg (%c${Ae}:${he}%c)] %c spawned by ${a}:${t}`,"background:black; color: white;","background:black; color:yellow;","background: black; color:white;","background:default; color: default;")}}catch{console.log("Failed spawning process")}if(_){let he=0;(V!==null?V.obtainEvents(Yt)!=0:!1)&&(he=130),Atomics.store(I,0,he),Atomics.notify(I,0)}}}K&&M.tearDown();break}case"fd_prestat_get":{let{sharedBuffer:c,fd:f}=i,l=new Int32Array(c,0,1),h=new Int32Array(c,4,1),_=new Uint8Array(c,8,1),m,{fds:I}=e.processInfos[t];f>2&&f<4?(_[0]=eu,h[0]=Ve(I.getDesc(f).getPath()).length,m=0):m=8,Atomics.store(l,0,m),Atomics.notify(l,0);break}case"path_symlink":{let{sharedBuffer:c,targetPath:f,linkFd:l,linkPath:h}=i,_=new Int32Array(c,0,1),{fds:m}=e.processInfos[t],I;m.getDesc(l)===void 0?I=8:I=await e.filesystem.addSymlink(f,h,m.getDesc(l),t),Atomics.store(_,0,I),Atomics.notify(_,0);break}case"path_link":{let{sharedBuffer:c,oldFd:f}=i,l=new Int32Array(c,0,1),h,{fds:_}=e.processInfos[t];_.getDesc(f)!==void 0?h=(await _.getDesc(tu).write(new TextEncoder().encode("hard links are not supported"))).err:h=8,Atomics.store(l,0,h),Atomics.notify(l,0);break}case"path_readlink":{let{sharedBuffer:c,fd:f,path:l,bufferLen:h}=i,_=new Int32Array(c,0,1),m=new Int32Array(c,4,1),I=new Uint8Array(c,8,h),b=0,{fds:H}=e.processInfos[t];if(H.getDesc(f)!==void 0){let M;({err:b,path:M}=await e.filesystem.readLink(H.getDesc(f),l,t)),b===0?M.length>h?m[0]=h:(I.set(new TextEncoder().encode(M),0),m[0]=M.length):b=28}else b=8;Atomics.store(_,0,b),Atomics.notify(_,0);break}case"fd_prestat_dir_name":{let{sharedBuffer:c,fd:f,pathLen:l}=i,h=new Int32Array(c,0,1),_=new Uint8Array(c,4,l),m,{fds:I}=e.processInfos[t];I.getDesc(f)!==void 0?(_.set(new TextEncoder().encode(Ve(I.getDesc(f).getPath())),0),m=0):m=8,Atomics.store(h,0,m),Atomics.notify(h,0);break}case"fd_write":{let{sharedBuffer:c,fd:f,content:l}=i,h=new Int32Array(c,0,1),_=new Int32Array(c,4,1),{fds:m}=e.processInfos[t],I,b;if(m.getDesc(f)!==void 0){let H=await m.getDesc(f).getFdstat();if(b=H.fs_filetype,b===3)I=31;else if(b===7)I=28;else if((H.fs_rights_base&An)===0n)I=2;else{let M=await m.getDesc(f).write(l.buffer);I=M.err,_[0]=Number(M.written)}}else I=8;Atomics.store(h,0,I),Atomics.notify(h,0);break}case"fd_pread":case"fd_read":{let{sharedBuffer:c,fd:f,len:l,offset:h}=i,{fds:_}=e.processInfos[t],m=new Int32Array(c,0,1),I=new Uint8Array(c,8,l),b,H=new Int32Array(c,4,1),M;if(_.getDesc(f)===void 0)b=8;else if(M=await _.getDesc(f).getFdstat(),(M.fs_rights_base&ci)==0n)b=2;else if(M.fs_filetype===3)b=31;else if(M.fs_filetype===7)b=28;else{let K;h?K=await _.getDesc(f).pread(l,h):K=await _.getDesc(f).read(l,t),b=K.err,I.set(new Uint8Array(K.buffer)),H[0]=K.buffer.byteLength}Atomics.store(m,0,b),Atomics.notify(m,0);break}case"path_open":{let{sharedBuffer:c,dirFd:f,path:l,lookupFlags:h,openFlags:_,fsRightsBase:m,fsRightsInheriting:I,fdFlags:b}=i,H=new Int32Array(c,0,1),M=new Int32Array(c,4,1),K,{fds:V}=e.processInfos[t];if(V.getDesc(f)!==void 0)if(_&Ye&&_&nt)K=28;else{let ie;({err:K,desc:ie}=await e.filesystem.openat(V.getDesc(f),l,h,_,b,m,I,t)),K===0&&(M[0]=V.addFile(ie))}else K=8;Atomics.store(H,0,K),Atomics.notify(H,0);break}case"fd_close":{let{sharedBuffer:c,fd:f}=i,l=new Int32Array(c,0,1),h,{fds:_}=e.processInfos[t];_.getDesc(f)!==void 0?(await _.getDesc(f).close(),_.freeFd(f),h=0):h=8,Atomics.store(l,0,h),Atomics.notify(l,0);break}case"path_filestat_get":case"fd_filestat_get":{let{sharedBuffer:c,fd:f,path:l,lookupFlags:h}=i,_=new Int32Array(c,0,1),m=new DataView(c,4),I=0,{fds:b}=e.processInfos[t],H=b.getDesc(f);if(H===void 0)I=8;else{let M=await H.getFdstat();if(l&&M.fs_rights_base&Io||!l&&M.fs_rights_base&fi){let K;if(l!==void 0){let V=await e.filesystem.openat(H,l,h,0,0,Be,Be,t);I=V.err,V.err===0&&(K=V.desc)}else K=H;if(K!==void 0&&(l&&M.fs_rights_base&Io||!l&&M.fs_rights_base&fi)&&I===0){let V=await K.getFilestat();V.err!=0?I=V.err:(m.setBigUint64(0,V.filestat.dev,!0),m.setBigUint64(8,V.filestat.ino,!0),m.setUint8(16,V.filestat.filetype),m.setBigUint64(24,V.filestat.nlink,!0),m.setBigUint64(32,V.filestat.size,!0),m.setBigUint64(40,V.filestat.atim,!0),m.setBigUint64(48,V.filestat.mtim,!0),m.setBigUint64(56,V.filestat.ctim,!0))}}else I=2}Atomics.store(_,0,I),Atomics.notify(_,0);break}case"fd_seek":{let{sharedBuffer:c,fd:f,offset:l,whence:h}=i,_=new Int32Array(c,0,1),m=new BigUint64Array(c,8,1),I,{fds:b}=e.processInfos[t];if(b.getDesc(f)===void 0)I=8;else{let H=await b.getDesc(f).getFdstat();if((H.fs_rights_base&Vf)!==0n)if(H.fs_filetype!==3){let M=await b.getDesc(f).seek(l,h);m[0]=M.offset,I=M.err}else I=8;else I=2}Atomics.store(_,0,I),Atomics.notify(_,0);break}case"fd_readdir":{let{sharedBuffer:c,fd:f,cookie:l,bufLen:h}=i,_=new Int32Array(c,0,1),m=new Uint32Array(c,4,1),I=new DataView(c,8,h),b=0,H,{fds:M}=e.processInfos[t];if(M.getDesc(f)!==void 0&&(await M.getDesc(f).getFdstat()).fs_filetype===3){let K=(await M.getDesc(f).readdir(l===0n)).dirents;for(let V=Number(l);V<K.length;V+=1){let ie=K[V],he=new TextEncoder().encode(ie.name);if(b+8>h){b+=8;break}if(I.setBigUint64(b,BigInt(V+1),!0),b+=8,b+8>=h){b+=8;break}if(I.setBigUint64(b,ie.d_ino,!0),b+=8,b+4>=h){b+=4;break}if(I.setUint32(b,he.byteLength,!0),b+=4,b+4>=h){b+=4;break}if(I.setUint8(b,ie.d_type),b+=4,b+he.byteLength>h){b+=he.byteLength;break}new Uint8Array(c,8).set(he,b),b+=he.byteLength}m[0]=b>h?h:b,H=0}else H=8;Atomics.store(_,0,H),Atomics.notify(_,0);break}case"path_unlink_file":case"path_remove_directory":{let{sharedBuffer:c,fd:f,path:l}=i,h=new Int32Array(c,0,1),_,{fds:m}=e.processInfos[t];m.getDesc(f)!==void 0?_=await e.filesystem.removeEntry(l,n!=="path_unlink_file",m.getDesc(f),t):_=8,Atomics.store(h,0,_),Atomics.notify(h,0);break}case"path_create_directory":{let{sharedBuffer:c,fd:f,path:l}=i,h=new Int32Array(c,0,1),_,{fds:m}=e.processInfos[t];m.getDesc(f)!==void 0?_=await e.filesystem.createDir(l,m.getDesc(f),t):_=8,Atomics.store(h,0,_),Atomics.notify(h,0);break}case"fd_fdstat_get":{let{sharedBuffer:c,fd:f}=i,l=new Int32Array(c,0,1),h=new Uint8Array(c,4,1),_=new BigUint64Array(c,8,1),m=new BigUint64Array(c,16,1),I=new Uint8Array(c,24,1),b,{fds:H}=e.processInfos[t],M=H.getFdEntry(f);if(M!==void 0){let K=await M.desc.getFdstat();h[0]=K.fs_filetype,I[0]=K.fs_flags|M.fdFlags,_[0]=K.fs_rights_base,m[0]=K.fs_rights_inheriting,b=0}else b=8;Atomics.store(l,0,b),Atomics.notify(l,0);break}case"path_rename":{let{sharedBuffer:c,oldFd:f,oldPath:l,newFd:h,newPath:_}=i,m=new Int32Array(c,0,1),{fds:I}=e.processInfos[t],b=await e.filesystem.move(I.getDesc(f),l,I.getDesc(h),_,t);Atomics.store(m,0,b),Atomics.notify(m,0);break}case"fd_tell":{let{sharedBuffer:c,fd:f}=i,l=new BigInt64Array(c,0,1),h=new Int32Array(c,8,1),{fds:_}=e.processInfos[t],m;if(_.getDesc(f)!==void 0){let I=await _.getDesc(f).getFdstat();(I.fs_rights_base&jf)!==0n?I.fs_filetype===4||I.fs_filetype===7?(l[0]=BigInt((await _.getDesc(f).seek(0n,Tr)).offset),m=0):m=8:m=2}else m=8;Atomics.store(h,0,m),Atomics.notify(h,0);break}case"path_filestat_set_times":case"fd_filestat_set_times":{let{sharedBuffer:c,st_atim:f,flags:l,st_mtim:h,fst_flags:_,fd:m,path:I}=i,b=8,H=new Int32Array(c,0,1),{fds:M}=e.processInfos[t],K=M.getDesc(m);if(K&&I!==void 0){let V=await e.filesystem.openat(K,I,l);K=V.desc,b=V.err}if(K)if(!((await K.getFdstat()).fs_rights_base&Xf))b=2;else if(_&bo&&_&Ao||_&Co&&_&To)b=28;else{let ie,he;_&Ao?he=f:_&bo&&(he=Do(performance.now())),_&To?ie=h:_&Co&&(ie=Do(performance.now())),b=await K.setFilestatTimes(he,ie)}Atomics.store(H,0,b),Atomics.notify(H,0);break}case"fd_fdstat_set_flags":{let{sharedBuffer:c,fd:f,flags:l}=i,h=new Int32Array(c,0,1),{fds:_}=e.processInfos[t],m=0,I=_.getFdEntry(f);if(I===void 0)m=8;else if(l&32)I.fdFlags=l&65472;else{let b=l&31;m=await I.desc.setFdstatFlags(b)}Atomics.store(h,0,m),Atomics.notify(h,0);break}case"fd_renumber":{let{sharedBuffer:c,fd:f,newFd:l}=i,h=new Int32Array(c,0,1),{fds:_}=e.processInfos[t],m=0,I=_.getFdEntry(f),b=_.getFdEntry(l);I===void 0?m=8:(b!==void 0&&(await b.desc.close(),_.freeFd(l)),_.duplicateFd(f,l)),Atomics.store(h,0,m),Atomics.notify(h,0);break}case"poll_oneoff":{let{sharedBuffer:c,subs:f,eventBuf:l}=i,h=new Int32Array(c,0,2),{fds:_}=e.processInfos[t],m=[];await Promise.any(f.map(M=>{let K;switch(M.eventType){case Zf:K=new Promise(V=>{setTimeout(()=>{V({userdata:M.userdata,error:0,eventType:M.eventType,nbytes:0n})},Number(M.event.timeout/1000000n))});break;case ls:case br:{let V=K=_.getDesc(M.event.fd);V===void 0?K=Promise.resolve({userdata:M.userdata,error:8,eventType:M.eventType,nbytes:0n}):K=V.addPollSub(M.userdata,M.eventType,t);break}default:K=new Promise(V=>{V({userdata:M.userdata,error:28,eventType:Ht,nbytes:0n})})}return K.then(V=>m.push(V))}));let I=new DataView(l,0),b=m.length,H=0;m.forEach(M=>{I.setBigUint64(H,M.userdata,!0),H+=8,I.setUint16(H,M.error,!0),H+=2,I.setUint8(H,M.eventType),H+=6,I.setBigUint64(H,M.nbytes,!0),H+=8,H+=8}),Atomics.store(h,1,b),Atomics.store(h,0,0),Atomics.notify(h,0);break}case"event_source_fd":{let{sharedBuffer:c,eventMask:f}=i,l=new Int32Array(c,0,1),h=new Int32Array(c,4,1),_=new en(0,Be,Be,f),m=e.processInfos[t].fds;var o=m.addFile(_);m.fdt[o].fdFlags=64,Atomics.store(h,0,o),Atomics.store(l,0,0),Atomics.notify(l,0);break}case"attach_sigint":{let{sharedBuffer:c,fd:f}=i,l=e.attachSigint(f,t),h=new Int32Array(c,0,1);Atomics.store(h,0,l),Atomics.notify(h,0);break}case"clean_inodes":{let{sharedBuffer:c}=i,f=new Int32Array(c,0,1);await Promise.all(Object.values(e.filesystem.getMounts()).map(async l=>{l instanceof xn&&l.cleanup()})),Atomics.store(f,0,0),Atomics.notify(f,0);break}case"kill":{let{sharedBuffer:c,processId:f,signalNumber:l}=i,h=new Int32Array(c,0,1),_=0;l!==9?(console.log(`Process=${f} send usupported singnal: ${l}!`),_=28):e.processInfos[f]===void 0?(console.log(`Process=${f} send singnal to process ${f} that does not exist!`),_=71):await e.terminateProcess(f,128+l),Atomics.store(h,0,_),Atomics.notify(h,0);break}case"ioctl":{let{sharedBuffer:c,fd:f,command:l}=i,h=new Int32Array(c,0,1),_=new Uint8Array(c,4),{fds:m}=e.processInfos[t],I=m.getDesc(f);if(f===void 0){Atomics.store(h,0,8),Atomics.notify(h,0);break}let b=await I.ioctl(l,_);Atomics.store(h,0,b),Atomics.notify(h,0);break}case"mount":{let{sharedBuffer:c,sourceFd:f,sourcePath:l,targetFd:h,targetPath:_,filesystemType:m,mountFlags:I,data:b}=i,H=0,M=new Int32Array(c,0,1),{fds:K}=e.processInfos[t],V;f>=0&&(V=K.getDesc(f),V===void 0&&(H=8));let ie;h>=0&&(ie=K.getDesc(h),ie===void 0&&(H=8));let he={};for(let Ae of b.split(",")){if(Ae==="")continue;let tt=Ae.split("=");if(tt.length!==2){H=28;break}he[tt[0]]=tt[1]}H===0&&(H=await e.filesystem.addMount(V,l,ie,_,m,I,he,t)),Atomics.store(M,0,H),Atomics.notify(M,0);break}case"umount":{let{sharedBuffer:c,path:f}=i,l=new Int32Array(c,0,1);Atomics.store(l,0,e.filesystem.removeMount(f)),Atomics.notify(l,0);break}default:throw new Error(`Unhandled syscall: ${n}`)}}var on="/home/ant",Es={PATH:"/usr/bin:/usr/local/bin",PWD:on,OLDPWD:on,TMPDIR:"/tmp",TERM:"xterm-256color",HOME:on,SHELL:"/usr/bin/wash",LANG:"en_US.UTF-8",USER:"ant",HOSTNAME:"browser",PYTHONHOME:"/",PS1:"\x1B[1;34m\\u@\\h \x1B[1;33m\\w$\x1B[0m "},St=class{desc;fdFlags;constructor(e){if(e===void 0)throw"DescriptorEntry must not contain undefined descriptor!";this.desc=e,this.fdFlags=0}},Rr=class{fdt={};freeFds=[];topFd;constructor(e){this.fdt={...e},this.topFd=Object.keys(e).length-1}clone(){var e=new Rr([]);e.freeFds=this.freeFds.slice(0);for(let t in this.fdt)this.fdt[t].fdFlags&64?e.freeFds.push(Number(t)):e.fdt[t]=new St(this.fdt[t].desc);return e.freeFds.sort(),e.topFd=this.topFd,e}addFile(e){if(e===void 0)throw"Entry is undefined";let t=new St(e),n=this.freeFds.shift();if(n!==void 0)return this.fdt[n]=t,n;for(n=++this.topFd;this.fdt[n]!==void 0;)n=++this.topFd;return this.fdt[n]=t,n}freeFd(e){if(!(e in this.fdt))throw"descriptor not present in descriptor table";delete this.fdt[e],this.freeFds.push(e)}replaceFd(e,t){if(!(e in this.fdt))throw"descriptor not present in descriptor table";if(t===void 0)throw"Entry is undefined";this.fdt[e]=t}getFdEntry(e){return this.fdt[e]}getDesc(e){return this.fdt[e]!==void 0?this.fdt[e].desc:void 0}setFd(e,t){this.prepareToStoreFd(e),this.fdt[e]!==void 0&&console.log(`setFd: overwrite opened fd = ${e}`),this.fdt[e]=t}duplicateFd(e,t){this.prepareToStoreFd(t),this.fdt[t]!==void 0&&console.log(`duplicateFd: overwrite opened fd = ${t}`),this.fdt[t]=new St(this.fdt[e].desc)}prepareToStoreFd(e){let t=this.freeFds.findIndex(n=>n==e);t>=0&&this.freeFds.splice(t,1)}tearDown(){Promise.all(Object.values(this.fdt).map(async e=>{e!==void 0?e.desc!==void 0?e.desc.close():console.error("Descriptor entry has undefined descriptor!"):console.error("Descriptor entry is undefined!")}))}},Uo=class{id;cmd;worker;fds;parentId;parentLock;callback;env;cwd;isJob;foreground;shouldEcho=!0;terminationNotifier=null;timestamp;children;constructor(e,t,n,i,s,a,o,c,f,l,h){this.id=e,this.cmd=t,this.worker=n,this.fds=i,this.parentId=s,this.parentLock=a,this.callback=o,this.env=c,this.cwd=f,this.isJob=l,this.foreground=h,this.timestamp=Math.floor(new Date().getTime()/1e3),this.children=[]}},pi=class{scriptName;filesystem;driverManager;processInfos;nextProcessId=0;compiledModules={};constructor(e,t,n,i={}){this.scriptName=e,this.filesystem=t,this.driverManager=n,this.processInfos=i}async syscallCallback(e,t){if(this.driverManager!==void 0){let n=this.driverManager.getDriver(1);if(n!==void 0){n.wrapCallback(async()=>{await ms(e,t)});return}}ms}async spawnProcess(e,t,n,i,s,a,o,c,f=null){let l=this.nextProcessId;this.nextProcessId+=1;let h=new Worker(this.scriptName,{type:"module"});if(f===null&&(f=this.processInfos[e].foreground),e!==null&&(this.processInfos[e].children.push(l),t!==null&&(this.processInfos[e].foreground=null)),this.processInfos[l]=new Uo(l,n,h,i,e,t,this.syscallCallback,a,c,o,f),h.onmessage=_=>this.syscallCallback(_,this),f!==null){let _=this.driverManager.getDriver(f.maj);_.terminals[f.min].foregroundPid=l}try{if(!this.compiledModules[n]){let{err:_,desc:m}=await this.filesystem.open(n,1);if(_!==0)return console.error(`No such binary: ${n}`),await this.terminateProcess(l,_),_;this.compiledModules[n]=await WebAssembly.compile((await m.arrayBuffer()).buffer)}}catch(_){let m;throw _.message==="WebAssembly.compile(): BufferSource argument is empty"?m=0:m=45,await this.terminateProcess(l,m),Error("invalid binary")}return!o&&e!=null&&this.processInfos[e].terminationNotifier!==null&&this.processInfos[e].terminationNotifier.obtainEvents(Yt)!=Ht?this.terminateProcess(l,130):this.processInfos[l].worker.postMessage(["start",this.compiledModules[n],l,s,a]),l}async terminateProcess(e,t=0){let n=this.processInfos[e];if(this.processInfos[e].fds.tearDown(),n.parentId!==null&&(this.processInfos[this.processInfos[e].parentId].foreground=n.foreground,this.processInfos[n.parentId].children.splice(n.children.indexOf(e),1),n.foreground!==null)){let i=this.driverManager.getDriver(n.foreground.maj);i.terminals[n.foreground.min].foregroundPid=n.parentId}n.worker.terminate(),n.children.forEach(i=>this.terminateProcess(i,128+9)),e!==0&&n.parentLock!=null&&(Atomics.store(n.parentLock,0,t),Atomics.notify(n.parentLock,0)),delete this.processInfos[e]}publishEvent(e,t){if(e&Yt&&!this.processInfos[t].terminationNotifier){this.terminateProcess(t,128+Yt);return}for(let n of Object.values(this.processInfos[t].fds.fdt))n.desc instanceof en&&n.desc.sendEvents(e)}attachSigint(e,t){let n=this.processInfos[t].fds.getDesc(e);if(n===void 0)return 8;if(!(n instanceof en))return 28;let i;return new Promise((s,a)=>{i=n.makeNotifier({resolve:s,reject:a}),i===0&&(this.processInfos[t].terminationNotifier=n)}).then(s=>{this.processInfos[t]!==void 0&&this.processInfos[t].terminationNotifier===s&&(this.processInfos[t].terminationNotifier=null)}),i}};var Ln=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},Zt=[],Ft=[],yh=typeof Uint8Array<"u"?Uint8Array:Array,wc=!1;function Qu(){wc=!0;for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,t=r.length;e<t;++e)Zt[e]=r[e],Ft[r.charCodeAt(e)]=e;Ft["-".charCodeAt(0)]=62,Ft["_".charCodeAt(0)]=63}function Ih(r){wc||Qu();var e,t,n,i,s,a,o=r.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s=r[o-2]==="="?2:r[o-1]==="="?1:0,a=new yh(o*3/4-s),n=s>0?o-4:o;var c=0;for(e=0,t=0;e<n;e+=4,t+=3)i=Ft[r.charCodeAt(e)]<<18|Ft[r.charCodeAt(e+1)]<<12|Ft[r.charCodeAt(e+2)]<<6|Ft[r.charCodeAt(e+3)],a[c++]=i>>16&255,a[c++]=i>>8&255,a[c++]=i&255;return s===2?(i=Ft[r.charCodeAt(e)]<<2|Ft[r.charCodeAt(e+1)]>>4,a[c++]=i&255):s===1&&(i=Ft[r.charCodeAt(e)]<<10|Ft[r.charCodeAt(e+1)]<<4|Ft[r.charCodeAt(e+2)]>>2,a[c++]=i>>8&255,a[c++]=i&255),a}function wh(r){return Zt[r>>18&63]+Zt[r>>12&63]+Zt[r>>6&63]+Zt[r&63]}function Ah(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16)+(r[s+1]<<8)+r[s+2],i.push(wh(n));return i.join("")}function mu(r){wc||Qu();for(var e,t=r.length,n=t%3,i="",s=[],a=16383,o=0,c=t-n;o<c;o+=a)s.push(Ah(r,o,o+a>c?c:o+a));return n===1?(e=r[t-1],i+=Zt[e>>2],i+=Zt[e<<4&63],i+="=="):n===2&&(e=(r[t-2]<<8)+r[t-1],i+=Zt[e>>10],i+=Zt[e>>4&63],i+=Zt[e<<2&63],i+="="),s.push(i),s.join("")}function Ks(r,e,t,n,i){var s,a,o=i*8-n-1,c=(1<<o)-1,f=c>>1,l=-7,h=t?i-1:0,_=t?-1:1,m=r[e+h];for(h+=_,s=m&(1<<-l)-1,m>>=-l,l+=o;l>0;s=s*256+r[e+h],h+=_,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=a*256+r[e+h],h+=_,l-=8);if(s===0)s=1-f;else{if(s===c)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-f}return(m?-1:1)*a*Math.pow(2,s-n)}function Zu(r,e,t,n,i,s){var a,o,c,f=s*8-i-1,l=(1<<f)-1,h=l>>1,_=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:s-1,I=n?1:-1,b=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=_/c:e+=_*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=l?(o=0,a=l):a+h>=1?(o=(e*c-1)*Math.pow(2,i),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;r[t+m]=o&255,m+=I,o/=256,i-=8);for(a=a<<i|o,f+=i;f>0;r[t+m]=a&255,m+=I,a/=256,f-=8);r[t+m-I]|=b*128}var bh={}.toString,el=Array.isArray||function(r){return bh.call(r)=="[object Array]"};var Th=50;L.TYPED_ARRAY_SUPPORT=Ln.TYPED_ARRAY_SUPPORT!==void 0?Ln.TYPED_ARRAY_SUPPORT:!0;function sc(){return L.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function lr(r,e){if(sc()<e)throw new RangeError("Invalid typed array length");return L.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e),r.__proto__=L.prototype):(r===null&&(r=new L(e)),r.length=e),r}function L(r,e,t){if(!L.TYPED_ARRAY_SUPPORT&&!(this instanceof L))return new L(r,e,t);if(typeof r=="number"){if(typeof e=="string")throw new Error("If encoding is specified then the first argument must be a string");return Ac(this,r)}return tl(this,r,e,t)}L.poolSize=8192;L._augment=function(r){return r.__proto__=L.prototype,r};function tl(r,e,t,n){if(typeof e=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer?xh(r,e,t,n):typeof e=="string"?Oh(r,e,t):Wh(r,e)}L.from=function(r,e,t){return tl(null,r,e,t)};L.TYPED_ARRAY_SUPPORT&&(L.prototype.__proto__=Uint8Array.prototype,L.__proto__=Uint8Array);function rl(r){if(typeof r!="number")throw new TypeError('"size" argument must be a number');if(r<0)throw new RangeError('"size" argument must not be negative')}function Ch(r,e,t,n){return rl(e),e<=0?lr(r,e):t!==void 0?typeof n=="string"?lr(r,e).fill(t,n):lr(r,e).fill(t):lr(r,e)}L.alloc=function(r,e,t){return Ch(null,r,e,t)};function Ac(r,e){if(rl(e),r=lr(r,e<0?0:bc(e)|0),!L.TYPED_ARRAY_SUPPORT)for(var t=0;t<e;++t)r[t]=0;return r}L.allocUnsafe=function(r){return Ac(null,r)};L.allocUnsafeSlow=function(r){return Ac(null,r)};function Oh(r,e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!L.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');var n=nl(e,t)|0;r=lr(r,n);var i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}function ac(r,e){var t=e.length<0?0:bc(e.length)|0;r=lr(r,t);for(var n=0;n<t;n+=1)r[n]=e[n]&255;return r}function xh(r,e,t,n){if(e.byteLength,t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(n||0))throw new RangeError("'length' is out of bounds");return t===void 0&&n===void 0?e=new Uint8Array(e):n===void 0?e=new Uint8Array(e,t):e=new Uint8Array(e,t,n),L.TYPED_ARRAY_SUPPORT?(r=e,r.__proto__=L.prototype):r=ac(r,e),r}function Wh(r,e){if(er(e)){var t=bc(e.length)|0;return r=lr(r,t),r.length===0||e.copy(r,0,0,t),r}if(e){if(typeof ArrayBuffer<"u"&&e.buffer instanceof ArrayBuffer||"length"in e)return typeof e.length!="number"||Xh(e.length)?lr(r,0):ac(r,e);if(e.type==="Buffer"&&el(e.data))return ac(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function bc(r){if(r>=sc())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+sc().toString(16)+" bytes");return r|0}L.isBuffer=ll;function er(r){return!!(r!=null&&r._isBuffer)}L.compare=function(e,t){if(!er(e)||!er(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,s=0,a=Math.min(n,i);s<a;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0};L.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};L.concat=function(e,t){if(!el(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return L.alloc(0);var n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=L.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var a=e[n];if(!er(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,s),s+=a.length}return i};function nl(r,e){if(er(r))return r.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;typeof r!="string"&&(r=""+r);var t=r.length;if(t===0)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return Us(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return ul(r).length;default:if(n)return Us(r).length;e=(""+e).toLowerCase(),n=!0}}L.byteLength=nl;function Rh(r,e,t){var n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return $h(this,e,t);case"utf8":case"utf-8":return al(this,e,t);case"ascii":return Ph(this,e,t);case"latin1":case"binary":return Mh(this,e,t);case"base64":return Bh(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gh(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}L.prototype._isBuffer=!0;function fn(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}L.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)fn(this,t,t+1);return this};L.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)fn(this,t,t+3),fn(this,t+1,t+2);return this};L.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)fn(this,t,t+7),fn(this,t+1,t+6),fn(this,t+2,t+5),fn(this,t+3,t+4);return this};L.prototype.toString=function(){var e=this.length|0;return e===0?"":arguments.length===0?al(this,0,e):Rh.apply(this,arguments)};L.prototype.equals=function(e){if(!er(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:L.compare(this,e)===0};L.prototype.inspect=function(){var e="",t=Th;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"};L.prototype.compare=function(e,t,n,i,s){if(!er(e))throw new TypeError("Argument must be a Buffer");if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;for(var a=s-i,o=n-t,c=Math.min(a,o),f=this.slice(i,s),l=e.slice(t,n),h=0;h<c;++h)if(f[h]!==l[h]){a=f[h],o=l[h];break}return a<o?-1:o<a?1:0};function il(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=L.from(e,n)),er(e))return e.length===0?-1:Eu(r,e,t,n,i);if(typeof e=="number")return e=e&255,L.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Eu(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function Eu(r,e,t,n,i){var s=1,a=r.length,o=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,a/=2,o/=2,t/=2}function c(m,I){return s===1?m[I]:m.readUInt16BE(I*s)}var f;if(i){var l=-1;for(f=t;f<a;f++)if(c(r,f)===c(e,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===o)return l*s}else l!==-1&&(f-=f-l),l=-1}else for(t+o>a&&(t=a-o),f=t;f>=0;f--){for(var h=!0,_=0;_<o;_++)if(c(r,f+_)!==c(e,_)){h=!1;break}if(h)return f}return-1}L.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1};L.prototype.indexOf=function(e,t,n){return il(this,e,t,n,!0)};L.prototype.lastIndexOf=function(e,t,n){return il(this,e,t,n,!1)};function Fh(r,e,t,n){t=Number(t)||0;var i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;var s=e.length;if(s%2!==0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o=parseInt(e.substr(a*2,2),16);if(isNaN(o))return a;r[t+a]=o}return a}function Dh(r,e,t,n){return Js(Us(e,r.length-t),r,t,n)}function sl(r,e,t,n){return Js(jh(e),r,t,n)}function Nh(r,e,t,n){return sl(r,e,t,n)}function kh(r,e,t,n){return Js(ul(e),r,t,n)}function Lh(r,e,t,n){return Js(Kh(e,r.length-t),r,t,n)}L.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t|0,isFinite(n)?(n=n|0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-t;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return Fh(this,e,t,n);case"utf8":case"utf-8":return Dh(this,e,t,n);case"ascii":return sl(this,e,t,n);case"latin1":case"binary":return Nh(this,e,t,n);case"base64":return kh(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lh(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}};L.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Bh(r,e,t){return e===0&&t===r.length?mu(r):mu(r.slice(e,t))}function al(r,e,t){t=Math.min(r.length,t);for(var n=[],i=e;i<t;){var s=r[i],a=null,o=s>239?4:s>223?3:s>191?2:1;if(i+o<=t){var c,f,l,h;switch(o){case 1:s<128&&(a=s);break;case 2:c=r[i+1],(c&192)===128&&(h=(s&31)<<6|c&63,h>127&&(a=h));break;case 3:c=r[i+1],f=r[i+2],(c&192)===128&&(f&192)===128&&(h=(s&15)<<12|(c&63)<<6|f&63,h>2047&&(h<55296||h>57343)&&(a=h));break;case 4:c=r[i+1],f=r[i+2],l=r[i+3],(c&192)===128&&(f&192)===128&&(l&192)===128&&(h=(s&15)<<18|(c&63)<<12|(f&63)<<6|l&63,h>65535&&h<1114112&&(a=h))}}a===null?(a=65533,o=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=o}return Uh(n)}var yu=4096;function Uh(r){var e=r.length;if(e<=yu)return String.fromCharCode.apply(String,r);for(var t="",n=0;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=yu));return t}function Ph(r,e,t){var n="";t=Math.min(r.length,t);for(var i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}function Mh(r,e,t){var n="";t=Math.min(r.length,t);for(var i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}function $h(r,e,t){var n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);for(var i="",s=e;s<t;++s)i+=zh(r[s]);return i}function Gh(r,e,t){for(var n=r.slice(e,t),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}L.prototype.slice=function(e,t){var n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);var i;if(L.TYPED_ARRAY_SUPPORT)i=this.subarray(e,t),i.__proto__=L.prototype;else{var s=t-e;i=new L(s,void 0);for(var a=0;a<s;++a)i[a]=this[a+e]}return i};function Je(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}L.prototype.readUIntLE=function(e,t,n){e=e|0,t=t|0,n||Je(e,t,this.length);for(var i=this[e],s=1,a=0;++a<t&&(s*=256);)i+=this[e+a]*s;return i};L.prototype.readUIntBE=function(e,t,n){e=e|0,t=t|0,n||Je(e,t,this.length);for(var i=this[e+--t],s=1;t>0&&(s*=256);)i+=this[e+--t]*s;return i};L.prototype.readUInt8=function(e,t){return t||Je(e,1,this.length),this[e]};L.prototype.readUInt16LE=function(e,t){return t||Je(e,2,this.length),this[e]|this[e+1]<<8};L.prototype.readUInt16BE=function(e,t){return t||Je(e,2,this.length),this[e]<<8|this[e+1]};L.prototype.readUInt32LE=function(e,t){return t||Je(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};L.prototype.readUInt32BE=function(e,t){return t||Je(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};L.prototype.readIntLE=function(e,t,n){e=e|0,t=t|0,n||Je(e,t,this.length);for(var i=this[e],s=1,a=0;++a<t&&(s*=256);)i+=this[e+a]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i};L.prototype.readIntBE=function(e,t,n){e=e|0,t=t|0,n||Je(e,t,this.length);for(var i=t,s=1,a=this[e+--i];i>0&&(s*=256);)a+=this[e+--i]*s;return s*=128,a>=s&&(a-=Math.pow(2,8*t)),a};L.prototype.readInt8=function(e,t){return t||Je(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};L.prototype.readInt16LE=function(e,t){t||Je(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};L.prototype.readInt16BE=function(e,t){t||Je(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};L.prototype.readInt32LE=function(e,t){return t||Je(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};L.prototype.readInt32BE=function(e,t){return t||Je(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};L.prototype.readFloatLE=function(e,t){return t||Je(e,4,this.length),Ks(this,e,!0,23,4)};L.prototype.readFloatBE=function(e,t){return t||Je(e,4,this.length),Ks(this,e,!1,23,4)};L.prototype.readDoubleLE=function(e,t){return t||Je(e,8,this.length),Ks(this,e,!0,52,8)};L.prototype.readDoubleBE=function(e,t){return t||Je(e,8,this.length),Ks(this,e,!1,52,8)};function It(r,e,t,n,i,s){if(!er(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}L.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t=t|0,n=n|0,!i){var s=Math.pow(2,8*n)-1;It(this,e,t,n,s,0)}var a=1,o=0;for(this[t]=e&255;++o<n&&(a*=256);)this[t+o]=e/a&255;return t+n};L.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t=t|0,n=n|0,!i){var s=Math.pow(2,8*n)-1;It(this,e,t,n,s,0)}var a=n-1,o=1;for(this[t+a]=e&255;--a>=0&&(o*=256);)this[t+a]=e/o&255;return t+n};L.prototype.writeUInt8=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,1,255,0),L.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=e&255,t+1};function Xs(r,e,t,n){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(r.length-t,2);i<s;++i)r[t+i]=(e&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}L.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,2,65535,0),L.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):Xs(this,e,t,!0),t+2};L.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,2,65535,0),L.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):Xs(this,e,t,!1),t+2};function qs(r,e,t,n){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(r.length-t,4);i<s;++i)r[t+i]=e>>>(n?i:3-i)*8&255}L.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,4,4294967295,0),L.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255):qs(this,e,t,!0),t+4};L.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,4,4294967295,0),L.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):qs(this,e,t,!1),t+4};L.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t=t|0,!i){var s=Math.pow(2,8*n-1);It(this,e,t,n,s-1,-s)}var a=0,o=1,c=0;for(this[t]=e&255;++a<n&&(o*=256);)e<0&&c===0&&this[t+a-1]!==0&&(c=1),this[t+a]=(e/o>>0)-c&255;return t+n};L.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t=t|0,!i){var s=Math.pow(2,8*n-1);It(this,e,t,n,s-1,-s)}var a=n-1,o=1,c=0;for(this[t+a]=e&255;--a>=0&&(o*=256);)e<0&&c===0&&this[t+a+1]!==0&&(c=1),this[t+a]=(e/o>>0)-c&255;return t+n};L.prototype.writeInt8=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,1,127,-128),L.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=e&255,t+1};L.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,2,32767,-32768),L.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8):Xs(this,e,t,!0),t+2};L.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,2,32767,-32768),L.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=e&255):Xs(this,e,t,!1),t+2};L.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,4,2147483647,-2147483648),L.TYPED_ARRAY_SUPPORT?(this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):qs(this,e,t,!0),t+4};L.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t|0,n||It(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),L.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255):qs(this,e,t,!1),t+4};function ol(r,e,t,n,i,s){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function cl(r,e,t,n,i){return i||ol(r,e,t,4,34028234663852886e22,-34028234663852886e22),Zu(r,e,t,n,23,4),t+4}L.prototype.writeFloatLE=function(e,t,n){return cl(this,e,t,!0,n)};L.prototype.writeFloatBE=function(e,t,n){return cl(this,e,t,!1,n)};function fl(r,e,t,n,i){return i||ol(r,e,t,8,17976931348623157e292,-17976931348623157e292),Zu(r,e,t,n,52,8),t+8}L.prototype.writeDoubleLE=function(e,t,n){return fl(this,e,t,!0,n)};L.prototype.writeDoubleBE=function(e,t,n){return fl(this,e,t,!1,n)};L.prototype.copy=function(e,t,n,i){if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var s=i-n,a;if(this===e&&n<t&&t<i)for(a=s-1;a>=0;--a)e[a+t]=this[a+n];else if(s<1e3||!L.TYPED_ARRAY_SUPPORT)for(a=0;a<s;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s};L.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),e.length===1){var s=e.charCodeAt(0);s<256&&(e=s)}if(i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!L.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else typeof e=="number"&&(e=e&255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);var a;if(typeof e=="number")for(a=t;a<n;++a)this[a]=e;else{var o=er(e)?e:Us(new L(e,i).toString()),c=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%c]}return this};var Hh=/[^+\/0-9A-Za-z-_]/g;function Yh(r){if(r=Vh(r).replace(Hh,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Vh(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function zh(r){return r<16?"0"+r.toString(16):r.toString(16)}function Us(r,e){e=e||1/0;for(var t,n=r.length,i=null,s=[],a=0;a<n;++a){if(t=r.charCodeAt(a),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(a+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function jh(r){for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Kh(r,e){for(var t,n,i,s=[],a=0;a<r.length&&!((e-=2)<0);++a)t=r.charCodeAt(a),n=t>>8,i=t%256,s.push(i),s.push(n);return s}function ul(r){return Ih(Yh(r))}function Js(r,e,t,n){for(var i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}function Xh(r){return r!==r}function ll(r){return r!=null&&(!!r._isBuffer||dl(r)||qh(r))}function dl(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function qh(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&dl(r.slice(0,0))}var ln=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ce(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function pe(r,e){return e={exports:{}},r(e,e.exports),e.exports}var Jh=Math.ceil,Qh=Math.floor,Tc=function(r){return isNaN(r=+r)?0:(r>0?Qh:Jh)(r)},Cc=function(r){if(r==null)throw TypeError("Can't call method on  "+r);return r},Zh=function(r){return function(e,t){var n=String(Cc(e)),i=Tc(t),s=n.length,a,o;return i<0||i>=s?r?"":void 0:(a=n.charCodeAt(i),a<55296||a>56319||i+1===s||(o=n.charCodeAt(i+1))<56320||o>57343?r?n.charAt(i):a:r?n.slice(i,i+2):(a-55296<<10)+(o-56320)+65536)}},yi=!0,je=pe(function(r){var e=r.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)}),Te=pe(function(r){var e=r.exports={version:"2.6.12"};typeof __e=="number"&&(__e=e)}),Iv=Te.version,oc=function(r){if(typeof r!="function")throw TypeError(r+" is not a function!");return r},Pr=function(r,e,t){if(oc(r),e===void 0)return r;switch(t){case 1:return function(n){return r.call(e,n)};case 2:return function(n,i){return r.call(e,n,i)};case 3:return function(n,i,s){return r.call(e,n,i,s)}}return function(){return r.apply(e,arguments)}},qe=function(r){return typeof r=="object"?r!==null:typeof r=="function"},Ot=function(r){if(!qe(r))throw TypeError(r+" is not an object!");return r},gr=function(r){try{return!!r()}catch{return!0}},yt=!gr(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),cc=je.document,e_=qe(cc)&&qe(cc.createElement),hl=function(r){return e_?cc.createElement(r):{}},_l=!yt&&!gr(function(){return Object.defineProperty(hl("div"),"a",{get:function(){return 7}}).a!=7}),Ti=function(r,e){if(!qe(r))return r;var t,n;if(e&&typeof(t=r.toString)=="function"&&!qe(n=t.call(r))||typeof(t=r.valueOf)=="function"&&!qe(n=t.call(r))||!e&&typeof(t=r.toString)=="function"&&!qe(n=t.call(r)))return n;throw TypeError("Can't convert object to primitive value")},t_=Object.defineProperty,r_=yt?Object.defineProperty:function(e,t,n){if(Ot(e),t=Ti(t,!0),Ot(n),_l)try{return t_(e,t,n)}catch{}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e},Lt={f:r_},dn=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}},hr=yt?function(r,e,t){return Lt.f(r,e,dn(1,t))}:function(r,e,t){return r[e]=t,r},n_={}.hasOwnProperty,ye=function(r,e){return n_.call(r,e)},ys="prototype",it=function(r,e,t){var n=r&it.F,i=r&it.G,s=r&it.S,a=r&it.P,o=r&it.B,c=r&it.W,f=i?Te:Te[e]||(Te[e]={}),l=f[ys],h=i?je:s?je[e]:(je[e]||{})[ys],_,m,I;i&&(t=e);for(_ in t)m=!n&&h&&h[_]!==void 0,!(m&&ye(f,_))&&(I=m?h[_]:t[_],f[_]=i&&typeof h[_]!="function"?t[_]:o&&m?Pr(I,je):c&&h[_]==I?function(b){var H=function(M,K,V){if(this instanceof b){switch(arguments.length){case 0:return new b;case 1:return new b(M);case 2:return new b(M,K)}return new b(M,K,V)}return b.apply(this,arguments)};return H[ys]=b[ys],H}(I):a&&typeof I=="function"?Pr(Function.call,I):I,a&&((f.virtual||(f.virtual={}))[_]=I,r&it.R&&l&&!l[_]&&hr(l,_,I)))};it.F=1;it.G=2;it.S=4;it.P=8;it.B=16;it.W=32;it.U=64;it.R=128;var ne=it,Ps=hr,_r={},i_={}.toString,Ii=function(r){return i_.call(r).slice(8,-1)},Oc=Object("z").propertyIsEnumerable(0)?Object:function(r){return Ii(r)=="String"?r.split(""):Object(r)},rr=function(r){return Oc(Cc(r))},s_=Math.min,Qs=function(r){return r>0?s_(Tc(r),9007199254740991):0},a_=Math.max,o_=Math.min,c_=function(r,e){return r=Tc(r),r<0?a_(r+e,0):o_(r,e)},f_=function(r){return function(e,t,n){var i=rr(e),s=Qs(i.length),a=c_(n,s),o;if(r&&t!=t){for(;s>a;)if(o=i[a++],o!=o)return!0}else for(;s>a;a++)if((r||a in i)&&i[a]===t)return r||a||0;return!r&&-1}},Ci=pe(function(r){var e="__core-js_shared__",t=je[e]||(je[e]={});(r.exports=function(n,i){return t[n]||(t[n]=i!==void 0?i:{})})("versions",[]).push({version:Te.version,mode:yi?"pure":"global",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})}),u_=0,l_=Math.random(),Zs=function(r){return"Symbol(".concat(r===void 0?"":r,")_",(++u_+l_).toString(36))},Iu=Ci("keys"),xc=function(r){return Iu[r]||(Iu[r]=Zs(r))},d_=f_(!1),h_=xc("IE_PROTO"),pl=function(r,e){var t=rr(r),n=0,i=[],s;for(s in t)s!=h_&&ye(t,s)&&i.push(s);for(;e.length>n;)ye(t,s=e[n++])&&(~d_(i,s)||i.push(s));return i},Ms="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),wi=Object.keys||function(e){return pl(e,Ms)},__=yt?Object.defineProperties:function(e,t){Ot(e);for(var n=wi(t),i=n.length,s=0,a;i>s;)Lt.f(e,a=n[s++],t[a]);return e},wu=je.document,p_=wu&&wu.documentElement,S_=xc("IE_PROTO"),Po=function(){},fc="prototype",Ns=function(){var r=hl("iframe"),e=Ms.length,t="<",n=">",i;for(r.style.display="none",p_.appendChild(r),r.src="javascript:",i=r.contentWindow.document,i.open(),i.write(t+"script"+n+"document.F=Object"+t+"/script"+n),i.close(),Ns=i.F;e--;)delete Ns[fc][Ms[e]];return Ns()},Mr=Object.create||function(e,t){var n;return e!==null?(Po[fc]=Ot(e),n=new Po,Po[fc]=null,n[S_]=e):n=Ns(),t===void 0?n:__(n,t)},et=pe(function(r){var e=Ci("wks"),t=je.Symbol,n=typeof t=="function",i=r.exports=function(s){return e[s]||(e[s]=n&&t[s]||(n?t:Zs)("Symbol."+s))};i.store=e}),g_=Lt.f,Au=et("toStringTag"),Un=function(r,e,t){r&&!ye(r=t?r:r.prototype,Au)&&g_(r,Au,{configurable:!0,value:e})},Sl={};hr(Sl,et("iterator"),function(){return this});var v_=function(r,e,t){r.prototype=Mr(Sl,{next:dn(1,t)}),Un(r,e+" Iterator")},Pn=function(r){return Object(Cc(r))},bu=xc("IE_PROTO"),m_=Object.prototype,gl=Object.getPrototypeOf||function(r){return r=Pn(r),ye(r,bu)?r[bu]:typeof r.constructor=="function"&&r instanceof r.constructor?r.constructor.prototype:r instanceof Object?m_:null},Si=et("iterator"),Mo=!([].keys&&"next"in[].keys()),E_="@@iterator",Tu="keys",Is="values",Cu=function(){return this},Wc=function(r,e,t,n,i,s,a){v_(t,e,n);var o=function(V){if(!Mo&&V in h)return h[V];switch(V){case Tu:return function(){return new t(this,V)};case Is:return function(){return new t(this,V)}}return function(){return new t(this,V)}},c=e+" Iterator",f=i==Is,l=!1,h=r.prototype,_=h[Si]||h[E_]||i&&h[i],m=_||o(i),I=i?f?o("entries"):m:void 0,b=e=="Array"&&h.entries||_,H,M,K;if(b&&(K=gl(b.call(new r)),K!==Object.prototype&&K.next&&(Un(K,c,!0),!yi&&typeof K[Si]!="function"&&hr(K,Si,Cu))),f&&_&&_.name!==Is&&(l=!0,m=function(){return _.call(this)}),(!yi||a)&&(Mo||l||!h[Si])&&hr(h,Si,m),_r[e]=m,_r[c]=Cu,i)if(H={values:f?m:o(Is),keys:s?m:o(Tu),entries:I},a)for(M in H)M in h||Ps(h,M,H[M]);else ne(ne.P+ne.F*(Mo||l),e,H);return H},y_=Zh(!0);Wc(String,"String",function(r){this._t=String(r),this._i=0},function(){var r=this._t,e=this._i,t;return e>=r.length?{value:void 0,done:!0}:(t=y_(r,e),this._i+=t.length,{value:t,done:!1})});var Nr=function(r,e){return{value:e,done:!!r}},wv=Wc(Array,"Array",function(r,e){this._t=rr(r),this._i=0,this._k=e},function(){var r=this._t,e=this._k,t=this._i++;return!r||t>=r.length?(this._t=void 0,Nr(1)):e=="keys"?Nr(0,t):e=="values"?Nr(0,r[t]):Nr(0,[t,r[t]])},"values");_r.Arguments=_r.Array;var Ou=et("toStringTag"),xu="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(",");for(ws=0;ws<xu.length;ws++)As=xu[ws],$o=je[As],bs=$o&&$o.prototype,bs&&!bs[Ou]&&hr(bs,Ou,As),_r[As]=_r.Array;var As,$o,bs,ws,I_=et,Rc={f:I_},w_=Rc.f("iterator"),vl=pe(function(r){r.exports={default:w_,__esModule:!0}});Ce(vl);var Nt=pe(function(r){var e=Zs("meta"),t=Lt.f,n=0,i=Object.isExtensible||function(){return!0},s=!gr(function(){return i(Object.preventExtensions({}))}),a=function(h){t(h,e,{value:{i:"O"+ ++n,w:{}}})},o=function(h,_){if(!qe(h))return typeof h=="symbol"?h:(typeof h=="string"?"S":"P")+h;if(!ye(h,e)){if(!i(h))return"F";if(!_)return"E";a(h)}return h[e].i},c=function(h,_){if(!ye(h,e)){if(!i(h))return!0;if(!_)return!1;a(h)}return h[e].w},f=function(h){return s&&l.NEED&&i(h)&&!ye(h,e)&&a(h),h},l=r.exports={KEY:e,NEED:!1,fastKey:o,getWeak:c,onFreeze:f}}),Av=Nt.KEY,bv=Nt.NEED,Tv=Nt.fastKey,Cv=Nt.getWeak,Ov=Nt.onFreeze,A_=Lt.f,Fc=function(r){var e=Te.Symbol||(Te.Symbol=yi?{}:je.Symbol||{});r.charAt(0)!="_"&&!(r in e)&&A_(e,r,{value:Rc.f(r)})},b_=Object.getOwnPropertySymbols,Mn={f:b_},T_={}.propertyIsEnumerable,ea={f:T_},C_=function(r){var e=wi(r),t=Mn.f;if(t)for(var n=t(r),i=ea.f,s=0,a;n.length>s;)i.call(r,a=n[s++])&&e.push(a);return e},uc=Array.isArray||function(e){return Ii(e)=="Array"},O_=Ms.concat("length","prototype"),x_=Object.getOwnPropertyNames||function(e){return pl(e,O_)},ml={f:x_},El=ml.f,W_={}.toString,yl=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],R_=function(r){try{return El(r)}catch{return yl.slice()}},F_=function(e){return yl&&W_.call(e)=="[object Window]"?R_(e):El(rr(e))},Il={f:F_},Wu=Object.getOwnPropertyDescriptor,D_=yt?Wu:function(e,t){if(e=rr(e),t=Ti(t,!0),_l)try{return Wu(e,t)}catch{}if(ye(e,t))return dn(!ea.f.call(e,t),e[t])},ta={f:D_},N_=Nt.KEY,wl=ta.f,cn=Lt.f,Al=Il.f,Et=je.Symbol,$s=je.JSON,Ts=$s&&$s.stringify,Lr="prototype",mt=et("_hidden"),Ru=et("toPrimitive"),k_={}.propertyIsEnumerable,gi=Ci("symbol-registry"),pr=Ci("symbols"),Oi=Ci("op-symbols"),Dt=Object[Lr],$n=typeof Et=="function"&&!!Mn.f,Go=je.QObject,lc=!Go||!Go[Lr]||!Go[Lr].findChild,dc=yt&&gr(function(){return Mr(cn({},"a",{get:function(){return cn(this,"a",{value:7}).a}})).a!=7})?function(r,e,t){var n=wl(Dt,e);n&&delete Dt[e],cn(r,e,t),n&&r!==Dt&&cn(Dt,e,n)}:cn,Fu=function(r){var e=pr[r]=Mr(Et[Lr]);return e._k=r,e},hc=$n&&typeof Et.iterator=="symbol"?function(r){return typeof r=="symbol"}:function(r){return r instanceof Et},ra=function(e,t,n){return e===Dt&&ra(Oi,t,n),Ot(e),t=Ti(t,!0),Ot(n),ye(pr,t)?(n.enumerable?(ye(e,mt)&&e[mt][t]&&(e[mt][t]=!1),n=Mr(n,{enumerable:dn(0,!1)})):(ye(e,mt)||cn(e,mt,dn(1,{})),e[mt][t]=!0),dc(e,t,n)):cn(e,t,n)},bl=function(e,t){Ot(e);for(var n=C_(t=rr(t)),i=0,s=n.length,a;s>i;)ra(e,a=n[i++],t[a]);return e},L_=function(e,t){return t===void 0?Mr(e):bl(Mr(e),t)},Du=function(e){var t=k_.call(this,e=Ti(e,!0));return this===Dt&&ye(pr,e)&&!ye(Oi,e)?!1:t||!ye(this,e)||!ye(pr,e)||ye(this,mt)&&this[mt][e]?t:!0},Tl=function(e,t){if(e=rr(e),t=Ti(t,!0),!(e===Dt&&ye(pr,t)&&!ye(Oi,t))){var n=wl(e,t);return n&&ye(pr,t)&&!(ye(e,mt)&&e[mt][t])&&(n.enumerable=!0),n}},Cl=function(e){for(var t=Al(rr(e)),n=[],i=0,s;t.length>i;)!ye(pr,s=t[i++])&&s!=mt&&s!=N_&&n.push(s);return n},Ol=function(e){for(var t=e===Dt,n=Al(t?Oi:rr(e)),i=[],s=0,a;n.length>s;)ye(pr,a=n[s++])&&(!t||ye(Dt,a))&&i.push(pr[a]);return i};$n||(Et=function(){if(this instanceof Et)throw TypeError("Symbol is not a constructor!");var e=Zs(arguments.length>0?arguments[0]:void 0),t=function(n){this===Dt&&t.call(Oi,n),ye(this,mt)&&ye(this[mt],e)&&(this[mt][e]=!1),dc(this,e,dn(1,n))};return yt&&lc&&dc(Dt,e,{configurable:!0,set:t}),Fu(e)},Ps(Et[Lr],"toString",function(){return this._k}),ta.f=Tl,Lt.f=ra,ml.f=Il.f=Cl,ea.f=Du,Mn.f=Ol,yt&&!yi&&Ps(Dt,"propertyIsEnumerable",Du,!0),Rc.f=function(r){return Fu(et(r))});ne(ne.G+ne.W+ne.F*!$n,{Symbol:Et});for(Ho="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Yo=0;Ho.length>Yo;)et(Ho[Yo++]);var Ho,Yo;for(Vo=wi(et.store),zo=0;Vo.length>zo;)Fc(Vo[zo++]);var Vo,zo;ne(ne.S+ne.F*!$n,"Symbol",{for:function(r){return ye(gi,r+="")?gi[r]:gi[r]=Et(r)},keyFor:function(e){if(!hc(e))throw TypeError(e+" is not a symbol!");for(var t in gi)if(gi[t]===e)return t},useSetter:function(){lc=!0},useSimple:function(){lc=!1}});ne(ne.S+ne.F*!$n,"Object",{create:L_,defineProperty:ra,defineProperties:bl,getOwnPropertyDescriptor:Tl,getOwnPropertyNames:Cl,getOwnPropertySymbols:Ol});var B_=gr(function(){Mn.f(1)});ne(ne.S+ne.F*B_,"Object",{getOwnPropertySymbols:function(e){return Mn.f(Pn(e))}});$s&&ne(ne.S+ne.F*(!$n||gr(function(){var r=Et();return Ts([r])!="[null]"||Ts({a:r})!="{}"||Ts(Object(r))!="{}"})),"JSON",{stringify:function(e){for(var t=[e],n=1,i,s;arguments.length>n;)t.push(arguments[n++]);if(s=i=t[1],!(!qe(i)&&e===void 0||hc(e)))return uc(i)||(i=function(a,o){if(typeof s=="function"&&(o=s.call(this,a,o)),!hc(o))return o}),t[1]=i,Ts.apply($s,t)}});Et[Lr][Ru]||hr(Et[Lr],Ru,Et[Lr].valueOf);Un(Et,"Symbol");Un(Math,"Math",!0);Un(je.JSON,"JSON",!0);Fc("asyncIterator");Fc("observable");var U_=Te.Symbol,xl=pe(function(r){r.exports={default:U_,__esModule:!0}});Ce(xl);var Dc=pe(function(r,e){e.__esModule=!0;var t=s(vl),n=s(xl),i=typeof n.default=="function"&&typeof t.default=="symbol"?function(a){return typeof a}:function(a){return a&&typeof n.default=="function"&&a.constructor===n.default&&a!==n.default.prototype?"symbol":typeof a};function s(a){return a&&a.__esModule?a:{default:a}}e.default=typeof n.default=="function"&&i(t.default)==="symbol"?function(a){return typeof a>"u"?"undefined":i(a)}:function(a){return a&&typeof n.default=="function"&&a.constructor===n.default&&a!==n.default.prototype?"symbol":typeof a>"u"?"undefined":i(a)}}),P_=Ce(Dc),Cs=Object.assign,Wl=!Cs||gr(function(){var r={},e={},t=Symbol(),n="abcdefghijklmnopqrst";return r[t]=7,n.split("").forEach(function(i){e[i]=i}),Cs({},r)[t]!=7||Object.keys(Cs({},e)).join("")!=n})?function(e,t){for(var n=Pn(e),i=arguments.length,s=1,a=Mn.f,o=ea.f;i>s;)for(var c=Oc(arguments[s++]),f=a?wi(c).concat(a(c)):wi(c),l=f.length,h=0,_;l>h;)_=f[h++],(!yt||o.call(c,_))&&(n[_]=c[_]);return n}:Cs;ne(ne.S+ne.F,"Object",{assign:Wl});var M_=Te.Object.assign,Rl=pe(function(r){r.exports={default:M_,__esModule:!0}});Ce(Rl);var $_=pe(function(r,e){e.__esModule=!0;var t=n(Rl);function n(i){return i&&i.__esModule?i:{default:i}}e.default=t.default||function(i){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])}return i}}),Rn=Ce($_),Fl=function(r,e,t,n){try{return n?e(Ot(t)[0],t[1]):e(t)}catch(s){var i=r.return;throw i!==void 0&&Ot(i.call(r)),s}},G_=et("iterator"),H_=Array.prototype,Dl=function(r){return r!==void 0&&(_r.Array===r||H_[G_]===r)},Nu=function(r,e,t){e in r?Lt.f(r,e,dn(0,t)):r[e]=t},Y_=et("toStringTag"),V_=Ii(function(){return arguments}())=="Arguments",z_=function(r,e){try{return r[e]}catch{}},Nc=function(r){var e,t,n;return r===void 0?"Undefined":r===null?"Null":typeof(t=z_(e=Object(r),Y_))=="string"?t:V_?Ii(e):(n=Ii(e))=="Object"&&typeof e.callee=="function"?"Arguments":n},j_=et("iterator"),kc=Te.getIteratorMethod=function(r){if(r!=null)return r[j_]||r["@@iterator"]||_r[Nc(r)]},_c=et("iterator"),Nl=!1;try{ku=[7][_c](),ku.return=function(){Nl=!0}}catch{}var ku,K_=function(r,e){if(!e&&!Nl)return!1;var t=!1;try{var n=[7],i=n[_c]();i.next=function(){return{done:t=!0}},n[_c]=function(){return i},r(n)}catch{}return t};ne(ne.S+ne.F*!K_(function(r){}),"Array",{from:function(e){var t=Pn(e),n=typeof this=="function"?this:Array,i=arguments.length,s=i>1?arguments[1]:void 0,a=s!==void 0,o=0,c=kc(t),f,l,h,_;if(a&&(s=Pr(s,i>2?arguments[2]:void 0,2)),c!=null&&!(n==Array&&Dl(c)))for(_=c.call(t),l=new n;!(h=_.next()).done;o++)Nu(l,o,a?Fl(_,s,[h.value,o],!0):h.value);else for(f=Qs(t.length),l=new n(f);f>o;o++)Nu(l,o,a?s(t[o],o):t[o]);return l.length=o,l}});var X_=Te.Array.from,kl=pe(function(r){r.exports={default:X_,__esModule:!0}});Ce(kl);var q_=pe(function(r,e){e.__esModule=!0;var t=n(kl);function n(i){return i&&i.__esModule?i:{default:i}}e.default=function(i){if(Array.isArray(i)){for(var s=0,a=Array(i.length);s<i.length;s++)a[s]=i[s];return a}else return(0,t.default)(i)}}),Re=Ce(q_),J_=et("iterator"),Q_=Te.isIterable=function(r){var e=Object(r);return e[J_]!==void 0||"@@iterator"in e||_r.hasOwnProperty(Nc(e))},Z_=Q_,Ll=pe(function(r){r.exports={default:Z_,__esModule:!0}});Ce(Ll);var e0=Te.getIterator=function(r){var e=kc(r);if(typeof e!="function")throw TypeError(r+" is not iterable!");return Ot(e.call(r))},t0=e0,Bl=pe(function(r){r.exports={default:t0,__esModule:!0}});Ce(Bl);var r0=pe(function(r,e){e.__esModule=!0;var t=i(Ll),n=i(Bl);function i(s){return s&&s.__esModule?s:{default:s}}e.default=function(){function s(a,o){var c=[],f=!0,l=!1,h=void 0;try{for(var _=(0,n.default)(a),m;!(f=(m=_.next()).done)&&(c.push(m.value),!(o&&c.length===o));f=!0);}catch(I){l=!0,h=I}finally{try{!f&&_.return&&_.return()}finally{if(l)throw h}}return c}return function(a,o){if(Array.isArray(a))return a;if((0,t.default)(Object(a)))return s(a,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),gt=Ce(r0),n0=pe(function(r,e){e.__esModule=!0,e.default=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}}),st=Ce(n0);ne(ne.S+ne.F*!yt,"Object",{defineProperty:Lt.f});var i0=Te.Object,s0=function(e,t,n){return i0.defineProperty(e,t,n)},Ul=pe(function(r){r.exports={default:s0,__esModule:!0}});Ce(Ul);var a0=pe(function(r,e){e.__esModule=!0;var t=n(Ul);function n(i){return i&&i.__esModule?i:{default:i}}e.default=function(){function i(s,a){for(var o=0;o<a.length;o++){var c=a[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),(0,t.default)(s,c.key,c)}}return function(s,a,o){return a&&i(s.prototype,a),o&&i(s,o),s}}()}),ut=Ce(a0);function Pl(){throw new Error("setTimeout has not been defined")}function Ml(){throw new Error("clearTimeout has not been defined")}var Fr=Pl,Dr=Ml;typeof Ln.setTimeout=="function"&&(Fr=setTimeout);typeof Ln.clearTimeout=="function"&&(Dr=clearTimeout);function $l(r){if(Fr===setTimeout)return setTimeout(r,0);if((Fr===Pl||!Fr)&&setTimeout)return Fr=setTimeout,setTimeout(r,0);try{return Fr(r,0)}catch{try{return Fr.call(null,r,0)}catch{return Fr.call(this,r,0)}}}function o0(r){if(Dr===clearTimeout)return clearTimeout(r);if((Dr===Ml||!Dr)&&clearTimeout)return Dr=clearTimeout,clearTimeout(r);try{return Dr(r)}catch{try{return Dr.call(null,r)}catch{return Dr.call(this,r)}}}var dr=[],Nn=!1,un,ks=-1;function c0(){!Nn||!un||(Nn=!1,un.length?dr=un.concat(dr):ks=-1,dr.length&&Gl())}function Gl(){if(!Nn){var r=$l(c0);Nn=!0;for(var e=dr.length;e;){for(un=dr,dr=[];++ks<e;)un&&un[ks].run();ks=-1,e=dr.length}un=null,Nn=!1,o0(r)}}function at(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];dr.push(new Hl(r,e)),dr.length===1&&!Nn&&$l(Gl)}function Hl(r,e){this.fun=r,this.array=e}Hl.prototype.run=function(){this.fun.apply(null,this.array)};var f0="browser",u0="browser",l0=!0,d0={},h0=[],_0="",p0={},S0={},g0={};function hn(){}var v0=hn,m0=hn,E0=hn,y0=hn,I0=hn,w0=hn,A0=hn;function b0(r){throw new Error("process.binding is not supported")}function T0(){return"/"}function C0(r){throw new Error("process.chdir is not supported")}function O0(){return 0}var Fn=Ln.performance||{},x0=Fn.now||Fn.mozNow||Fn.msNow||Fn.oNow||Fn.webkitNow||function(){return new Date().getTime()};function W0(r){var e=x0.call(Fn)*.001,t=Math.floor(e),n=Math.floor(e%1*1e9);return r&&(t=t-r[0],n=n-r[1],n<0&&(t--,n+=1e9)),[t,n]}var R0=new Date;function F0(){var r=new Date,e=r-R0;return e/1e3}var Ls={nextTick:at,title:f0,browser:l0,env:d0,argv:h0,version:_0,versions:p0,on:v0,addListener:m0,once:E0,off:y0,removeListener:I0,removeAllListeners:w0,emit:A0,binding:b0,cwd:T0,chdir:C0,umask:O0,hrtime:W0,platform:u0,release:S0,config:g0,uptime:F0};function Yl(r,e){for(var t=0,n=r.length-1;n>=0;n--){var i=r[n];i==="."?r.splice(n,1):i===".."?(r.splice(n,1),t++):t&&(r.splice(n,1),t--)}if(e)for(;t--;t)r.unshift("..");return r}var D0=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Lc=function(r){return D0.exec(r).slice(1)};function pc(){for(var r="",e=!1,t=arguments.length-1;t>=-1&&!e;t--){var n=t>=0?arguments[t]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;r=n+"/"+r,e=n.charAt(0)==="/"}return r=Yl(Bc(r.split("/"),function(i){return!!i}),!e).join("/"),(e?"/":"")+r||"."}function Vl(r){var e=zl(r),t=$0(r,-1)==="/";return r=Yl(Bc(r.split("/"),function(n){return!!n}),!e).join("/"),!r&&!e&&(r="."),r&&t&&(r+="/"),(e?"/":"")+r}function zl(r){return r.charAt(0)==="/"}function N0(){var r=Array.prototype.slice.call(arguments,0);return Vl(Bc(r,function(e,t){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function k0(r,e){r=pc(r).substr(1),e=pc(e).substr(1);function t(f){for(var l=0;l<f.length&&f[l]==="";l++);for(var h=f.length-1;h>=0&&f[h]==="";h--);return l>h?[]:f.slice(l,h-l+1)}for(var n=t(r.split("/")),i=t(e.split("/")),s=Math.min(n.length,i.length),a=s,o=0;o<s;o++)if(n[o]!==i[o]){a=o;break}for(var c=[],o=a;o<n.length;o++)c.push("..");return c=c.concat(i.slice(a)),c.join("/")}var L0="/",B0=":";function U0(r){var e=Lc(r),t=e[0],n=e[1];return!t&&!n?".":(n&&(n=n.substr(0,n.length-1)),t+n)}function P0(r,e){var t=Lc(r)[2];return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t}function M0(r){return Lc(r)[3]}var jo={extname:M0,basename:P0,dirname:U0,sep:L0,delimiter:B0,relative:k0,join:N0,isAbsolute:zl,normalize:Vl,resolve:pc};function Bc(r,e){if(r.filter)return r.filter(e);for(var t=[],n=0;n<r.length;n++)e(r[n],n,r)&&t.push(r[n]);return t}var $0="ab".substr(-1)==="b"?function(r,e,t){return r.substr(e,t)}:function(r,e,t){return e<0&&(e=r.length+e),r.substr(e,t)},G0=pe(function(r,e){(function(t,n){r.exports=n()})(ln,function(){function t(n,i){return new Proxy({},{getPrototypeOf:function(a){return Reflect.getPrototypeOf(n[i])},setPrototypeOf:function(a,o){return Reflect.setPrototypeOf(n[i],o)},isExtensible:function(a){return Reflect.isExtensible(n[i])},preventExtensions:function(a){return Reflect.preventExtensions(n[i])},getOwnPropertyDescriptor:function(a,o){return Reflect.getOwnPropertyDescriptor(n[i],o)},defineProperty:function(a,o,c){return Reflect.defineProperty(n[i],o,c)},get:function(a,o){var c=Reflect.get(n[i],o);return typeof c=="function"&&(c=c.bind(n[i])),c},set:function(a,o,c){return Reflect.set(n[i],o,c)},has:function(a,o){return Reflect.has(n[i],o)},deleteProperty:function(a,o){return Reflect.delete(n[i],o)},ownKeys:function(a){return Reflect.ownKeys(n[i])},apply:function(a,o,c){return Reflect.apply(n[i],o,c)},construct:function(a,o,c){return Reflect.construct(n[i],o,c)}})}return t})}),Uc=function(r,e){var t=(Te.Object||{})[r]||Object[r],n={};n[r]=e(t),ne(ne.S+ne.F*gr(function(){t(1)}),"Object",n)},H0=Nt.onFreeze;Uc("freeze",function(r){return function(t){return r&&qe(t)?r(H0(t)):t}});var Y0=Te.Object.freeze,V0=pe(function(r){r.exports={default:Y0,__esModule:!0}}),z0=Ce(V0),T=z0({O_RDONLY:0,O_WRONLY:1,O_RDWR:2,O_ACCMODE:3,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,COPYFILE_EXCL:1,SEEK_SET:0,SEEK_CUR:1,SEEK_END:2,MAP_SHARED:1,MAP_PRIVATE:2}),Bs=function(){function r(e){st(this,r),this.dev=e.dev||0,this.ino=e.ino,this.mode=e.mode,this.nlink=e.nlink,this.uid=e.uid,this.gid=e.gid,this.rdev=e.rdev||0,this.size=e.size,this.blksize=void 0,this.blocks=void 0,this.atime=e.atime,this.mtime=e.mtime,this.ctime=e.ctime,this.birthtime=e.birthtime}return ut(r,[{key:"isFile",value:function(){return(this.mode&T.S_IFMT)==T.S_IFREG}},{key:"isDirectory",value:function(){return(this.mode&T.S_IFMT)==T.S_IFDIR}},{key:"isBlockDevice",value:function(){return(this.mode&T.S_IFMT)==T.S_IFBLK}},{key:"isCharacterDevice",value:function(){return(this.mode&T.S_IFMT)==T.S_IFCHR}},{key:"isSymbolicLink",value:function(){return(this.mode&T.S_IFMT)==T.S_IFLNK}},{key:"isFIFO",value:function(){return(this.mode&T.S_IFMT)==T.S_IFIFO}},{key:"isSocket",value:function(){return(this.mode&T.S_IFMT)==T.S_IFSOCK}}]),r}(),j0=function(){function r(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];st(this,r),this._iNodeMgr=e,this._iNode=t,this._curPath=n,e.refINode(t)}return ut(r,[{key:"changeDir",value:function(t,n){this._iNodeMgr.refINode(t),this._iNodeMgr.unrefINode(this._iNode),this._iNode=t,this._curPath=n}},{key:"getINode",value:function(){return this._iNode}},{key:"getPathStack",value:function(){return[].concat(Re(this._curPath))}},{key:"getPath",value:function(){return"/"+this._curPath.join("/")}}]),r}(),Qt=0,Sc=0,K0=T.S_IRWXU|T.S_IRGRP|T.S_IXGRP|T.S_IROTH|T.S_IXOTH,Tt=T.S_IRUSR|T.S_IWUSR|T.S_IRGRP|T.S_IWGRP|T.S_IROTH|T.S_IWOTH,Gs=T.S_IRWXU|T.S_IRWXG|T.S_IRWXO,Pc=T.S_IRWXU|T.S_IRWXG|T.S_IRWXO;function vi(r,e){return r&~e}function X0(r,e,t){return r===t.uid?(t.mode&T.S_IRWXU)>>6:e===t.gid?(t.mode&T.S_IRWXG)>>3:t.mode&T.S_IRWXO}function q0(r,e,t,n){return(r&X0(e,t,n))===r}var Mc=function(r,e,t){for(var n in e)t&&r[n]?r[n]=e[n]:hr(r,n,e[n]);return r},Hs=function(r,e,t,n){if(!(r instanceof e)||n!==void 0&&n in r)throw TypeError(t+": incorrect invocation!");return r},Bn=pe(function(r){var e={},t={},n=r.exports=function(i,s,a,o,c){var f=c?function(){return i}:kc(i),l=Pr(a,o,s?2:1),h=0,_,m,I,b;if(typeof f!="function")throw TypeError(i+" is not iterable!");if(Dl(f)){for(_=Qs(i.length);_>h;h++)if(b=s?l(Ot(m=i[h])[0],m[1]):l(i[h]),b===e||b===t)return b}else for(I=f.call(i);!(m=I.next()).done;)if(b=Fl(I,l,m.value,s),b===e||b===t)return b};n.BREAK=e,n.RETURN=t}),Lu=et("species"),J0=function(r){var e=typeof Te[r]=="function"?Te[r]:je[r];yt&&e&&!e[Lu]&&Lt.f(e,Lu,{configurable:!0,get:function(){return this}})},Ct=function(r,e){if(!qe(r)||r._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return r},Q0=Lt.f,jl=Nt.fastKey,mi=yt?"_s":"size",Os=function(r,e){var t=jl(e),n;if(t!=="F")return r._i[t];for(n=r._f;n;n=n.n)if(n.k==e)return n},Ko={getConstructor:function(r,e,t,n){var i=r(function(s,a){Hs(s,i,e,"_i"),s._t=e,s._i=Mr(null),s._f=void 0,s._l=void 0,s[mi]=0,a!=null&&Bn(a,t,s[n],s)});return Mc(i.prototype,{clear:function(){for(var a=Ct(this,e),o=a._i,c=a._f;c;c=c.n)c.r=!0,c.p&&(c.p=c.p.n=void 0),delete o[c.i];a._f=a._l=void 0,a[mi]=0},delete:function(s){var a=Ct(this,e),o=Os(a,s);if(o){var c=o.n,f=o.p;delete a._i[o.i],o.r=!0,f&&(f.n=c),c&&(c.p=f),a._f==o&&(a._f=c),a._l==o&&(a._l=f),a[mi]--}return!!o},forEach:function(a){Ct(this,e);for(var o=Pr(a,arguments.length>1?arguments[1]:void 0,3),c;c=c?c.n:this._f;)for(o(c.v,c.k,this);c&&c.r;)c=c.p},has:function(a){return!!Os(Ct(this,e),a)}}),yt&&Q0(i.prototype,"size",{get:function(){return Ct(this,e)[mi]}}),i},def:function(r,e,t){var n=Os(r,e),i,s;return n?n.v=t:(r._l=n={i:s=jl(e,!0),k:e,v:t,p:i=r._l,n:void 0,r:!1},r._f||(r._f=n),i&&(i.n=n),r[mi]++,s!=="F"&&(r._i[s]=n)),r},getEntry:Os,setStrong:function(r,e,t){Wc(r,e,function(n,i){this._t=Ct(n,e),this._k=i,this._l=void 0},function(){for(var n=this,i=n._k,s=n._l;s&&s.r;)s=s.p;return!n._t||!(n._l=s=s?s.n:n._t._f)?(n._t=void 0,Nr(1)):i=="keys"?Nr(0,s.k):i=="values"?Nr(0,s.v):Nr(0,[s.k,s.v])},t?"entries":"values",!t,!0),J0(e)}},Z0=et("species"),ep=function(r){var e;return uc(r)&&(e=r.constructor,typeof e=="function"&&(e===Array||uc(e.prototype))&&(e=void 0),qe(e)&&(e=e[Z0],e===null&&(e=void 0))),e===void 0?Array:e},tp=function(r,e){return new(ep(r))(e)},na=function(r,e){var t=r==1,n=r==2,i=r==3,s=r==4,a=r==6,o=r==5||a,c=e||tp;return function(f,l,h){for(var _=Pn(f),m=Oc(_),I=Pr(l,h,3),b=Qs(m.length),H=0,M=t?c(f,b):n?c(f,0):void 0,K,V;b>H;H++)if((o||H in m)&&(K=m[H],V=I(K,H,_),r)){if(t)M[H]=V;else if(V)switch(r){case 3:return!0;case 5:return K;case 6:return H;case 2:M.push(K)}else if(s)return!1}return a?-1:i||s?s:M}},rp=Lt.f,np=na(0),Kl=function(r,e,t,n,i,s){var a=je[r],o=a,c=i?"set":"add",f=o&&o.prototype,l={};return!yt||typeof o!="function"||!(s||f.forEach&&!gr(function(){new o().entries().next()}))?(o=n.getConstructor(e,r,i,c),Mc(o.prototype,t),Nt.NEED=!0):(o=e(function(h,_){Hs(h,o,r,"_c"),h._c=new a,_!=null&&Bn(_,i,h[c],h)}),np("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(h){var _=h=="add"||h=="set";h in f&&!(s&&h=="clear")&&hr(o.prototype,h,function(m,I){if(Hs(this,o,h),!_&&s&&!qe(m))return h=="get"?void 0:!1;var b=this._c[h](m===0?0:m,I);return _?this:b})}),s||rp(o.prototype,"size",{get:function(){return this._c.size}})),Un(o,r),l[r]=o,ne(ne.G+ne.W+ne.F,l),s||n.setStrong(o,r,i),o},Xo="Map",xv=Kl(Xo,function(r){return function(){return r(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=Ko.getEntry(Ct(this,Xo),e);return t&&t.v},set:function(e,t){return Ko.def(Ct(this,Xo),e===0?0:e,t)}},Ko,!0),ip=function(r,e){var t=[];return Bn(r,!1,t.push,t,e),t},sp=function(r){return function(){if(Nc(this)!=r)throw TypeError(r+"#toJSON isn't generic");return ip(this)}};ne(ne.P+ne.R,"Map",{toJSON:sp("Map")});var Xl=function(r){ne(ne.S,r,{of:function(){for(var t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return new this(n)}})};Xl("Map");var ql=function(r){ne(ne.S,r,{from:function(t){var n=arguments[1],i,s,a,o;return oc(this),i=n!==void 0,i&&oc(n),t==null?new this:(s=[],i?(a=0,o=Pr(n,arguments[2],2),Bn(t,!1,function(c){s.push(o(c,a++))})):Bn(t,!1,s.push,s),new this(s))}})};ql("Map");var ap=Te.Map,op=pe(function(r){r.exports={default:ap,__esModule:!0}}),Ai=Ce(op);Uc("getPrototypeOf",function(){return function(e){return gl(Pn(e))}});var cp=Te.Object.getPrototypeOf,Jl=pe(function(r){r.exports={default:cp,__esModule:!0}}),be=Ce(Jl),fp=pe(function(r,e){e.__esModule=!0;var t=n(Dc);function n(i){return i&&i.__esModule?i:{default:i}}e.default=function(i,s){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s&&((typeof s>"u"?"undefined":(0,t.default)(s))==="object"||typeof s=="function")?s:i}}),$r=Ce(fp),Bu=function(r,e){if(Ot(r),!qe(e)&&e!==null)throw TypeError(e+": can't set as prototype!")},up={set:Object.setPrototypeOf||("__proto__"in{}?function(r,e,t){try{t=Pr(Function.call,ta.f(Object.prototype,"__proto__").set,2),t(r,[]),e=!(r instanceof Array)}catch{e=!0}return function(i,s){return Bu(i,s),e?i.__proto__=s:t(i,s),i}}({},!1):void 0),check:Bu};ne(ne.S,"Object",{setPrototypeOf:up.set});var lp=Te.Object.setPrototypeOf,Ql=pe(function(r){r.exports={default:lp,__esModule:!0}});Ce(Ql);ne(ne.S,"Object",{create:Mr});var dp=Te.Object,hp=function(e,t){return dp.create(e,t)},Zl=pe(function(r){r.exports={default:hp,__esModule:!0}});Ce(Zl);var _p=pe(function(r,e){e.__esModule=!0;var t=s(Ql),n=s(Zl),i=s(Dc);function s(a){return a&&a.__esModule?a:{default:a}}e.default=function(a,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof o>"u"?"undefined":(0,i.default)(o)));a.prototype=(0,n.default)(o&&o.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),o&&(t.default?(0,t.default)(a,o):a.__proto__=o)}}),Gr=Ce(_p),pp=pe(function(r,e){(function(t,n){n(e)})(ln,function(t){var n=typeof window<"u"?window:typeof ln<"u"?ln:typeof self<"u"?self:{};function i(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function s(u,d){return d={exports:{}},u(d,d.exports),d.exports}var a=function(u,d){return{value:d,done:!!u}},o={},c={}.toString,f=function(u){return c.call(u).slice(8,-1)},l=Object("z").propertyIsEnumerable(0)?Object:function(u){return f(u)=="String"?u.split(""):Object(u)},h=function(u){if(u==null)throw TypeError("Can't call method on  "+u);return u},_=function(u){return l(h(u))},m=!0,I=s(function(u){var d=u.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=d)}),b=s(function(u){var d=u.exports={version:"2.4.0"};typeof __e=="number"&&(__e=d)}),H=b.version,M=function(u){if(typeof u!="function")throw TypeError(u+" is not a function!");return u},K=function(u,d,S){if(M(u),d===void 0)return u;switch(S){case 1:return function(v){return u.call(d,v)};case 2:return function(v,y){return u.call(d,v,y)};case 3:return function(v,y,E){return u.call(d,v,y,E)}}return function(){return u.apply(d,arguments)}},V=function(u){return typeof u=="object"?u!==null:typeof u=="function"},ie=function(u){if(!V(u))throw TypeError(u+" is not an object!");return u},he=function(u){try{return!!u()}catch{return!0}},Ae=!he(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),tt=I.document,pn=V(tt)&&V(tt.createElement),Sn=function(u){return pn?tt.createElement(u):{}},Kt=!Ae&&!he(function(){return Object.defineProperty(Sn("div"),"a",{get:function(){return 7}}).a!=7}),Xt=function(u,d){if(!V(u))return u;var S,v;if(d&&typeof(S=u.toString)=="function"&&!V(v=S.call(u))||typeof(S=u.valueOf)=="function"&&!V(v=S.call(u))||!d&&typeof(S=u.toString)=="function"&&!V(v=S.call(u)))return v;throw TypeError("Can't convert object to primitive value")},Vn=Object.defineProperty,zn=Ae?Object.defineProperty:function(d,S,v){if(ie(d),S=Xt(S,!0),ie(v),Kt)try{return Vn(d,S,v)}catch{}if("get"in v||"set"in v)throw TypeError("Accessors not supported!");return"value"in v&&(d[S]=v.value),d},qt={f:zn},Hr=function(u,d){return{enumerable:!(u&1),configurable:!(u&2),writable:!(u&4),value:d}},Pt=Ae?function(u,d,S){return qt.f(u,d,Hr(1,S))}:function(u,d,S){return u[d]=S,u},gn="prototype",Ke=function(u,d,S){var v=u&Ke.F,y=u&Ke.G,E=u&Ke.S,w=u&Ke.P,R=u&Ke.B,j=u&Ke.W,J=y?b:b[d]||(b[d]={}),ce=J[gn],g=y?I:E?I[d]:(I[d]||{})[gn],A,C,D;y&&(S=d);for(A in S)C=!v&&g&&g[A]!==void 0,!(C&&A in J)&&(D=C?g[A]:S[A],J[A]=y&&typeof g[A]!="function"?S[A]:R&&C?K(D,I):j&&g[A]==D?function(X){var te=function(ae,ue,re){if(this instanceof X){switch(arguments.length){case 0:return new X;case 1:return new X(ae);case 2:return new X(ae,ue)}return new X(ae,ue,re)}return X.apply(this,arguments)};return te[gn]=X[gn],te}(D):w&&typeof D=="function"?K(Function.call,D):D,w&&((J.virtual||(J.virtual={}))[A]=D,u&Ke.R&&ce&&!ce[A]&&Pt(ce,A,D)))};Ke.F=1,Ke.G=2,Ke.S=4,Ke.P=8,Ke.B=16,Ke.W=32,Ke.U=64,Ke.R=128;var ve=Ke,vn=Pt,Ca={}.hasOwnProperty,me=function(u,d){return Ca.call(u,d)},Oa=Math.ceil,xa=Math.floor,jn=function(u){return isNaN(u=+u)?0:(u>0?xa:Oa)(u)},Wa=Math.min,Kn=function(u){return u>0?Wa(jn(u),9007199254740991):0},yf=Math.max,If=Math.min,Ra=function(u,d){return u=jn(u),u<0?yf(u+d,0):If(u,d)},Fa=function(u){return function(d,S,v){var y=_(d),E=Kn(y.length),w=Ra(v,E),R;if(u&&S!=S){for(;E>w;)if(R=y[w++],R!=R)return!0}else for(;E>w;w++)if((u||w in y)&&y[w]===S)return u||w||0;return!u&&-1}},Pi="__core-js_shared__",Mi=I[Pi]||(I[Pi]={}),Yr=function(u){return Mi[u]||(Mi[u]={})},Da=0,Na=Math.random(),mn=function(u){return"Symbol(".concat(u===void 0?"":u,")_",(++Da+Na).toString(36))},$i=Yr("keys"),nr=function(u){return $i[u]||($i[u]=mn(u))},Gi=Fa(!1),ka=nr("IE_PROTO"),Hi=function(u,d){var S=_(u),v=0,y=[],E;for(E in S)E!=ka&&me(S,E)&&y.push(E);for(;d.length>v;)me(S,E=d[v++])&&(~Gi(y,E)||y.push(E));return y},En="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Vr=Object.keys||function(d){return Hi(d,En)},La=Ae?Object.defineProperties:function(d,S){ie(d);for(var v=Vr(S),y=v.length,E=0,w;y>E;)qt.f(d,w=v[E++],S[w]);return d},Ba=I.document&&document.documentElement,Ua=nr("IE_PROTO"),Xn=function(){},qn="prototype",zr=function(){var u=Sn("iframe"),d=En.length,S="<",v=">",y;for(u.style.display="none",Ba.appendChild(u),u.src="javascript:",y=u.contentWindow.document,y.open(),y.write(S+"script"+v+"document.F=Object"+S+"/script"+v),y.close(),zr=y.F;d--;)delete zr[qn][En[d]];return zr()},Mt=Object.create||function(d,S){var v;return d!==null?(Xn[qn]=ie(d),v=new Xn,Xn[qn]=null,v[Ua]=d):v=zr(),S===void 0?v:La(v,S)},Ge=s(function(u){var d=Yr("wks"),S=I.Symbol,v=typeof S=="function",y=u.exports=function(E){return d[E]||(d[E]=v&&S[E]||(v?S:mn)("Symbol."+E))};y.store=d}),Yi=qt.f,Er=Ge("toStringTag"),Xe=function(u,d,S){u&&!me(u=S?u:u.prototype,Er)&&Yi(u,Er,{configurable:!0,value:d})},se={};Pt(se,Ge("iterator"),function(){return this});var z=function(u,d,S){u.prototype=Mt(se,{next:Hr(1,S)}),Xe(u,d+" Iterator")},ir=function(u){return Object(h(u))},Vi=nr("IE_PROTO"),Pa=Object.prototype,zi=Object.getPrototypeOf||function(u){return u=ir(u),me(u,Vi)?u[Vi]:typeof u.constructor=="function"&&u instanceof u.constructor?u.constructor.prototype:u instanceof Object?Pa:null},yr=Ge("iterator"),ge=!([].keys&&"next"in[].keys()),Z="@@iterator",lt="keys",Me="values",dt=function(){return this},wt=function(u,d,S,v,y,E,w){z(S,d,v);var R=function(re){if(!ge&&re in g)return g[re];switch(re){case lt:return function(){return new S(this,re)};case Me:return function(){return new S(this,re)}}return function(){return new S(this,re)}},j=d+" Iterator",J=y==Me,ce=!1,g=u.prototype,A=g[yr]||g[Z]||y&&g[y],C=A||R(y),D=y?J?R("entries"):C:void 0,X=d=="Array"&&g.entries||A,te,ae,ue;if(X&&(ue=zi(X.call(new u)),ue!==Object.prototype&&(Xe(ue,j,!0),!m&&!me(ue,yr)&&Pt(ue,yr,dt))),J&&A&&A.name!==Me&&(ce=!0,C=function(){return A.call(this)}),(!m||w)&&(ge||ce||!g[yr])&&Pt(g,yr,C),o[d]=C,o[j]=dt,y)if(te={values:J?C:R(Me),keys:E?C:R(lt),entries:D},w)for(ae in te)ae in g||vn(g,ae,te[ae]);else ve(ve.P+ve.F*(ge||ce),d,te);return te},ji=wt(Array,"Array",function(u,d){this._t=_(u),this._i=0,this._k=d},function(){var u=this._t,d=this._k,S=this._i++;return!u||S>=u.length?(this._t=void 0,a(1)):d=="keys"?a(0,S):d=="values"?a(0,u[S]):a(0,[S,u[S]])},"values");o.Arguments=o.Array;for(var Ki=Ge("toStringTag"),Ma=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],Jn=0;Jn<5;Jn++){var Qn=Ma[Jn],Xi=I[Qn],Zn=Xi&&Xi.prototype;Zn&&!Zn[Ki]&&Pt(Zn,Ki,Qn),o[Qn]=o.Array}var $a=function(u){return function(d,S){var v=String(h(d)),y=jn(S),E=v.length,w,R;return y<0||y>=E?u?"":void 0:(w=v.charCodeAt(y),w<55296||w>56319||y+1===E||(R=v.charCodeAt(y+1))<56320||R>57343?u?v.charAt(y):w:u?v.slice(y,y+2):(w-55296<<10)+(R-56320)+65536)}},Ga=$a(!0);wt(String,"String",function(u){this._t=String(u),this._i=0},function(){var u=this._t,d=this._i,S;return d>=u.length?{value:void 0,done:!0}:(S=Ga(u,d),this._i+=S.length,{value:S,done:!1})});var Ha=Ge("toStringTag"),Ya=f(function(){return arguments}())=="Arguments",Va=function(u,d){try{return u[d]}catch{}},qi=function(u){var d,S,v;return u===void 0?"Undefined":u===null?"Null":typeof(S=Va(d=Object(u),Ha))=="string"?S:Ya?f(d):(v=f(d))=="Object"&&typeof d.callee=="function"?"Arguments":v},za=Ge("iterator"),ja=b.isIterable=function(u){var d=Object(u);return d[za]!==void 0||"@@iterator"in d||o.hasOwnProperty(qi(d))},Ka=ja,Ji=s(function(u){u.exports={default:Ka,__esModule:!0}});i(Ji);var Xa=Ge("iterator"),Qi=b.getIteratorMethod=function(u){if(u!=null)return u[Xa]||u["@@iterator"]||o[qi(u)]},qa=b.getIterator=function(u){var d=Qi(u);if(typeof d!="function")throw TypeError(u+" is not iterable!");return ie(d.call(u))},Ja=qa,Zi=s(function(u){u.exports={default:Ja,__esModule:!0}});i(Zi);var Qa=s(function(u,d){d.__esModule=!0;var S=y(Ji),v=y(Zi);function y(E){return E&&E.__esModule?E:{default:E}}d.default=function(){function E(w,R){var j=[],J=!0,ce=!1,g=void 0;try{for(var A=(0,v.default)(w),C;!(J=(C=A.next()).done)&&(j.push(C.value),!(R&&j.length===R));J=!0);}catch(D){ce=!0,g=D}finally{try{!J&&A.return&&A.return()}finally{if(ce)throw g}}return j}return function(w,R){if(Array.isArray(w))return w;if((0,S.default)(Object(w)))return E(w,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),Ir=i(Qa),Za=s(function(u,d){d.__esModule=!0,d.default=function(S,v){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}}),jr=i(Za);ve(ve.S+ve.F*!Ae,"Object",{defineProperty:qt.f});var eo=b.Object,to=function(d,S,v){return eo.defineProperty(d,S,v)},es=s(function(u){u.exports={default:to,__esModule:!0}});i(es);var ro=s(function(u,d){d.__esModule=!0;var S=v(es);function v(y){return y&&y.__esModule?y:{default:y}}d.default=function(){function y(E,w){for(var R=0;R<w.length;R++){var j=w[R];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),(0,S.default)(E,j.key,j)}}return function(E,w,R){return w&&y(E.prototype,w),R&&y(E,R),E}}()}),$e=i(ro);function ei(u,d,S){var v=void 0,y=void 0;return u.allocate(d,function(E){var w=E.counter,R=E.changed,j=E.tree;d=w,v=R,y=j},S),[d,v,y]}function ti(u,d,S){var v=void 0,y=void 0;return u.deallocate(d,function(E){var w=E.changed,R=E.tree;v=w,y=R},S),[v,y]}function ri(u,d){var S=void 0;return u.check(d,function(v){S=v}),!!S}var ts=function(u,d){var S=(b.Object||{})[u]||Object[u],v={};v[u]=d(S),ve(ve.S+ve.F*he(function(){S(1)}),"Object",v)};ts("keys",function(){return function(d){return Vr(ir(d))}});var no=b.Object.keys,io=s(function(u){u.exports={default:no,__esModule:!0}}),so=i(io);ts("getPrototypeOf",function(){return function(d){return zi(ir(d))}});var ao=b.Object.getPrototypeOf,oo=s(function(u){u.exports={default:ao,__esModule:!0}}),rs=i(oo),co=Ge,ni={f:co},fo=ni.f("iterator"),ns=s(function(u){u.exports={default:fo,__esModule:!0}});i(ns);var Jt=s(function(u){var d=mn("meta"),S=qt.f,v=0,y=Object.isExtensible||function(){return!0},E=!he(function(){return y(Object.preventExtensions({}))}),w=function(g){S(g,d,{value:{i:"O"+ ++v,w:{}}})},R=function(g,A){if(!V(g))return typeof g=="symbol"?g:(typeof g=="string"?"S":"P")+g;if(!me(g,d)){if(!y(g))return"F";if(!A)return"E";w(g)}return g[d].i},j=function(g,A){if(!me(g,d)){if(!y(g))return!0;if(!A)return!1;w(g)}return g[d].w},J=function(g){return E&&ce.NEED&&y(g)&&!me(g,d)&&w(g),g},ce=u.exports={KEY:d,NEED:!1,fastKey:R,getWeak:j,onFreeze:J}}),N=Jt.KEY,O=Jt.NEED,k=Jt.fastKey,G=Jt.getWeak,P=Jt.onFreeze,U=qt.f,x=function(u){var d=b.Symbol||(b.Symbol=m?{}:I.Symbol||{});u.charAt(0)!="_"&&!(u in d)&&U(d,u,{value:ni.f(u)})},B=function(u,d){for(var S=_(u),v=Vr(S),y=v.length,E=0,w;y>E;)if(S[w=v[E++]]===d)return w},$=Object.getOwnPropertySymbols,Y={f:$},q={}.propertyIsEnumerable,Q={f:q},fe=function(u){var d=Vr(u),S=Y.f;if(S)for(var v=S(u),y=Q.f,E=0,w;v.length>E;)y.call(u,w=v[E++])&&d.push(w);return d},de=Array.isArray||function(d){return f(d)=="Array"},_e=En.concat("length","prototype"),Oe=Object.getOwnPropertyNames||function(d){return Hi(d,_e)},We={f:Oe},we=We.f,ht={}.toString,rt=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],$t=function(u){try{return we(u)}catch{return rt.slice()}},sr=function(d){return rt&&ht.call(d)=="[object Window]"?$t(d):we(_(d))},Gt={f:sr},At=Object.getOwnPropertyDescriptor,yn=Ae?At:function(d,S){if(d=_(d),S=Xt(S,!0),Kt)try{return At(d,S)}catch{}if(me(d,S))return Hr(!Q.f.call(d,S),d[S])},Kr={f:yn},ar=Jt.KEY,Xr=Kr.f,or=qt.f,is=Gt.f,_t=I.Symbol,ss=I.JSON,as=ss&&ss.stringify,wr="prototype",pt=Ge("_hidden"),wf=Ge("toPrimitive"),Fd={}.propertyIsEnumerable,os=Yr("symbol-registry"),cr=Yr("symbols"),ii=Yr("op-symbols"),xt=Object[wr],In=typeof _t=="function",uo=I.QObject,lo=!uo||!uo[wr]||!uo[wr].findChild,ho=Ae&&he(function(){return Mt(or({},"a",{get:function(){return or(this,"a",{value:7}).a}})).a!=7})?function(u,d,S){var v=Xr(xt,d);v&&delete xt[d],or(u,d,S),v&&u!==xt&&or(xt,d,v)}:or,Af=function(u){var d=cr[u]=Mt(_t[wr]);return d._k=u,d},_o=In&&typeof _t.iterator=="symbol"?function(u){return typeof u=="symbol"}:function(u){return u instanceof _t},cs=function(d,S,v){return d===xt&&cs(ii,S,v),ie(d),S=Xt(S,!0),ie(v),me(cr,S)?(v.enumerable?(me(d,pt)&&d[pt][S]&&(d[pt][S]=!1),v=Mt(v,{enumerable:Hr(0,!1)})):(me(d,pt)||or(d,pt,Hr(1,{})),d[pt][S]=!0),ho(d,S,v)):or(d,S,v)},bf=function(d,S){ie(d);for(var v=fe(S=_(S)),y=0,E=v.length,w;E>y;)cs(d,w=v[y++],S[w]);return d},Dd=function(d,S){return S===void 0?Mt(d):bf(Mt(d),S)},Tf=function(d){var S=Fd.call(this,d=Xt(d,!0));return this===xt&&me(cr,d)&&!me(ii,d)?!1:S||!me(this,d)||!me(cr,d)||me(this,pt)&&this[pt][d]?S:!0},Cf=function(d,S){if(d=_(d),S=Xt(S,!0),!(d===xt&&me(cr,S)&&!me(ii,S))){var v=Xr(d,S);return v&&me(cr,S)&&!(me(d,pt)&&d[pt][S])&&(v.enumerable=!0),v}},Of=function(d){for(var S=is(_(d)),v=[],y=0,E;S.length>y;)!me(cr,E=S[y++])&&E!=pt&&E!=ar&&v.push(E);return v},xf=function(d){for(var S=d===xt,v=is(S?ii:_(d)),y=[],E=0,w;v.length>E;)me(cr,w=v[E++])&&(!S||me(xt,w))&&y.push(cr[w]);return y};In||(_t=function(){if(this instanceof _t)throw TypeError("Symbol is not a constructor!");var d=mn(arguments.length>0?arguments[0]:void 0),S=function(v){this===xt&&S.call(ii,v),me(this,pt)&&me(this[pt],d)&&(this[pt][d]=!1),ho(this,d,Hr(1,v))};return Ae&&lo&&ho(xt,d,{configurable:!0,set:S}),Af(d)},vn(_t[wr],"toString",function(){return this._k}),Kr.f=Cf,qt.f=cs,We.f=Gt.f=Of,Q.f=Tf,Y.f=xf,Ae&&!m&&vn(xt,"propertyIsEnumerable",Tf,!0),ni.f=function(u){return Af(Ge(u))}),ve(ve.G+ve.W+ve.F*!In,{Symbol:_t});for(var si="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ai=0;si.length>ai;)Ge(si[ai++]);for(var si=Vr(Ge.store),ai=0;si.length>ai;)x(si[ai++]);ve(ve.S+ve.F*!In,"Symbol",{for:function(u){return me(os,u+="")?os[u]:os[u]=_t(u)},keyFor:function(d){if(_o(d))return B(os,d);throw TypeError(d+" is not a symbol!")},useSetter:function(){lo=!0},useSimple:function(){lo=!1}}),ve(ve.S+ve.F*!In,"Object",{create:Dd,defineProperty:cs,defineProperties:bf,getOwnPropertyDescriptor:Cf,getOwnPropertyNames:Of,getOwnPropertySymbols:xf}),ss&&ve(ve.S+ve.F*(!In||he(function(){var u=_t();return as([u])!="[null]"||as({a:u})!="{}"||as(Object(u))!="{}"})),"JSON",{stringify:function(d){if(!(d===void 0||_o(d))){for(var S=[d],v=1,y,E;arguments.length>v;)S.push(arguments[v++]);return y=S[1],typeof y=="function"&&(E=y),(E||!de(y))&&(y=function(w,R){if(E&&(R=E.call(this,w,R)),!_o(R))return R}),S[1]=y,as.apply(ss,S)}}}),_t[wr][wf]||Pt(_t[wr],wf,_t[wr].valueOf),Xe(_t,"Symbol"),Xe(Math,"Math",!0),Xe(I.JSON,"JSON",!0),x("asyncIterator"),x("observable");var Nd=b.Symbol,Wf=s(function(u){u.exports={default:Nd,__esModule:!0}});i(Wf);var po=s(function(u,d){d.__esModule=!0;var S=E(ns),v=E(Wf),y=typeof v.default=="function"&&typeof S.default=="symbol"?function(w){return typeof w}:function(w){return w&&typeof v.default=="function"&&w.constructor===v.default&&w!==v.default.prototype?"symbol":typeof w};function E(w){return w&&w.__esModule?w:{default:w}}d.default=typeof v.default=="function"&&y(S.default)==="symbol"?function(w){return typeof w>"u"?"undefined":y(w)}:function(w){return w&&typeof v.default=="function"&&w.constructor===v.default&&w!==v.default.prototype?"symbol":typeof w>"u"?"undefined":y(w)}});i(po);var kd=s(function(u,d){d.__esModule=!0;var S=v(po);function v(y){return y&&y.__esModule?y:{default:y}}d.default=function(y,E){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&((typeof E>"u"?"undefined":(0,S.default)(E))==="object"||typeof E=="function")?E:y}}),Rf=i(kd),Ff=function(u,d){if(ie(u),!V(d)&&d!==null)throw TypeError(d+": can't set as prototype!")},Ld={set:Object.setPrototypeOf||("__proto__"in{}?function(u,d,S){try{S=K(Function.call,Kr.f(Object.prototype,"__proto__").set,2),S(u,[]),d=!(u instanceof Array)}catch{d=!0}return function(y,E){return Ff(y,E),d?y.__proto__=E:S(y,E),y}}({},!1):void 0),check:Ff};ve(ve.S,"Object",{setPrototypeOf:Ld.set});var Bd=b.Object.setPrototypeOf,Df=s(function(u){u.exports={default:Bd,__esModule:!0}});i(Df),ve(ve.S,"Object",{create:Mt});var Ud=b.Object,Pd=function(d,S){return Ud.create(d,S)},Nf=s(function(u){u.exports={default:Pd,__esModule:!0}});i(Nf);var Md=s(function(u,d){d.__esModule=!0;var S=E(Df),v=E(Nf),y=E(po);function E(w){return w&&w.__esModule?w:{default:w}}d.default=function(w,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof R>"u"?"undefined":(0,y.default)(R)));w.prototype=(0,v.default)(R&&R.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),R&&(S.default?(0,S.default)(w,R):w.__proto__=R)}}),kf=i(Md),$d=s(function(u,d){(function(S){var v=32,y=5;function E(g){return g-=g>>>1&1431655765,g=(g&858993459)+(g>>>2&858993459),(g+(g>>>4)&252645135)*16843009>>>24}function w(g,A){for(var C=0,D=0;D<g.length;D++){C*=2;var X=(g[D]+C)/A|0;C=(g[D]+C)%A,g[D]=X}return C}function R(g,A){if(A==null){g.data=[0,0,0,0,0,0,0,0,0,0],g._=0;return}if(A instanceof j){g.data=A.data,g._=A._;return}switch(typeof A){case"number":g.data=[A|0],g._=0;break;case"string":var C=2,D=v;A.indexOf("0b")===0?A=A.substr(2):A.indexOf("0x")===0&&(A=A.substr(2),C=16,D=8),g.data=[],g._=0;var X=A.length-D,te=A.length;do{var ae=parseInt(A.slice(X>0?X:0,te),C);if(isNaN(ae))throw SyntaxError("Invalid param");if(g.data.push(ae|0),X<=0)break;X-=D,te-=D}while(1);break;default:g.data=[0];var ue=g.data;if(A instanceof Array){for(var re=A.length-1;re>=0;re--){var He=A[re];He===1/0?g._=-1:(J(g,He),ue[He>>>y]|=1<<He)}break}if(Uint8Array&&A instanceof Uint8Array){var De=8;J(g,A.length*De);for(var re=0;re<A.length;re++)for(var wn=A[re],Jr=0;Jr<De;Jr++){var Gf=re*De+Jr;ue[Gf>>>y]|=(wn>>Jr&1)<<Gf}break}throw SyntaxError("Invalid param")}}function j(g){if(!(this instanceof j))return new j(g);R(this,g),this.data=this.data.slice()}function J(g,A){for(var C=A>>>y,D=g.data,X=g._,te=D.length;C>=te;C--)D.push(X)}var ce={data:[],_:0};j.prototype={data:[],_:0,set:function(g,A){return g|=0,J(this,g),A===void 0||A?this.data[g>>>y]|=1<<g:this.data[g>>>y]&=~(1<<g),this},get:function(g){g|=0;var A=this.data,C=g>>>y;return C>A.length?this._&1:A[C]>>>g&1},not:function(){for(var g=this.clone(),A=g.data,C=0;C<A.length;C++)A[C]=~A[C];return g._=~g._,g},and:function(g){R(ce,g);var A=this.clone(),C=A.data,D=ce.data,X=D.length,te=ce._,ae=A._;ae!==0&&J(A,X*v-1);for(var ue=C.length,re=Math.min(X,ue),He=0;He<re;He++)C[He]&=D[He];for(;He<ue;He++)C[He]&=te;return A._&=te,A},or:function(g){R(ce,g);for(var A=this.clone(),C=A.data,D=ce.data,X=D.length-1,te=C.length-1,ae=Math.min(te,X),ue=X;ue>ae;ue--)C[ue]=D[ue];for(;ue>=0;ue--)C[ue]|=D[ue];return A._|=ce._,A},xor:function(g){R(ce,g);var A=this.clone(),C=A.data,D=ce.data,X=A._,te=ce._,ae=0,ue=C.length-1,re=D.length-1;for(ae=ue;ae>re;ae--)C[ae]^=te;for(ae=re;ae>ue;ae--)C[ae]=X^D[ae];for(;ae>=0;ae--)C[ae]^=D[ae];return A._^=te,A},andNot:function(g){return this.and(new j(g).flip())},flip:function(g,A){if(g===void 0){for(var C=this.data,D=0;D<C.length;D++)C[D]=~C[D];this._=~this._}else if(A===void 0)J(this,g),this.data[g>>>y]^=1<<g;else if(0<=g&&g<=A){J(this,A);for(var D=g;D<=A;D++)this.data[D>>>y]^=1<<D}return this},clear:function(g,A){var C=this.data;if(g===void 0){for(var D=C.length-1;D>=0;D--)C[D]=0;this._=0}else if(A===void 0)g|=0,J(this,g),C[g>>>y]&=~(1<<g);else if(g<=A){J(this,A);for(var D=g;D<=A;D++)C[D>>>y]&=~(1<<D)}return this},slice:function(g,A){if(g===void 0)return this.clone();if(A===void 0){A=this.data.length*v;var C=Object.create(j.prototype);C._=this._,C.data=[0];for(var D=g;D<=A;D++)C.set(D-g,this.get(D));return C}else if(g<=A&&0<=g){var C=Object.create(j.prototype);C.data=[0];for(var D=g;D<=A;D++)C.set(D-g,this.get(D));return C}return null},setRange:function(g,A,C){for(var D=g;D<=A;D++)this.set(D,C);return this},clone:function(){var g=Object.create(j.prototype);return g.data=this.data.slice(),g._=this._,g},toArray:Math.clz32?function(){for(var g=[],A=this.data,C=A.length-1;C>=0;C--)for(var D=A[C];D!==0;){var X=31-Math.clz32(D);D^=1<<X,g.unshift(C*v+X)}return this._!==0&&g.push(1/0),g}:function(){for(var g=[],A=this.data,C=0;C<A.length;C++)for(var D=A[C];D!==0;){var X=D&-D;D^=X,g.push(C*v+E(X-1))}return this._!==0&&g.push(1/0),g},toString:function(g){var A=this.data;if(g||(g=2),!(g&g-1)&&g<36){for(var C="",D=2+Math.log(4294967295)/Math.log(g)|0,X=A.length-1;X>=0;X--){var te=A[X];te<0&&(te+=4294967296);var ae=te.toString(g);C!==""&&(C+="0".repeat(D-ae.length-1)),C+=ae}return this._===0?(C=C.replace(/^0+/,""),C===""&&(C="0"),C):(C="1111"+C,C.replace(/^1+/,"...1111"))}else{if(2>g||g>36)throw SyntaxError("Invalid base");for(var C=[],ue=[],X=A.length;X--;)for(var re=v;re--;)ue.push(A[X]>>>re&1);do C.unshift(w(ue,g).toString(g));while(!ue.every(function(De){return De===0}));return C.join("")}},isEmpty:function(){if(this._!==0)return!1;for(var g=this.data,A=g.length-1;A>=0;A--)if(g[A]!==0)return!1;return!0},cardinality:function(){if(this._!==0)return 1/0;for(var g=0,A=this.data,C=0;C<A.length;C++){var D=A[C];D!==0&&(g+=E(D))}return g},msb:Math.clz32?function(){if(this._!==0)return 1/0;for(var g=this.data,A=g.length;A-- >0;){var C=Math.clz32(g[A]);if(C!==v)return A*v+v-1-C}return 1/0}:function(){if(this._!==0)return 1/0;for(var g=this.data,A=g.length;A-- >0;){var C=g[A],D=0;if(C){for(;(C>>>=1)>0;D++);return A*v+D}}return 1/0},ntz:function(){for(var g=this.data,A=0;A<g.length;A++){var C=g[A];if(C!==0)return C=(C^C-1)>>>1,A*v+E(C)}return 1/0},lsb:function(){for(var g=this.data,A=0;A<g.length;A++){var C=g[A],D=0;if(C){for(var X=C&-C;X>>>=1;D++);return v*A+D}}return this._&1},equals:function(g){R(ce,g);var A=this.data,C=ce.data,D=this._,X=ce._,te=A.length-1,ae=C.length-1;if(X!==D)return!1;for(var ue=te<ae?te:ae,re=0;re<=ue;re++)if(A[re]!==C[re])return!1;for(re=te;re>ae;re--)if(A[re]!==X)return!1;for(re=ae;re>te;re--)if(C[re]!==D)return!1;return!0}},j.fromBinaryString=function(g){return new j("0b"+g)},j.fromHexString=function(g){return new j("0x"+g)},j.Random=function(g){(g===void 0||g<0)&&(g=v);for(var A=g%v,C=[],D=Math.ceil(g/v),X=Object.create(j.prototype),te=0;te<D;te++)C.push(Math.random()*4294967296|0);return A>0&&(C[D-1]&=(1<<A)-1),X.data=C,X._=0,X},Object.defineProperty(d,"__esModule",{value:!0}),j.default=j,j.BitSet=j,u.exports=j})(n)}),Gd=i($d);function Hd(u){return new Gd(new Uint8Array(u/8-1)).flip(0,u-1)}function Ar(u,d){return u.set(d,0)}function oi(u,d){return u.set(d,1)}function qr(u){return u.isEmpty()}function Yd(u,d){return u.cardinality()===d}function Lf(u){var d=u.ntz();return d===1/0&&(d=null),d}function So(u,d){return!u.get(d)}var Bf=function u(d,S,v,y,E){jr(this,u),this.blockSize=d,this.shrink=S,this.begin=v,this.depth=y,this.bitMap=E||Hd(d)},fs=function(u){kf(d,u);function d(S,v,y,E){return jr(this,d),Rf(this,(d.__proto__||rs(d)).call(this,S,v,y,0,E))}return $e(d,[{key:"allocate",value:function(v,y,E){var w=void 0;if(v==null?w=Lf(this.bitMap):w=v-this.begin,w!==null&&w<this.blockSize)if(So(this.bitMap,w))y({counter:this.begin+w,changed:!1,bitMap:this.bitMap,tree:this});else{var R=void 0,j=void 0;!E||E.has(this)?(R=this.bitMap,Ar(R,w),j=this):(R=this.bitMap.clone(),Ar(R,w),j=new d(this.blockSize,this.shrink,this.begin,R),E.add(j)),y({counter:this.begin+w,changed:!0,bitMap:R,tree:j})}else{var J=new Vd(this.blockSize,this.shrink,this.begin,this.depth+1);E&&(E.add(J),E.add(J.bitMap)),J.bitMapTrees[0]=this,qr(this.bitMap)&&Ar(J.bitMap,0),J.allocate(v,y,E)}}},{key:"deallocate",value:function(v,y,E){var w=v-this.begin;if(w>=0&&w<this.blockSize)if(So(this.bitMap,w)){var R=void 0,j=void 0;!E||E.has(this)?(R=this.bitMap,oi(R,w),j=this):(R=this.bitMap.clone(),oi(R,w),j=new d(this.blockSize,this.shrink,this.begin,R),E.add(j)),y({exists:!0,changed:!0,bitMap:R,tree:j})}else y({exists:!0,changed:!1,bitMap:this.bitMap,tree:this});else y({exists:!1,changed:!1,bitMap:this.bitMap,tree:this})}},{key:"check",value:function(v,y){var E=v-this.begin;E>=0&&E<this.blockSize?So(this.bitMap,E)?y(!0):y(!1):y(null)}}]),d}(Bf),Vd=function(u){kf(d,u);function d(S,v,y,E,w,R){jr(this,d);var j=Rf(this,(d.__proto__||rs(d)).call(this,S,v,y,E,w));return j.bitMapTrees=R||[],j}return $e(d,[{key:"allocate",value:function(v,y,E){var w=this,R=void 0;if(v==null?R=Lf(this.bitMap):R=Math.floor((v-this.begin)/Math.pow(this.blockSize,this.depth)),R!=null&&this.bitMapTrees[R]){var j=R;this.bitMapTrees[R].allocate(v,function(te){var ae=te.counter,ue=te.changed,re=te.bitMap,He=te.tree,De=w.bitMap,wn=w;if(ue){if(!E&&qr(re))Ar(De,j);else if(E&&E.has(w))qr(re)&&(E.has(w.bitMap)||(De=w.bitMap.clone(),E.add(De),w.bitMap=De),Ar(De,j)),wn.bitMapTrees[j]=He;else if(E){qr(re)&&(De=w.bitMap.clone(),E.add(De),Ar(De,j));var Jr=w.bitMapTrees.slice();Jr[j]=He,wn=new d(w.blockSize,w.shrink,w.begin,w.depth,De,Jr),E.add(wn)}}y({counter:ae,changed:ue,bitMap:De,tree:wn})},E)}else if(R===null||R>=this.blockSize){var J=new d(this.blockSize,this.shrink,this.begin,this.depth+1);E&&(E.add(J),E.add(J.bitMap)),J.bitMapTrees[0]=this,qr(this.bitMap)&&Ar(J.bitMap,0),J.allocate(v,y,E)}else{var ce=this.begin+R*Math.pow(this.blockSize,this.depth),g=this.depth-1,A=void 0;g===0?A=new fs(this.blockSize,this.shrink,ce):A=new d(this.blockSize,this.shrink,ce,g),E&&(E.add(A),E.add(A.bitMap));var C=void 0;if(!E||E.has(this))this.bitMapTrees[R]=A,C=this;else{var D=this.bitMapTrees.slice();D[R]=A,C=new d(this.blockSize,this.shrink,this.begin,this.depth,this.bitMap,D),E.add(C)}var X=R;A.allocate(v,function(te){var ae=te.counter,ue=te.changed,re=te.bitMap,He=te.tree,De=w.bitMap;re&&qr(re)&&(E&&!E.has(w.bitMap)&&(De=w.bitMap.clone(),E.add(De),C.bitMap=De),Ar(De,X)),y({counter:ae,changed:ue,bitMap:De,tree:C})},E)}}},{key:"deallocate",value:function(v,y,E){var w=this,R=Math.floor((v-this.begin)/Math.pow(this.blockSize,this.depth));if(this.bitMapTrees[R]){var j=qr(this.bitMapTrees[R].bitMap);this.bitMapTrees[R].deallocate(v,function(J){var ce=J.exists,g=J.changed,A=J.bitMap,C=J.tree,D=w.bitMap,X=w;if(!ce)y({exists:ce,changed:g,bitMap:D,tree:X});else{if(g){if(!E&&j)oi(D,R);else if(E&&E.has(w))j&&(E.has(w.bitMap)||(D=w.bitMap.clone(),E.add(D),w.bitMap=D),oi(D,R)),X.bitMapTrees[R]=C;else if(E){j&&(D=w.bitMap.clone(),E.add(D),oi(D,R));var te=w.bitMapTrees.slice();te[R]=C,X=new d(w.blockSize,w.shrink,w.begin,w.depth,D,te),E.add(X)}w.shrink&&(C instanceof fs&&Yd(A,w.blockSize)||C instanceof d&&so(C.bitMapTrees).length===0)&&delete X.bitMapTrees[R]}y({exists:!0,changed:g,bitMap:D,tree:X})}},E)}else y({exists:!1,changed:!1,bitMap:this.bitMap,tree:this})}},{key:"check",value:function(v,y){var E=Math.floor((v-this.begin)/Math.pow(this.blockSize,this.depth));this.bitMapTrees[E]?this.bitMapTrees[E].check(v,function(w){y(w)}):y(null)}}]),d}(Bf),zd=function(){function u(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,y=arguments[3];if(jr(this,u),S%32!==0)throw new RangeError("Blocksize for Counter must be a multiple of 32");this._begin=d,this._tree=y||new fs(S,v,0)}return $e(u,[{key:"allocate",value:function(S){if(S!=null){if(S<this._begin)throw new RangeError("counter needs to be greater or equal to the beginning offset");S=S-this._begin}var v=ei(this._tree,S),y=Ir(v,3),E=y[0],w=y[1],R=y[2];return this._tree=R,S==null?E+this._begin:w}},{key:"deallocate",value:function(S){var v=ti(this._tree,S-this._begin),y=Ir(v,2),E=y[0],w=y[1];return this._tree=w,E}},{key:"check",value:function(S){return ri(this._tree,S-this._begin)}}]),u}(),Uf=function(u,d,S){for(var v in d)S&&u[v]?u[v]=d[v]:Pt(u,v,d[v]);return u},go=function(u,d,S,v){if(!(u instanceof d)||v!==void 0&&v in u)throw TypeError(S+": incorrect invocation!");return u},jd=function(u,d,S,v){try{return v?d(ie(S)[0],S[1]):d(S)}catch(E){var y=u.return;throw y!==void 0&&ie(y.call(u)),E}},Kd=Ge("iterator"),Xd=Array.prototype,qd=function(u){return u!==void 0&&(o.Array===u||Xd[Kd]===u)},Pf=s(function(u){var d={},S={},v=u.exports=function(y,E,w,R,j){var J=j?function(){return y}:Qi(y),ce=K(w,R,E?2:1),g=0,A,C,D,X;if(typeof J!="function")throw TypeError(y+" is not iterable!");if(qd(J)){for(A=Kn(y.length);A>g;g++)if(X=E?ce(ie(C=y[g])[0],C[1]):ce(y[g]),X===d||X===S)return X}else for(D=J.call(y);!(C=D.next()).done;)if(X=jd(D,ce,C.value,E),X===d||X===S)return X};v.BREAK=d,v.RETURN=S}),Jd=Ge("species"),Qd=function(u){var d;return de(u)&&(d=u.constructor,typeof d=="function"&&(d===Array||de(d.prototype))&&(d=void 0),V(d)&&(d=d[Jd],d===null&&(d=void 0))),d===void 0?Array:d},Zd=function(u,d){return new(Qd(u))(d)},vo=function(u,d){var S=u==1,v=u==2,y=u==3,E=u==4,w=u==6,R=u==5||w,j=d||Zd;return function(J,ce,g){for(var A=ir(J),C=l(A),D=K(ce,g,3),X=Kn(C.length),te=0,ae=S?j(J,X):v?j(J,0):void 0,ue,re;X>te;te++)if((R||te in C)&&(ue=C[te],re=D(ue,te,A),u)){if(S)ae[te]=re;else if(re)switch(u){case 3:return!0;case 5:return ue;case 6:return te;case 2:ae.push(ue)}else if(E)return!1}return w?-1:y||E?E:ae}},mo=Jt.getWeak,eh=vo(5),th=vo(6),rh=0,us=function(u){return u._l||(u._l=new Mf)},Mf=function(){this.a=[]},Eo=function(u,d){return eh(u.a,function(S){return S[0]===d})};Mf.prototype={get:function(u){var d=Eo(this,u);if(d)return d[1]},has:function(u){return!!Eo(this,u)},set:function(u,d){var S=Eo(this,u);S?S[1]=d:this.a.push([u,d])},delete:function(u){var d=th(this.a,function(S){return S[0]===u});return~d&&this.a.splice(d,1),!!~d}};var $f={getConstructor:function(u,d,S,v){var y=u(function(E,w){go(E,y,d,"_i"),E._i=rh++,E._l=void 0,w!=null&&Pf(w,S,E[v],E)});return Uf(y.prototype,{delete:function(E){if(!V(E))return!1;var w=mo(E);return w===!0?us(this).delete(E):w&&me(w,this._i)&&delete w[this._i]},has:function(w){if(!V(w))return!1;var R=mo(w);return R===!0?us(this).has(w):R&&me(R,this._i)}}),y},def:function(u,d,S){var v=mo(ie(d),!0);return v===!0?us(u).set(d,S):v[u._i]=S,u},ufstore:us},nh=qt.f,ih=vo(0),sh=function(u,d,S,v,y,E){var w=I[u],R=w,j=y?"set":"add",J=R&&R.prototype,ce={};return!Ae||typeof R!="function"||!(E||J.forEach&&!he(function(){new R().entries().next()}))?(R=v.getConstructor(d,u,y,j),Uf(R.prototype,S),Jt.NEED=!0):(R=d(function(g,A){go(g,R,u,"_c"),g._c=new w,A!=null&&Pf(A,y,g[j],g)}),ih("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(g){var A=g=="add"||g=="set";g in J&&!(E&&g=="clear")&&Pt(R.prototype,g,function(C,D){if(go(this,R,g),!A&&E&&!V(C))return g=="get"?void 0:!1;var X=this._c[g](C===0?0:C,D);return A?this:X})}),"size"in J&&nh(R.prototype,"size",{get:function(){return this._c.size}})),Xe(R,u),ce[u]=R,ve(ve.G+ve.W+ve.F,ce),E||v.setStrong(R,u,y),R};sh("WeakSet",function(u){return function(){return u(this,arguments.length>0?arguments[0]:void 0)}},{add:function(d){return $f.def(this,d,!0)}},$f,!1,!0);var ah=b.WeakSet,oh=s(function(u){u.exports={default:ah,__esModule:!0}}),yo=i(oh),ch=function(){function u(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,y=arguments[3];if(jr(this,u),S%32!==0)throw new RangeError("Blocksize for Counter must be a multiple of 32");this._begin=d,this._blockSize=S,this._shrink=v,this._tree=y||new fs(S,v,0)}return $e(u,[{key:"allocate",value:function(S){if(S!=null){if(S<this._begin)throw new RangeError("counter needs to be greater or equal to the beginning offset");S=S-this._begin}var v=ei(this._tree,S,new yo),y=Ir(v,3),E=y[0],w=y[1],R=y[2],j=void 0;return w?j=new u(this._begin,this._blockSize,this._shrink,R):j=this,S==null?[E+this._begin,j]:[w,j]}},{key:"deallocate",value:function(S){var v=ti(this._tree,S-this._begin,new yo),y=Ir(v,2),E=y[0],w=y[1],R=void 0;return E?R=new u(this._begin,this._blockSize,this._shrink,w):R=this,[E,R]}},{key:"check",value:function(S){return ri(this._tree,S-this._begin)}},{key:"transaction",value:function(S){var v=this,y=new yo,E=this._tree,w=!1,R={allocate:function(J){if(J!=null){if(J<v._begin)throw new RangeError("counter needs to be greater or equal to the beginning offset");J=J-v._begin}var ce=ei(E,J,y),g=Ir(ce,3),A=g[0],C=g[1],D=g[2];return w=C,E=D,J==null?A+v._begin:w},deallocate:function(J){var ce=ti(E,J-v._begin,y),g=Ir(ce,2),A=g[0],C=g[1];return w=A,E=C,w},check:function(J){return ri(E,J-v._begin)}};return S(R),w?new u(this._begin,this._blockSize,this._shrink,E):this}}]),u}();t.default=zd,t.CounterImmutable=ch,Object.defineProperty(t,"__esModule",{value:!0})})}),Ys=Ce(pp),Sp=12,Vs=20,ed=Math.pow(2,Sp)-1,td=Math.pow(2,Vs)-1,gc=0,vc=0,Dn=function(r){Gr(e,r);function e(t,n){st(this,e);var i=$r(this,(e.__proto__||be(e)).call(this,n));return i.code=t,i}return e}(Error);Object.defineProperty(Dn,"ERROR_RANGE",{value:1});Object.defineProperty(Dn,"ERROR_CONFLICT",{value:2});var ia=function(){function r(){st(this,r),this._chrCounterMaj=new Ys(gc),this._chrDevices=new Ai}return ut(r,[{key:"getChr",value:function(t,n){var i=this._chrDevices.get(t);if(i){var s=gt(i,1),a=s[0];return a.get(n)}}},{key:"registerChr",value:function(t,n,i){var s=void 0,a=void 0,o=void 0,c=void 0;try{if(n===void 0)n=this._chrCounterMaj.allocate(),s=n;else{var f=this._chrDevices.get(n);if(!f)this._chrCounterMaj.allocate(n),s=n;else{var l=gt(f,2);c=l[0],o=l[1]}}if((!c||!o)&&(o=new Ys(vc),c=new Ai),i===void 0)i=o.allocate(),a=i;else if(!c.has(i))o.allocate(i),a=i;else throw new Dn(Dn.ERROR_CONFLICT);if(n>ed||n<gc||i>td||i<vc)throw new Dn(Dn.ERROR_RANGE);c.set(i,t),this._chrDevices.set(n,[c,o]);return}catch(h){throw s!=null&&this._chrCounterMaj.deallocate(s),a!=null&&o&&o.deallocate(a),h}}},{key:"deregisterChr",value:function(t,n){var i=this._chrDevices.get(t);if(i){var s=gt(i,2),a=s[0],o=s[1];a.delete(n)&&o.deallocate(n),a.size||(this._chrDevices.delete(t),this._chrCounterMaj.deallocate(t))}}}]),r}();function vr(r,e){return r<<Vs|e}function sa(r){var e=r>>Vs,t=r&(1<<Vs)-1;return[e,t]}var qo=Nt.getWeak,gp=na(5),vp=na(6),mp=0,xs=function(r){return r._l||(r._l=new rd)},rd=function(){this.a=[]},Jo=function(r,e){return gp(r.a,function(t){return t[0]===e})};rd.prototype={get:function(r){var e=Jo(this,r);if(e)return e[1]},has:function(r){return!!Jo(this,r)},set:function(r,e){var t=Jo(this,r);t?t[1]=e:this.a.push([r,e])},delete:function(r){var e=vp(this.a,function(t){return t[0]===r});return~e&&this.a.splice(e,1),!!~e}};var Ws={getConstructor:function(r,e,t,n){var i=r(function(s,a){Hs(s,i,e,"_i"),s._t=e,s._i=mp++,s._l=void 0,a!=null&&Bn(a,t,s[n],s)});return Mc(i.prototype,{delete:function(s){if(!qe(s))return!1;var a=qo(s);return a===!0?xs(Ct(this,e)).delete(s):a&&ye(a,this._i)&&delete a[this._i]},has:function(a){if(!qe(a))return!1;var o=qo(a);return o===!0?xs(Ct(this,e)).has(a):o&&ye(o,this._i)}}),i},def:function(r,e,t){var n=qo(Ot(e),!0);return n===!0?xs(r).set(e,t):n[r._i]=t,r},ufstore:xs},Wv=pe(function(r){var e=na(0),t=Ct,n=!je.ActiveXObject&&"ActiveXObject"in je,i="WeakMap",s=Nt.getWeak,a=Object.isExtensible,o=Ws.ufstore,c,f=function(_){return function(){return _(this,arguments.length>0?arguments[0]:void 0)}},l={get:function(m){if(qe(m)){var I=s(m);return I===!0?o(Ct(this,i)).get(m):I?I[this._i]:void 0}},set:function(m,I){return Ws.def(Ct(this,i),m,I)}},h=r.exports=Kl(i,f,l,Ws,!0,!0);t&&n&&(c=Ws.getConstructor(f,i),Wl(c.prototype,l),Nt.NEED=!0,e(["delete","has","get","set"],function(_){var m=h.prototype,I=m[_];Ps(m,_,function(b,H){if(qe(b)&&!a(b)){this._f||(this._f=new c);var M=this._f[_](b,H);return _=="set"?this:M}return I.call(this,b,H)})}))});Xl("WeakMap");ql("WeakMap");var Ep=Te.WeakMap,yp=pe(function(r){r.exports={default:Ep,__esModule:!0}}),Ip=Ce(yp);ne(ne.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}});var wp=Te.Math.log2,Ap=pe(function(r){r.exports={default:wp,__esModule:!0}}),bp=Ce(Ap);function zs(r,e){if(r.maxByteLength<e){var t=1<<Math.ceil(bp(e)),n=new ArrayBuffer(e,{maxByteLength:t}),i=new Uint8Array(r),s=new Uint8Array(n);return s.set(i),n}return r.byteLength<e&&r.resize(e),r}function mc(r,e){var t=r.byteLength+e.byteLength,n=r;r.maxByteLength<t&&(newBuf=zs(r,t),newBuf.set(e,r.byteLength),n=newBuf);var i=new Uint8Array(n),s=new Uint8Array(e);return i.set(s,r.byteLength),newBuf}function Uu(r){var e=new ArrayBuffer(r.byteLength,{maxByteLength:r.maxByteLength}),t=new Uint8Array(r),n=new Uint8Array(e);return n.set(t,r.byteLength),e}var aa=function(){function r(e,t){st(this,r);var n=new Date;this._metadata=new Bs(Rn({},e,{mode:e.mode,nlink:e.nlink||0,atime:n,mtime:n,ctime:n,birthtime:n})),this._iNodeMgr=t}return ut(r,[{key:"getMetadata",value:function(){return this._metadata}}]),r}(),vt=function(r){Gr(e,r);function e(t,n){st(this,e);var i=$r(this,(e.__proto__||be(e)).call(this,{ino:t.ino,uid:t.uid,gid:t.gid,mode:T.S_IFREG|t.mode&~T.S_IFMT,size:t.data?t.data.byteLength:0},n));return i._data=t.data?t.data:new ArrayBuffer(0),i}return ut(e,[{key:"getData",value:function(){return this._data}},{key:"setData",value:function(n){this._data=n}},{key:"read",value:function(){}},{key:"write",value:function(n,i,s){var a=this._data,o=void 0;if(s)a=mc(a,n),o=n.byteLength;else{i=a.byteLength<i?a.byteLength:i;var c=a.byteLength-i,f=n.byteLength-c;f>0&&(a=zs(a,a.byteLength+f)),o=n.byteLength;var l=new Uint8Array(a);l.set(new Uint8Array(n),i)}return this._data=a,this._metadata.size=this._data.byteLength,o}},{key:"destructor",value:function(){}}]),e}(aa),xe=function(r){Gr(e,r);function e(t,n){st(this,e),t.parent===void 0&&(t.parent=t.ino);var i=void 0;t.parent===t.ino?i=2:(i=1,n.linkINode(n.getINode(t.parent)));var s=$r(this,(e.__proto__||be(e)).call(this,{ino:t.ino,mode:T.S_IFDIR|t.mode&~T.S_IFMT,uid:t.uid,gid:t.gid,nlink:i,size:4096},n));return s._dir=new Ai([[".",t.ino],["..",t.parent]]),s}return ut(e,[{key:"getEntries",value:function(){return this._metadata.atime=new Date,this._dir.entries()}},{key:"getEntryIndex",value:function(n){return this._dir.get(n)}},{key:"getEntry",value:function(n){var i=this._dir.get(n);if(i!==void 0)return this._iNodeMgr.getINode(i)}},{key:"addEntry",value:function(n,i){if(n==="."||n==="..")throw new Error("Not allowed to add `.` or `..` entries");var s=new Date;this._metadata.mtime=s,this._metadata.ctime=s,this._iNodeMgr.linkINode(this._iNodeMgr.getINode(i)),this._dir.set(n,i)}},{key:"deleteEntry",value:function(n){if(n==="."||n==="..")throw new Error("Not allowed to delete `.` or `..` entries");var i=this._dir.get(n);if(i!==void 0){var s=new Date;this._metadata.mtime=s,this._metadata.ctime=s,this._dir.delete(n),this._iNodeMgr.unlinkINode(this._iNodeMgr.getINode(i))}}},{key:"renameEntry",value:function(n,i){if(n==="."||n===".."||i==="."||n==="..")throw new Error("Not allowed to rename `.` or `..` entries");var s=this._dir.get(n);if(s!=null){var a=new Date;this._metadata.mtime=a,this._metadata.ctime=a,this._dir.delete(n),this._dir.set(i,s)}}},{key:"destructor",value:function(){if(this._dir.get(".")!==this._dir.get("..")){var n=this._dir.get("..");n!=null&&this._iNodeMgr.unlinkINode(this._iNodeMgr.getINode(n))}}}]),e}(aa),kn=function(r){Gr(e,r);function e(t,n){st(this,e);var i=$r(this,(e.__proto__||be(e)).call(this,{ino:t.ino,mode:T.S_IFLNK|t.mode&~T.S_IFMT,uid:t.uid,gid:t.gid,size:new TextEncoder().encode(t.link).byteLength},n));return i._link=t.link,i}return ut(e,[{key:"getLink",value:function(){return this._link}},{key:"destructor",value:function(){}}]),e}(aa),jt=function(r){Gr(e,r);function e(t,n){st(this,e);var i=$r(this,(e.__proto__||be(e)).call(this,{ino:t.ino,mode:T.S_IFCHR|t.mode&~T.S_IFMT,uid:t.uid,gid:t.gid,rdev:t.rdev,size:0},n));return i.teardown=t.teardown,i}return ut(e,[{key:"getFileDesOps",value:function(){var n=sa(this.getMetadata().rdev),i=gt(n,2),s=i[0],a=i[1];return this._iNodeMgr._devMgr.getChr(s,a)}},{key:"destructor",value:function(){this.teardown!==void 0&&this.teardown()}}]),e}(aa),$c=function(){function r(e){st(this,r),this._counter=new Ys(1),this._iNodes=new Ai,this._iNodeRefs=new Ip,this._devMgr=e}return ut(r,[{key:"createINode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n.ino=this._counter.allocate(),n.mode=typeof n.mode=="number"?n.mode:0,n.uid=typeof n.uid=="number"?n.uid:Qt,n.gid=typeof n.gid=="number"?n.gid:Sc;var i=new t(n,this);return this._iNodes.set(n.ino,i),this._iNodeRefs.set(i,0),[i,n.ino]}},{key:"getINode",value:function(t){return this._iNodes.get(t)}},{key:"linkINode",value:function(t){t&&++t.getMetadata().nlink}},{key:"unlinkINode",value:function(t){t&&(--t.getMetadata().nlink,this._gcINode(t))}},{key:"refINode",value:function(t){if(t){var n=this._iNodeRefs.get(t);n!==void 0&&this._iNodeRefs.set(t,n+1)}}},{key:"unrefINode",value:function(t){if(t){var n=this._iNodeRefs.get(t);n!==void 0&&(this._iNodeRefs.set(t,n-1),this._gcINode(t))}}},{key:"_gcINode",value:function(t){var n=t.getMetadata(),i=n.nlink+this._iNodeRefs.get(t);if(i===0||i===1&&t instanceof xe){var s=n.ino;t.destructor(),this._iNodes.delete(s),this._counter.deallocate(s)}}}]),r}(),Tp=pe(function(r){(function(e,t,n){r.exports?r.exports=n():t[e]=n()})("prr",ln,function(){var e=typeof Object.defineProperty=="function"?function(i,s,a){return Object.defineProperty(i,s,a),i}:function(i,s,a){return i[s]=a.value,i},t=function(i,s){var a=typeof s=="object",o=!a&&typeof s=="string",c=function(f){return a?!!s[f]:o?s.indexOf(f[0])>-1:!1};return{enumerable:c("enumerable"),configurable:c("configurable"),writable:c("writable"),value:i}},n=function(i,s,a,o){var c;if(o=t(a,o),typeof s=="object"){for(c in s)Object.hasOwnProperty.call(s,c)&&(o.value=s[c],e(i,c,o));return i}return e(i,s,o)};return n})});function nd(r,e,t){e&&typeof e!="string"&&(e=e.message||e.name),Tp(this,{type:r,name:r,cause:typeof e!="string"?e:t,message:e},"ewr")}function Gc(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),nd.call(this,"CustomError",r,e)}Gc.prototype=new Error;function Cp(r,e,t){var n=function(i,s){nd.call(this,e,i,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,n)};return n.prototype=t?new t:new Gc,n}var Op=function(r){var e=function(t,n){return Cp(r,t,n)};return{CustomError:Gc,FilesystemError:e("FilesystemError"),createError:e}},xi=pe(function(r){var e=r.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];r.exports.errno={},r.exports.code={},e.forEach(function(t){r.exports.errno[t.errno]=t,r.exports.code[t.code]=t}),r.exports.custom=Op(r.exports),r.exports.create=r.exports.custom.createError}),Rv=xi.all,Fv=xi.errno,F=xi.code,Dv=xi.custom,Nv=xi.create,W=function(r){Gr(e,r);function e(t,n,i,s){st(this,e);var a=t.code+": "+t.description;n!=null&&(a+=", "+n,i!=null&&(a+=" -> "+i));var o=$r(this,(e.__proto__||be(e)).call(this,a));return o.errno=t.errno,o.code=t.code,o.errnoDescription=t.description,s!=null&&(o.syscall=s),o}return ut(e,[{key:"setPaths",value:function(n,i){var s=this.code+": "+this.errnoDescription+", "+n;i!=null&&(s+=" -> "+i),this.message=s}},{key:"setSyscall",value:function(n){this.syscall=n}}]),e}(Error),xp=function(){function r(e,t){st(this,r),this._iNode=e,this._flags=t,this._pos=0}return ut(r,[{key:"getINode",value:function(){return this._iNode}},{key:"getFlags",value:function(){return this._flags}},{key:"setFlags",value:function(t){this._flags=t}},{key:"getPos",value:function(){return this._pos}},{key:"setPos",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T.SEEK_SET,i=this.getINode(),s=void 0;switch(!0){case i instanceof vt:case i instanceof xe:switch(n){case T.SEEK_SET:s=t;break;case T.SEEK_CUR:s=this._pos+t;break;case T.SEEK_END:s=i.getData().length+t;break;default:s=this._pos}if(s<0)throw new W(F.EINVAL);this._pos=s;break;case i instanceof jt:var a=i.getFileDesOps();if(a)if(a.setPos)a.setPos(this,t,n);else throw new W(F.ESPIPE);else throw new W(F.ENXIO);break;default:throw new W(F.ESPIPE)}}},{key:"read",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=void 0;n===null?i=this._pos:i=n;var s=this._iNode,a=void 0;switch(!0){case s instanceof vt:var o=s.getData(),c=s.getMetadata();a=o.copy(t,0,i),c.atime=new Date;break;case s instanceof jt:var f=s.getFileDesOps();if(f)if(f.read)a=f.read(this,t,i);else throw new W(F.EINVAL);else throw new W(F.ENXIO);break;default:throw new W(F.EINVAL)}return n===null&&(this._pos=i+a),a}},{key:"write",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=void 0;n===null?s=this._pos:s=n;var a=this._iNode,o=void 0;switch(!0){case a instanceof vt:var c=a.getData(),f=a.getMetadata();if((this.getFlags()|i)&T.O_APPEND)s=c.length,c=L.concat([c,t]),o=t.length;else{if(s>c.length)c=L.concat([c,L.alloc(s-c.length),L.allocUnsafe(t.length)]);else if(s<=c.length){var l=c.length-s,h=t.length-l;h>0&&(c=L.concat([c,L.allocUnsafe(h)]))}o=t.copy(c,s)}a.setData(c);var _=new Date;f.mtime=_,f.ctime=_,f.size=c.length;break;case a instanceof jt:var m=a.getFileDesOps();if(m)if(m.write)o=m.write(this,t,s,i);else throw new W(F.EINVAL);else throw new W(F.ENXIO);break;default:throw new W(F.EINVAL)}return n===null&&(this._pos=s+o),o}}]),r}(),Hc=function(){function r(e){st(this,r),this._counter=new Ys(0),this._fds=new Ai,this._iNodeMgr=e}return ut(r,[{key:"createFd",value:function(t,n){this._iNodeMgr.refINode(t);var i=this._counter.allocate(),s=new xp(t,n);if(t instanceof jt){var a=t.getFileDesOps();if(a)a.open&&a.open(s);else throw new W(F.ENXIO)}return this._fds.set(i,s),[s,i]}},{key:"getFd",value:function(t){return this._fds.get(t)}},{key:"dupFd",value:function(t){var n=this._fds.get(t);if(n){this._iNodeMgr.refINode(n.getINode());var i=this._counter.allocate();return this._fds.set(i,n),t}}},{key:"deleteFd",value:function(t){var n=this._fds.get(t);if(n){var i=n.getINode();if(i instanceof jt){var s=i.getFileDesOps();if(s)s.close&&s.close(n);else throw new W(F.ENXIO)}this._fds.delete(t),this._counter.deallocate(t),this._iNodeMgr.unrefINode(i)}}}]),r}(),Wp=ta.f;Uc("getOwnPropertyDescriptor",function(){return function(e,t){return Wp(rr(e),t)}});var Rp=Te.Object,Fp=function(e,t){return Rp.getOwnPropertyDescriptor(e,t)},id=pe(function(r){r.exports={default:Fp,__esModule:!0}});Ce(id);var Dp=pe(function(r,e){e.__esModule=!0;var t=i(Jl),n=i(id);function i(s){return s&&s.__esModule?s:{default:s}}e.default=function s(a,o,c){a===null&&(a=Function.prototype);var f=(0,n.default)(a,o);if(f===void 0){var l=(0,t.default)(a);return l===null?void 0:s(l,o,c)}else{if("value"in f)return f.value;var h=f.get;return h===void 0?void 0:h.call(c)}}}),Qe=Ce(Dp),Qo;function Br(){}Br.prototype=Object.create(null);function Se(){Se.init.call(this)}Se.EventEmitter=Se;Se.usingDomains=!1;Se.prototype.domain=void 0;Se.prototype._events=void 0;Se.prototype._maxListeners=void 0;Se.defaultMaxListeners=10;Se.init=function(){this.domain=null,Se.usingDomains&&Qo.active&&!(this instanceof Qo.Domain)&&(this.domain=Qo.active),(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Br,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Se.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this};function sd(r){return r._maxListeners===void 0?Se.defaultMaxListeners:r._maxListeners}Se.prototype.getMaxListeners=function(){return sd(this)};function Np(r,e,t){if(e)r.call(t);else for(var n=r.length,i=Wi(r,n),s=0;s<n;++s)i[s].call(t)}function kp(r,e,t,n){if(e)r.call(t,n);else for(var i=r.length,s=Wi(r,i),a=0;a<i;++a)s[a].call(t,n)}function Lp(r,e,t,n,i){if(e)r.call(t,n,i);else for(var s=r.length,a=Wi(r,s),o=0;o<s;++o)a[o].call(t,n,i)}function Bp(r,e,t,n,i,s){if(e)r.call(t,n,i,s);else for(var a=r.length,o=Wi(r,a),c=0;c<a;++c)o[c].call(t,n,i,s)}function Up(r,e,t,n){if(e)r.apply(t,n);else for(var i=r.length,s=Wi(r,i),a=0;a<i;++a)s[a].apply(t,n)}Se.prototype.emit=function(e){var t,n,i,s,a,o,c,f=!1,l=e==="error";if(o=this._events,o)l=l&&o.error==null;else if(!l)return!1;if(c=this.domain,l){if(t=arguments[1],c)t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=c,t.domainThrown=!1,c.emit("error",t);else{if(t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}return!1}if(n=o[e],!n)return!1;var _=typeof n=="function";switch(i=arguments.length,i){case 1:Np(n,_,this);break;case 2:kp(n,_,this,arguments[1]);break;case 3:Lp(n,_,this,arguments[1],arguments[2]);break;case 4:Bp(n,_,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(i-1),a=1;a<i;a++)s[a-1]=arguments[a];Up(n,_,this,s)}return f&&c.exit(),!0};function ad(r,e,t,n){var i,s,a;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(s=r._events,s?(s.newListener&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]):(s=r._events=new Br,r._eventsCount=0),!a)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),!a.warned&&(i=sd(r),i&&i>0&&a.length>i)){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=e,o.count=a.length,Pp(o)}return r}function Pp(r){typeof console.warn=="function"?console.warn(r):console.log(r)}Se.prototype.addListener=function(e,t){return ad(this,e,t,!1)};Se.prototype.on=Se.prototype.addListener;Se.prototype.prependListener=function(e,t){return ad(this,e,t,!0)};function od(r,e,t){var n=!1;function i(){r.removeListener(e,i),n||(n=!0,t.apply(r,arguments))}return i.listener=t,i}Se.prototype.once=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.on(e,od(this,e,t)),this};Se.prototype.prependOnceListener=function(e,t){if(typeof t!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(e,od(this,e,t)),this};Se.prototype.removeListener=function(e,t){var n,i,s,a,o;if(typeof t!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[e],!n)return this;if(n===t||n.listener&&n.listener===t)--this._eventsCount===0?this._events=new Br:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=n[a].listener,s=a;break}if(s<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Br,this;delete i[e]}else Mp(n,s);i.removeListener&&this.emit("removeListener",e,o||t)}return this};Se.prototype.removeAllListeners=function(e){var t,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Br,this._eventsCount=0):n[e]&&(--this._eventsCount===0?this._events=new Br:delete n[e]),this;if(arguments.length===0){for(var i=Object.keys(n),s=0,a;s<i.length;++s)a=i[s],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=new Br,this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t)do this.removeListener(e,t[t.length-1]);while(t[0]);return this};Se.prototype.listeners=function(e){var t,n,i=this._events;return i?(t=i[e],t?typeof t=="function"?n=[t.listener||t]:n=$p(t):n=[]):n=[],n};Se.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):cd.call(r,e)};Se.prototype.listenerCount=cd;function cd(r){var e=this._events;if(e){var t=e[r];if(typeof t=="function")return 1;if(t)return t.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Mp(r,e){for(var t=e,n=t+1,i=r.length;n<i;t+=1,n+=1)r[t]=r[n];r.pop()}function Wi(r,e){for(var t=new Array(e);e--;)t[e]=r[e];return t}function $p(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}var Ec;typeof Object.create=="function"?Ec=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:Ec=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var Gn=Ec,Gp=/%[sdj%]/g;function Hp(r){if(!Vc(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Ur(arguments[t]));return e.join(" ")}for(var t=1,n=arguments,i=n.length,s=String(r).replace(Gp,function(o){if(o==="%%")return"%";if(t>=i)return o;switch(o){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch{return"[Circular]"}default:return o}}),a=n[t];t<i;a=n[++t])Yc(a)||!Ri(a)?s+=" "+a:s+=" "+Ur(a);return s}function fd(r,e){if(kr(Ln.process))return function(){return fd(r,e).apply(this,arguments)};if(Ls.noDeprecation===!0)return r;var t=!1;function n(){if(!t){if(Ls.throwDeprecation)throw new Error(e);Ls.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return n}var Rs={},Zo;function Yp(r){if(kr(Zo)&&(Zo=Ls.env.NODE_DEBUG||""),r=r.toUpperCase(),!Rs[r])if(new RegExp("\\b"+r+"\\b","i").test(Zo)){var e=0;Rs[r]=function(){var t=Hp.apply(null,arguments);console.error("%s %d: %s",r,e,t)}}else Rs[r]=function(){};return Rs[r]}function Ur(r,e){var t={seen:[],stylize:zp};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),ud(e)?t.showHidden=e:e&&Zp(t,e),kr(t.showHidden)&&(t.showHidden=!1),kr(t.depth)&&(t.depth=2),kr(t.colors)&&(t.colors=!1),kr(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=Vp),js(t,r,t.depth)}Ur.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Ur.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Vp(r,e){var t=Ur.styles[e];return t?"\x1B["+Ur.colors[t][0]+"m"+r+"\x1B["+Ur.colors[t][1]+"m":r}function zp(r,e){return r}function jp(r){var e={};return r.forEach(function(t,n){e[t]=!0}),e}function js(r,e,t){if(r.customInspect&&e&&nc(e.inspect)&&e.inspect!==Ur&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(t,r);return Vc(n)||(n=js(r,n,t)),n}var i=Kp(r,e);if(i)return i;var s=Object.keys(e),a=jp(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),rc(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return ec(e);if(s.length===0){if(nc(e)){var o=e.name?": "+e.name:"";return r.stylize("[Function"+o+"]","special")}if(tc(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Pu(e))return r.stylize(Date.prototype.toString.call(e),"date");if(rc(e))return ec(e)}var c="",f=!1,l=["{","}"];if(Jp(e)&&(f=!0,l=["[","]"]),nc(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(tc(e)&&(c=" "+RegExp.prototype.toString.call(e)),Pu(e)&&(c=" "+Date.prototype.toUTCString.call(e)),rc(e)&&(c=" "+ec(e)),s.length===0&&(!f||e.length==0))return l[0]+c+l[1];if(t<0)return tc(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var _;return f?_=Xp(r,e,t,a,s):_=s.map(function(m){return yc(r,e,t,a,m,f)}),r.seen.pop(),qp(_,c,l)}function Kp(r,e){if(kr(e))return r.stylize("undefined","undefined");if(Vc(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(Qp(e))return r.stylize(""+e,"number");if(ud(e))return r.stylize(""+e,"boolean");if(Yc(e))return r.stylize("null","null")}function ec(r){return"["+Error.prototype.toString.call(r)+"]"}function Xp(r,e,t,n,i){for(var s=[],a=0,o=e.length;a<o;++a)ld(e,String(a))?s.push(yc(r,e,t,n,String(a),!0)):s.push("");return i.forEach(function(c){c.match(/^\d+$/)||s.push(yc(r,e,t,n,c,!0))}),s}function yc(r,e,t,n,i,s){var a,o,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?o=r.stylize("[Getter/Setter]","special"):o=r.stylize("[Getter]","special"):c.set&&(o=r.stylize("[Setter]","special")),ld(n,i)||(a="["+i+"]"),o||(r.seen.indexOf(c.value)<0?(Yc(t)?o=js(r,c.value,null):o=js(r,c.value,t-1),o.indexOf(`
`)>-1&&(s?o=o.split(`
`).map(function(f){return"  "+f}).join(`
`).substr(2):o=`
`+o.split(`
`).map(function(f){return"   "+f}).join(`
`))):o=r.stylize("[Circular]","special")),kr(a)){if(s&&i.match(/^\d+$/))return o;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=r.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=r.stylize(a,"string"))}return a+": "+o}function qp(r,e,t){var n=0,i=r.reduce(function(s,a){return n++,a.indexOf(`
`)>=0&&n++,s+a.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function Jp(r){return Array.isArray(r)}function ud(r){return typeof r=="boolean"}function Yc(r){return r===null}function Qp(r){return typeof r=="number"}function Vc(r){return typeof r=="string"}function kr(r){return r===void 0}function tc(r){return Ri(r)&&zc(r)==="[object RegExp]"}function Ri(r){return typeof r=="object"&&r!==null}function Pu(r){return Ri(r)&&zc(r)==="[object Date]"}function rc(r){return Ri(r)&&(zc(r)==="[object Error]"||r instanceof Error)}function nc(r){return typeof r=="function"}function zc(r){return Object.prototype.toString.call(r)}function Zp(r,e){if(!e||!Ri(e))return r;for(var t=Object.keys(e),n=t.length;n--;)r[t[n]]=e[t[n]];return r}function ld(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function _n(){this.head=null,this.tail=null,this.length=0}_n.prototype.push=function(r){var e={data:r,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length};_n.prototype.unshift=function(r){var e={data:r,next:this.head};this.length===0&&(this.tail=e),this.head=e,++this.length};_n.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}};_n.prototype.clear=function(){this.head=this.tail=null,this.length=0};_n.prototype.join=function(r){if(this.length===0)return"";for(var e=this.head,t=""+e.data;e=e.next;)t+=r+e.data;return t};_n.prototype.concat=function(r){if(this.length===0)return L.alloc(0);if(this.length===1)return this.head.data;for(var e=L.allocUnsafe(r>>>0),t=this.head,n=0;t;)t.data.copy(e,n),n+=t.data.length,t=t.next;return e};var eS=L.isEncoding||function(r){switch(r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function tS(r){if(r&&!eS(r))throw new Error("Unknown encoding: "+r)}function Fi(r){switch(this.encoding=(r||"utf8").toLowerCase().replace(/[-_]/,""),tS(r),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=nS;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=iS;break;default:this.write=rS;return}this.charBuffer=new L(6),this.charReceived=0,this.charLength=0}Fi.prototype.write=function(r){for(var e="";this.charLength;){var t=r.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:r.length;if(r.copy(this.charBuffer,this.charReceived,0,t),this.charReceived+=t,this.charReceived<this.charLength)return"";r=r.slice(t,r.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=e.charCodeAt(e.length-1);if(i>=55296&&i<=56319){this.charLength+=this.surrogateSize,e="";continue}if(this.charReceived=this.charLength=0,r.length===0)return e;break}this.detectIncompleteChar(r);var n=r.length;this.charLength&&(r.copy(this.charBuffer,0,r.length-this.charReceived,n),n-=this.charReceived),e+=r.toString(this.encoding,0,n);var n=e.length-1,i=e.charCodeAt(n);if(i>=55296&&i<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),r.copy(this.charBuffer,0,0,s),e.substring(0,n)}return e};Fi.prototype.detectIncompleteChar=function(r){for(var e=r.length>=3?3:r.length;e>0;e--){var t=r[r.length-e];if(e==1&&t>>5==6){this.charLength=2;break}if(e<=2&&t>>4==14){this.charLength=3;break}if(e<=3&&t>>3==30){this.charLength=4;break}}this.charReceived=e};Fi.prototype.end=function(r){var e="";if(r&&r.length&&(e=this.write(r)),this.charReceived){var t=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,t).toString(i)}return e};function rS(r){return r.toString(this.encoding)}function nS(r){this.charReceived=r.length%2,this.charLength=this.charReceived?2:0}function iS(r){this.charReceived=r.length%3,this.charLength=this.charReceived?3:0}Fe.ReadableState=dd;var Ee=Yp("stream");Gn(Fe,Se);function sS(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function aS(r,e){return r.listeners(e).length}function dd(r,e){r=r||{},this.objectMode=!!r.objectMode,e instanceof kt&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var t=r.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:n,this.highWaterMark=~~this.highWaterMark,this.buffer=new _n,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(this.decoder=new Fi(r.encoding),this.encoding=r.encoding)}function Fe(r){if(!(this instanceof Fe))return new Fe(r);this._readableState=new dd(r,this),this.readable=!0,r&&typeof r.read=="function"&&(this._read=r.read),Se.call(this)}Fe.prototype.push=function(r,e){var t=this._readableState;return!t.objectMode&&typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=L.from(r,e),e="")),hd(this,t,r,e,!1)};Fe.prototype.unshift=function(r){var e=this._readableState;return hd(this,e,r,"",!0)};Fe.prototype.isPaused=function(){return this._readableState.flowing===!1};function hd(r,e,t,n,i){var s=fS(e,t);if(s)r.emit("error",s);else if(t===null)e.reading=!1,uS(r,e);else if(e.objectMode||t&&t.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");r.emit("error",a)}else if(e.endEmitted&&i){var o=new Error("stream.unshift() after end event");r.emit("error",o)}else{var c;e.decoder&&!i&&!n&&(t=e.decoder.write(t),c=!e.objectMode&&t.length===0),i||(e.reading=!1),c||(e.flowing&&e.length===0&&!e.sync?(r.emit("data",t),r.read(0)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&oa(r))),lS(r,e)}else i||(e.reading=!1);return oS(e)}function oS(r){return!r.ended&&(r.needReadable||r.length<r.highWaterMark||r.length===0)}Fe.prototype.setEncoding=function(r){return this._readableState.decoder=new Fi(r),this._readableState.encoding=r,this};var Mu=8388608;function cS(r){return r>=Mu?r=Mu:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function $u(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=cS(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Fe.prototype.read=function(r){Ee("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Ee("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?ic(this):oa(this),null;if(r=$u(r,e),r===0&&e.ended)return e.length===0&&ic(this),null;var n=e.needReadable;Ee("need readable",n),(e.length===0||e.length-r<e.highWaterMark)&&(n=!0,Ee("length less than watermark",n)),e.ended||e.reading?(n=!1,Ee("reading or ended",n)):n&&(Ee("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=$u(t,e)));var i;return r>0?i=_d(r,e):i=null,i===null?(e.needReadable=!0,r=0):e.length-=r,e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&ic(this)),i!==null&&this.emit("data",i),i};function fS(r,e){var t=null;return!ll(e)&&typeof e!="string"&&e!==null&&e!==void 0&&!r.objectMode&&(t=new TypeError("Invalid non-string/buffer chunk")),t}function uS(r,e){if(!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,oa(r)}}function oa(r){var e=r._readableState;e.needReadable=!1,e.emittedReadable||(Ee("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?at(Gu,r):Gu(r))}function Gu(r){Ee("emit readable"),r.emit("readable"),jc(r)}function lS(r,e){e.readingMore||(e.readingMore=!0,at(dS,r,e))}function dS(r,e){for(var t=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Ee("maybeReadMore read 0"),r.read(0),t!==e.length);)t=e.length;e.readingMore=!1}Fe.prototype._read=function(r){this.emit("error",new Error("not implemented"))};Fe.prototype.pipe=function(r,e){var t=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=r;break;case 1:n.pipes=[n.pipes,r];break;default:n.pipes.push(r);break}n.pipesCount+=1,Ee("pipe count=%d opts=%j",n.pipesCount,e);var i=!e||e.end!==!1,s=i?o:l;n.endEmitted?at(s):t.once("end",s),r.on("unpipe",a);function a(M){Ee("onunpipe"),M===t&&l()}function o(){Ee("onend"),r.end()}var c=hS(t);r.on("drain",c);var f=!1;function l(){Ee("cleanup"),r.removeListener("close",I),r.removeListener("finish",b),r.removeListener("drain",c),r.removeListener("error",m),r.removeListener("unpipe",a),t.removeListener("end",o),t.removeListener("end",l),t.removeListener("data",_),f=!0,n.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}var h=!1;t.on("data",_);function _(M){Ee("ondata"),h=!1;var K=r.write(M);K===!1&&!h&&((n.pipesCount===1&&n.pipes===r||n.pipesCount>1&&pd(n.pipes,r)!==-1)&&!f&&(Ee("false write response, pause",t._readableState.awaitDrain),t._readableState.awaitDrain++,h=!0),t.pause())}function m(M){Ee("onerror",M),H(),r.removeListener("error",m),aS(r,"error")===0&&r.emit("error",M)}sS(r,"error",m);function I(){r.removeListener("finish",b),H()}r.once("close",I);function b(){Ee("onfinish"),r.removeListener("close",I),H()}r.once("finish",b);function H(){Ee("unpipe"),t.unpipe(r)}return r.emit("pipe",t),n.flowing||(Ee("pipe resume"),t.resume()),r};function hS(r){return function(){var e=r._readableState;Ee("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&r.listeners("data").length&&(e.flowing=!0,jc(r))}}Fe.prototype.unpipe=function(r){var e=this._readableState;if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this),this);if(!r){var t=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<n;i++)t[i].emit("unpipe",this);return this}var s=pd(e.pipes,r);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this),this)};Fe.prototype.on=function(r,e){var t=Se.prototype.on.call(this,r,e);if(r==="data")this._readableState.flowing!==!1&&this.resume();else if(r==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&oa(this,n):at(_S,this))}return t};Fe.prototype.addListener=Fe.prototype.on;function _S(r){Ee("readable nexttick read 0"),r.read(0)}Fe.prototype.resume=function(){var r=this._readableState;return r.flowing||(Ee("resume"),r.flowing=!0,pS(this,r)),this};function pS(r,e){e.resumeScheduled||(e.resumeScheduled=!0,at(SS,r,e))}function SS(r,e){e.reading||(Ee("resume read 0"),r.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,r.emit("resume"),jc(r),e.flowing&&!e.reading&&r.read(0)}Fe.prototype.pause=function(){return Ee("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ee("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function jc(r){var e=r._readableState;for(Ee("flow",e.flowing);e.flowing&&r.read()!==null;);}Fe.prototype.wrap=function(r){var e=this._readableState,t=!1,n=this;r.on("end",function(){if(Ee("wrapped end"),e.decoder&&!e.ended){var a=e.decoder.end();a&&a.length&&n.push(a)}n.push(null)}),r.on("data",function(a){if(Ee("wrapped data"),e.decoder&&(a=e.decoder.write(a)),!(e.objectMode&&a==null)&&!(!e.objectMode&&(!a||!a.length))){var o=n.push(a);o||(t=!0,r.pause())}});for(var i in r)this[i]===void 0&&typeof r[i]=="function"&&(this[i]=function(a){return function(){return r[a].apply(r,arguments)}}(i));var s=["error","close","destroy","pause","resume"];return yS(s,function(a){r.on(a,n.emit.bind(n,a))}),n._read=function(a){Ee("wrapped _read",a),t&&(t=!1,r.resume())},n};Fe._fromList=_d;function _d(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.head.data:t=e.buffer.concat(e.length),e.buffer.clear()):t=gS(r,e.buffer,e.decoder),t}function gS(r,e,t){var n;return r<e.head.data.length?(n=e.head.data.slice(0,r),e.head.data=e.head.data.slice(r)):r===e.head.data.length?n=e.shift():n=t?vS(r,e):mS(r,e),n}function vS(r,e){var t=e.head,n=1,i=t.data;for(r-=i.length;t=t.next;){var s=t.data,a=r>s.length?s.length:r;if(a===s.length?i+=s:i+=s.slice(0,r),r-=a,r===0){a===s.length?(++n,t.next?e.head=t.next:e.head=e.tail=null):(e.head=t,t.data=s.slice(a));break}++n}return e.length-=n,i}function mS(r,e){var t=L.allocUnsafe(r),n=e.head,i=1;for(n.data.copy(t),r-=n.data.length;n=n.next;){var s=n.data,a=r>s.length?s.length:r;if(s.copy(t,t.length-r,0,a),r-=a,r===0){a===s.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(a));break}++i}return e.length-=i,t}function ic(r){var e=r._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,at(ES,e,r))}function ES(r,e){!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"))}function yS(r,e){for(var t=0,n=r.length;t<n;t++)e(r[t],t)}function pd(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}Ze.WritableState=Kc;Gn(Ze,Se);function IS(){}function wS(r,e,t){this.chunk=r,this.encoding=e,this.callback=t,this.next=null}function Kc(r,e){Object.defineProperty(this,"buffer",{get:fd(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),r=r||{},this.objectMode=!!r.objectMode,e instanceof kt&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var t=r.highWaterMark,n=this.objectMode?16:16*1024;this.highWaterMark=t||t===0?t:n,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(s){WS(e,s)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new md(this)}Kc.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};function Ze(r){if(!(this instanceof Ze)&&!(this instanceof kt))return new Ze(r);this._writableState=new Kc(r,this),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev)),Se.call(this)}Ze.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function AS(r,e){var t=new Error("write after end");r.emit("error",t),at(e,t)}function bS(r,e,t,n){var i=!0,s=!1;return t===null?s=new TypeError("May not write null values to stream"):!L.isBuffer(t)&&typeof t!="string"&&t!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(r.emit("error",s),at(n,s),i=!1),i}Ze.prototype.write=function(r,e,t){var n=this._writableState,i=!1;return typeof e=="function"&&(t=e,e=null),L.isBuffer(r)?e="buffer":e||(e=n.defaultEncoding),typeof t!="function"&&(t=IS),n.ended?AS(this,t):bS(this,n,r,t)&&(n.pendingcb++,i=CS(this,n,r,e,t)),i};Ze.prototype.cork=function(){var r=this._writableState;r.corked++};Ze.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.finished&&!r.bufferProcessing&&r.bufferedRequest&&Sd(this,r))};Ze.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function TS(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=L.from(e,t)),e}function CS(r,e,t,n,i){t=TS(e,t,n),L.isBuffer(t)&&(n="buffer");var s=e.objectMode?1:t.length;e.length+=s;var a=e.length<e.highWaterMark;if(a||(e.needDrain=!0),e.writing||e.corked){var o=e.lastBufferedRequest;e.lastBufferedRequest=new wS(t,n,i),o?o.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Ic(r,e,!1,s,t,n,i);return a}function Ic(r,e,t,n,i,s,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,t?r._writev(i,e.onwrite):r._write(i,s,e.onwrite),e.sync=!1}function OS(r,e,t,n,i){--e.pendingcb,t?at(i,n):i(n),r._writableState.errorEmitted=!0,r.emit("error",n)}function xS(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function WS(r,e){var t=r._writableState,n=t.sync,i=t.writecb;if(xS(t),e)OS(r,t,n,e,i);else{var s=gd(t);!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Sd(r,t),n?at(Hu,r,t,s,i):Hu(r,t,s,i)}}function Hu(r,e,t,n){t||RS(r,e),e.pendingcb--,n(),vd(r,e)}function RS(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function Sd(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var n=e.bufferedRequestCount,i=new Array(n),s=e.corkedRequestsFree;s.entry=t;for(var a=0;t;)i[a]=t,t=t.next,a+=1;Ic(r,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new md(e)}else{for(;t;){var o=t.chunk,c=t.encoding,f=t.callback,l=e.objectMode?1:o.length;if(Ic(r,e,!1,l,o,c,f),t=t.next,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=t,e.bufferProcessing=!1}Ze.prototype._write=function(r,e,t){t(new Error("not implemented"))};Ze.prototype._writev=null;Ze.prototype.end=function(r,e,t){var n=this._writableState;typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),n.corked&&(n.corked=1,this.uncork()),!n.ending&&!n.finished&&FS(this,n,t)};function gd(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function Yu(r,e){e.prefinished||(e.prefinished=!0,r.emit("prefinish"))}function vd(r,e){var t=gd(e);return t&&(e.pendingcb===0?(Yu(r,e),e.finished=!0,r.emit("finish")):Yu(r,e)),t}function FS(r,e,t){e.ending=!0,vd(r,e),t&&(e.finished?at(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function md(r){var e=this;this.next=null,this.entry=null,this.finish=function(t){var n=e.entry;for(e.entry=null;n;){var i=n.callback;r.pendingcb--,i(t),n=n.next}r.corkedRequestsFree?r.corkedRequestsFree.next=e:r.corkedRequestsFree=e}}Gn(kt,Fe);var Vu=Object.keys(Ze.prototype);for(Fs=0;Fs<Vu.length;Fs++)Ds=Vu[Fs],kt.prototype[Ds]||(kt.prototype[Ds]=Ze.prototype[Ds]);var Ds,Fs;function kt(r){if(!(this instanceof kt))return new kt(r);Fe.call(this,r),Ze.call(this,r),r&&r.readable===!1&&(this.readable=!1),r&&r.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,r&&r.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",DS)}function DS(){this.allowHalfOpen||this._writableState.ended||at(NS,this)}function NS(r){r.end()}Gn(tr,kt);function kS(r){this.afterTransform=function(e,t){return LS(r,e,t)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function LS(r,e,t){var n=r._transformState;n.transforming=!1;var i=n.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,t!=null&&r.push(t),i(e);var s=r._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&r._read(s.highWaterMark)}function tr(r){if(!(this instanceof tr))return new tr(r);kt.call(this,r),this._transformState=new kS(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(t){zu(e,t)}):zu(e)})}tr.prototype.push=function(r,e){return this._transformState.needTransform=!1,kt.prototype.push.call(this,r,e)};tr.prototype._transform=function(r,e,t){throw new Error("Not implemented")};tr.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};tr.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};function zu(r,e){if(e)return r.emit("error",e);var t=r._writableState,n=r._transformState;if(t.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}Gn(bi,tr);function bi(r){if(!(this instanceof bi))return new bi(r);tr.call(this,r)}bi.prototype._transform=function(r,e,t){t(null,r)};Gn(Sr,Se);Sr.Readable=Fe;Sr.Writable=Ze;Sr.Duplex=kt;Sr.Transform=tr;Sr.PassThrough=bi;Sr.Stream=Sr;function Sr(){Se.call(this)}Sr.prototype.pipe=function(r,e){var t=this;function n(l){r.writable&&r.write(l)===!1&&t.pause&&t.pause()}t.on("data",n);function i(){t.readable&&t.resume&&t.resume()}r.on("drain",i),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",a),t.on("close",o));var s=!1;function a(){s||(s=!0,r.end())}function o(){s||(s=!0,typeof r.destroy=="function"&&r.destroy())}function c(l){if(f(),Se.listenerCount(this,"error")===0)throw l}t.on("error",c),r.on("error",c);function f(){t.removeListener("data",n),r.removeListener("drain",i),t.removeListener("end",a),t.removeListener("close",o),t.removeListener("error",c),r.removeListener("error",c),t.removeListener("end",f),t.removeListener("close",f),r.removeListener("close",f)}return t.on("end",f),t.on("close",f),r.on("close",f),r.emit("pipe",t),r};var ju=function(r){Gr(e,r);function e(t,n,i){st(this,e);var s=$r(this,(e.__proto__||be(e)).call(this,{highWaterMark:n.highWaterMark,encoding:n.encoding}));return s._fs=i,s.bytesRead=0,s.path=t,s.fd=n.fd===void 0?null:n.fd,s.flags=n.flags===void 0?"r":n.flags,s.mode=n.mode===void 0?Tt:n.mode,s.autoClose=n.autoClose===void 0?!0:n.autoClose,s.start=n.start,s.end=n.end===void 0?1/0:n.end,s.pos=n.start,typeof s.fd!="number"&&s._open(),Qe(e.prototype.__proto__||be(e.prototype),"on",s).call(s,"end",function(){s.autoClose&&s.destroy()}),s}return ut(e,[{key:"_open",value:function(){var n=this;this._fs.open(this.path,this.flags,this.mode,function(i,s){if(i){n.autoClose&&n.destroy(),Qe(e.prototype.__proto__||be(e.prototype),"emit",n).call(n,"error",i);return}n.fd=s,Qe(e.prototype.__proto__||be(e.prototype),"emit",n).call(n,"open",s),Qe(e.prototype.__proto__||be(e.prototype),"read",n).call(n)})}},{key:"_read",value:function(n){var i=this;if(typeof this.fd!="number"){Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"open",function(){i._read(n)});return}if(!this.destroyed){if(this.pos!=null&&(n=Math.min(this.end-this.pos+1,n)),n<=0){this.push(null);return}this._fs.read(this.fd,L.allocUnsafe(n),0,n,this.pos,function(s,a,o){if(s){i.autoClose&&i.destroy(),Qe(e.prototype.__proto__||be(e.prototype),"emit",i).call(i,"error",s);return}a>0?(i.bytesRead+=a,i.push(o.slice(0,a))):i.push(null)}),this.pos!=null&&(this.pos+=n)}}},{key:"_destroy",value:function(n,i){this._close(function(s){i(n||s)})}},{key:"_close",value:function(n){var i=this;if(n&&Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"close",n),typeof this.fd!="number"){Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"open",function(){i._close()});return}if(this.closed)return at(function(){return Qe(e.prototype.__proto__||be(e.prototype),"emit",i).call(i,"close")});this.closed=!0,this._fs.close(this.fd,function(s){s?i.emit("error",s):i.emit("close")}),this.fd=null}}]),e}(Fe),Ku=function(r){Gr(e,r);function e(t,n,i){st(this,e);var s=$r(this,(e.__proto__||be(e)).call(this,{highWaterMark:n.highWaterMark}));return s._fs=i,s.bytesWritten=0,s.path=t,s.fd=n.fd===void 0?null:n.fd,s.flags=n.flags===void 0?"w":n.flags,s.mode=n.mode===void 0?Tt:n.mode,s.autoClose=n.autoClose===void 0?!0:n.autoClose,s.start=n.start,s.pos=s.start,n.encoding&&Qe(e.prototype.__proto__||be(e.prototype),"setDefaultEncoding",s).call(s,n.encoding),typeof s.fd!="number"&&s._open(),Qe(e.prototype.__proto__||be(e.prototype),"on",s).call(s,"finish",function(){s.autoClose&&s.destroy()}),s}return ut(e,[{key:"_open",value:function(){var n=this;this._fs.open(this.path,this.flags,this.mode,function(i,s){if(i){n.autoClose&&n.destroy(),Qe(e.prototype.__proto__||be(e.prototype),"emit",n).call(n,"error",i);return}n.fd=s,Qe(e.prototype.__proto__||be(e.prototype),"emit",n).call(n,"open",s)})}},{key:"_write",value:function(n,i,s){var a=this;if(typeof this.fd!="number")return Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"open",function(){a._write(n,i,s)});this._fs.write(this.fd,n,0,n.length,this.pos,function(o,c){if(o){a.autoClose&&a.destroy(),s(o);return}a.bytesWritten+=c,s()}),this.pos!==void 0&&(this.pos+=n.length)}},{key:"_writev",value:function(n,i){this._write(L.concat(n.map(function(s){return s.chunk})),void 0,i)}},{key:"_destroy",value:function(n,i){this._close(function(s){i(n||s)})}},{key:"_close",value:function(n){var i=this;if(n&&Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"close",n),typeof this.fd!="number"){Qe(e.prototype.__proto__||be(e.prototype),"once",this).call(this,"open",function(){i._close()});return}if(this.closed)return at(function(){return Qe(e.prototype.__proto__||be(e.prototype),"emit",i).call(i,"close")});this.closed=!0,this._fs.close(this.fd,function(s){s?i.emit("error",s):i.emit("close")}),this.fd=null}},{key:"_final",value:function(n){n()}}]),e}(Ze),Xu=jo.posix?jo.posix.join:jo.join,le=function(e){if(e)throw e},Xc=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:18,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new ia,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new $c(n),s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:new Hc(i);st(this,r);var a=void 0;if(typeof t=="number"){if(a=i.getINode(t),!(a instanceof xe))throw TypeError("rootIndex must point to a root directory")}else{var o=i.createINode(xe,{mode:K0,uid:Qt,gid:Sc}),c=gt(o,1);a=c[0]}this._uid=Qt,this._gid=Sc,this._umask=e,this._devMgr=n,this._iNodeMgr=i,this._fdMgr=s,this._root=a,this._cwd=new j0(i,a),this.constants=T,this.ReadStream=ju,this.WriteStream=Ku}return ut(r,[{key:"getUmask",value:function(){return this._umask}},{key:"setUmask",value:function(t){this._umask=t}},{key:"getUid",value:function(){return this._uid}},{key:"setUid",value:function(t){this._uid=t}},{key:"getGid",value:function(){return this._gid}},{key:"setGid",value:function(t){this._gid=t}},{key:"getCwd",value:function(){return this._cwd.getPath()}},{key:"chdir",value:function(t){t=this._getPath(t);var n=this._navigate(t,!0);if(!n.target)throw new W(F.ENOENT,t);if(!(n.target instanceof xe))throw new W(F.ENOTDIR,t);if(!this._checkPermissions(T.X_OK,n.target.getMetadata()))throw new W(F.EACCES,t);this._cwd.changeDir(n.target,n.pathStack)}},{key:"access",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.accessSync.bind(this),[t].concat(Re(i.slice(0,a))),o,o)}},{key:"accessSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T.F_OK;t=this._getPath(t);var i=this._navigate(t,!0).target;if(!i)throw new W(F.ENOENT,t);if(n!==T.F_OK&&!this._checkPermissions(n,i.getMetadata()))throw new W(F.EACCES,t)}},{key:"appendFile",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.appendFileSync.bind(this),[t,n].concat(Re(s.slice(0,o))),c,c)}},{key:"appendFileSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"undefined",i=arguments[2];i=this._getOptions({encoding:"utf8",mode:Tt,flag:"a"},i),n=this._getBuffer(n,i.encoding);var s=void 0;try{var a=void 0;if(typeof t=="number"){if(a=this._fdMgr.getFd(t),!a)throw new W(F.EBADF,null,null,"appendFile");if(!(a.getFlags()&(T.O_WRONLY|T.O_RDWR)))throw new W(F.EBADF,null,null,"appendFile")}else{var o=this._openSync(t,i.flag,i.mode),c=gt(o,2);a=c[0],s=c[1]}try{a.write(n,null,T.O_APPEND)}catch(f){throw f instanceof RangeError?new W(F.EFBIG,null,null,"appendFile"):f}}finally{s!==void 0&&this.closeSync(s)}}},{key:"chmod",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le;this._callAsync(this.chmodSync.bind(this),[t,n],i,i)}},{key:"chmodSync",value:function(t,n){t=this._getPath(t);var i=this._navigate(t,!0).target;if(!i)throw new W(F.ENOENT,t);if(typeof n!="number")throw new TypeError("mode must be an integer");var s=i.getMetadata();if(this._uid!==Qt&&this._uid!==s.uid)throw new W(F.EPERM,null,null,"chmod");s.mode=s.mode&T.S_IFMT|n}},{key:"chown",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.chownSync.bind(this),[t,n,i],s,s)}},{key:"chownSync",value:function(t,n,i){t=this._getPath(t);var s=this._navigate(t,!0).target;if(!s)throw new W(F.ENOENT,t);var a=s.getMetadata();if(this._uid!==Qt){if(a.uid!==this._uid)throw new W(F.EPERM,null,null,"chown");if(this._uid!==n)throw new W(F.EPERM,null,null,"chown")}typeof n=="number"&&(a.uid=n),typeof i=="number"&&(a.gid=i)}},{key:"chownr",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.chownrSync.bind(this),[t,n,i],s,s)}},{key:"chownrSync",value:function(t,n,i){var s=this;t=this._getPath(t),this.chownSync(t,n,i);var a=void 0;try{a=this.readdirSync(t)}catch(o){if(o&&o.code==="ENOTDIR")return;throw o}a.forEach(function(o){var c=Xu(t,o);s.lstatSync(c).isSymbolicLink()||s.chownrSync(c,n,i)})}},{key:"close",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.closeSync.bind(this),[t],n,n)}},{key:"closeSync",value:function(t){if(!this._fdMgr.getFd(t))throw new W(F.EBADF,null,null,"close");this._fdMgr.deleteFd(t)}},{key:"copyFile",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.copyFileSync.bind(this),[t,n].concat(Re(s.slice(0,o))),c,c)}},{key:"copyFileSync",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;t=this._getPath(t),n=this._getPath(n);var s=void 0,a=void 0,o=void 0,c=void 0;try{var f=this._openSync(t,T.O_RDONLY),l=gt(f,2);s=l[0],a=l[1];var h=s.getINode();if(h instanceof xe)throw new W(F.EBADF,t,n);var _=T.WRONLY|T.O_CREAT;i&T.COPYFILE_EXCL&&(_|=T.O_EXCL);var m=this._openSync(n,_,h.getMetadata().mode),I=gt(m,2);o=I[0],c=I[1];var b=o.getINode();if(b instanceof vt)b.setData(Uu(h.getData()));else throw new W(F.EINVAL,t,n)}finally{a!==void 0&&this.closeSync(a),c!==void 0&&this.closeSync(c)}}},{key:"createReadStream",value:function(t,n){if(t=this._getPath(t),n=this._getOptions({flags:"r",encoding:null,fd:null,mode:Tt,autoClose:!0,end:1/0},n),n.start!==void 0&&n.start>n.end)throw new RangeError("ERR_VALUE_OUT_OF_RANGE");return new ju(t,n,this)}},{key:"createWriteStream",value:function(t,n){if(t=this._getPath(t),n=this._getOptions({flags:"w",defaultEncoding:"utf8",fd:null,mode:Tt,autoClose:!0},n),n.start!==void 0&&n.start<0)throw new RangeError("ERR_VALUE_OUT_OF_RANGE");return new Ku(t,n,this)}},{key:"exists",value:function(t,n){n||(n=function(){}),this._callAsync(this.existsSync.bind(this),[t],n,n)}},{key:"existsSync",value:function(t){t=this._getPath(t);try{return!!this._navigate(t,!0).target}catch{return!1}}},{key:"fallocate",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.fallocateSync.bind(this),[t,n,i],s,s)}},{key:"fallocateSync",value:function(t,n,i){if(n<0||i<=0)throw new W(F.EINVAL,null,null,"fallocate");var s=this._fdMgr.getFd(t);if(!s)throw new W(F.EBADF,null,null,"fallocate");var a=s.getINode();if(!(a instanceof vt))throw new W(F.ENODEV,null,null,"fallocate");if(!(s.getFlags()&(T.O_WRONLY|T.O_RDWR)))throw new W(F.EBADF,null,null,"fallocate");var o=a.getData(),c=a.getMetadata();if(n+i>o.length){var f=void 0;try{f=zs(o,n+i-o.length)}catch(l){throw l instanceof RangeError?new W(F.EFBIG,null,null,"fallocate"):l}a.setData(f),c.size=f.length}c.ctime=new Date}},{key:"mmap",value:function(t,n,i){for(var s=arguments.length,a=Array(s>3?s-3:0),o=3;o<s;o++)a[o-3]=arguments[o];var c=a.findIndex(function(l){return typeof l=="function"}),f=a[c]||le;c=c>=0?c:a.length,this._callAsync(this.mmapSync.bind(this),[t,n,i].concat(Re(a.slice(0,c))),function(l){return f(null,l)},f)}},{key:"mmapSync",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t<1||s<0)throw new W(F.EINVAL,null,null,"mmap");var a=this._fdMgr.getFd(i);if(!a)throw new W(F.EBADF,null,null,"mmap");var o=a.getFlags()&T.O_ACCMODE;if(o===T.O_WRONLY)throw new W(F.EACCES,null,null,"mmap");var c=a.getINode();if(!(c instanceof vt))throw new W(F.ENODEV,null,null,"mmap");switch(n){case T.MAP_PRIVATE:return Uu(c.getData().slice(s,s+t));case T.MAP_SHARED:if(o!==T.O_RDWR)throw new W(F.EACCES,null,null,"mmap");return G0(c,"_data").slice(s,s+t);default:throw new W(F.EINVAL,null,null,"mmap")}}},{key:"fchmod",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le;this._callAsync(this.fchmodSync.bind(this),[t,n],i,i)}},{key:"fchmodSync",value:function(t,n){var i=this._fdMgr.getFd(t);if(!i)throw new W(F.EBADF,null,null,"fchmod");if(typeof n!="number")throw new TypeError("mode must be an integer");var s=i.getINode().getMetadata();if(this._uid!==Qt&&this._uid!==s.uid)throw new W(F.EPERM,null,null,"fchmod");s.mode=s.mode&T.S_IMFT|n}},{key:"fchown",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.fchmodSync.bind(this),[t,n,i],s,s)}},{key:"fchownSync",value:function(t,n,i){var s=this._fdMgr.getFd(t);if(!s)throw new W(F.EBADF,null,null,"fchown");var a=s.getINode().getMetadata();if(this._uid!==Qt){if(a.uid!==this._uid)throw new W(F.EPERM,null,null,"fchown");if(this._uid!==n)throw new W(F.EPERM,null,null,"fchown")}typeof n=="number"&&(a.uid=n),typeof i=="number"&&(a.gid=i)}},{key:"fdatasync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.fchmodSync.bind(this),[t],n,n)}},{key:"fdatasyncSync",value:function(t){if(!this._fdMgr.getFd(t))throw new W(F.EBADF,null,null,"fdatasync")}},{key:"fstat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.fstatSync.bind(this),[t],function(i){return n(null,i)},n)}},{key:"fstatSync",value:function(t){var n=this._fdMgr.getFd(t);if(!n)throw new W(F.EBADF,null,null,"fstat");return new Bs(Rn({},n.getINode().getMetadata()))}},{key:"fsync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.fsyncSync.bind(this),[t],n,n)}},{key:"fsyncSync",value:function(t){if(!this._fdMgr.getFd(t))throw new W(F.EBADF,null,null,"fsync")}},{key:"ftruncate",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.ftruncateSync.bind(this),[t].concat(Re(i.slice(0,a))),o,o)}},{key:"ftruncateSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(n<0)throw new W(F.EINVAL,null,null,"ftruncate");var i=this._fdMgr.getFd(t);if(!i)throw new W(F.EBADF,null,null,"ftruncate");var s=i.getINode();if(!(s instanceof vt))throw new W(F.EINVAL,null,null,"ftruncate");if(!(i.getFlags()&(T.O_WRONLY|T.O_RDWR)))throw new W(F.EINVAL,null,null,"ftruncate");var a=s.getData(),o=s.getMetadata(),c=void 0;try{n>a.length?(c=zs(a,n),s.setData(c)):n<a.length?(a.resize(n),s.setData(c)):c=a}catch(l){throw l instanceof RangeError?new W(F.EFBIG,null,null,"ftruncate"):l}var f=new Date;o.mtime=f,o.ctime=f,o.size=c.length,i.setPos(Math.min(c.length,i.getPos()))}},{key:"futimes",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.futimesSync.bind(this),[t,n,i],s,s)}},{key:"futimesSync",value:function(t,n,i){var s=this._fdMgr.getFd(t);if(!s)throw new W(F.EBADF,null,null,"futimes");var a=s.getINode().getMetadata(),o=void 0,c=void 0;if(typeof n=="number")o=new Date(n*1e3);else if(typeof n=="string")o=new Date(parseInt(n)*1e3);else if(n instanceof Date)o=n;else throw TypeError("atime and mtime must be dates or unixtime in seconds");if(typeof i=="number")c=new Date(i*1e3);else if(typeof i=="string")c=new Date(parseInt(i)*1e3);else if(i instanceof Date)c=i;else throw TypeError("atime and mtime must be dates or unixtime in seconds");a.atime=o,a.mtime=c,a.ctime=new Date}},{key:"lchmod",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le;this._callAsync(this.lchmodSync.bind(this),[t,n],i,i)}},{key:"lchmodSync",value:function(t,n){t=this._getPath(t);var i=this._navigate(t,!1).target;if(!i)throw new W(F.ENOENT,t);if(typeof n!="number")throw new TypeError("mode must be an integer");var s=i.getMetadata();if(this._uid!==Qt&&this._uid!==s.uid)throw new W(F.EPERM,null,null,"lchmod");s.mode=s.mode&T.S_IFMT|n}},{key:"lchown",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.lchownSync.bind(this),[t,n,i],s,s)}},{key:"lchownSync",value:function(t,n,i){t=this._getPath(t);var s=this._navigate(t,!1).target;if(!s)throw new W(F.ENOENT,t);var a=s.getMetadata();if(this._uid!==Qt){if(a.uid!==this._uid)throw new W(F.EPERM,null,null,"lchown");if(this._uid!==n)throw new W(F.EPERM,null,null,"lchown")}typeof n=="number"&&(a.uid=n),typeof i=="number"&&(a.gid=i)}},{key:"link",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le;this._callAsync(this.linkSync.bind(this),[t,n],i,i)}},{key:"linkSync",value:function(t,n){t=this._getPath(t),n=this._getPath(n);var i=void 0,s=void 0;if(i=this._navigate(t,!1),s=this._navigate(n,!1),!i.target)throw new W(F.ENOENT,t,n,"link");if(i.target instanceof xe)throw new W(F.EPERM,t,n,"link");if(s.target)throw new W(F.EEXIST,t,n,"link");if(s.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t,n,"link");if(!this._checkPermissions(T.W_OK,s.dir.getMetadata()))throw new W(F.EACCES,t,n,"link");var a=i.dir.getEntryIndex(i.name);s.dir.addEntry(s.name,a),i.target.getMetadata().ctime=new Date}},{key:"lseek",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.lseekSync.bind(this),[t,n].concat(Re(s.slice(0,o))),c,c)}},{key:"lseekSync",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T.SEEK_SET,s=this._fdMgr.getFd(t);if(!s)throw new W(F.EBADF,null,null,"lseek");if([T.SEEK_SET,T.SEEK_CUR,T.SEEK_END].indexOf(i)===-1)throw new W(F.EINVAL,null,null,"lseek");try{s.setPos(n,i)}catch(a){throw a instanceof W&&a.setSyscall("lseek"),a}}},{key:"lstat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.lstatSync.bind(this),[t],function(i){return n(null,i)},n)}},{key:"lstatSync",value:function(t){t=this._getPath(t);var n=this._navigate(t,!1).target;if(n)return new Bs(Rn({},n.getMetadata()));throw new W(F.ENOENT,t)}},{key:"mkdir",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.mkdirSync.bind(this),[t].concat(Re(i.slice(0,a))),o,o)}},{key:"mkdirSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gs;t=this._getPath(t),t=t.replace(/(.+?)\/+$/,"$1");var i=this._navigate(t,!0);if(i.target)throw new W(F.EEXIST,t,null,"mkdir");if(!i.target&&i.remaining)throw new W(F.ENOENT,t,null,"mkdir");if(!i.target){if(i.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t,null,"mkdir");if(!this._checkPermissions(T.W_OK,i.dir.getMetadata()))throw new W(F.EACCES,t,null,"mkdir");var s=this._iNodeMgr.createINode(xe,{mode:vi(n,this._umask),uid:this._uid,gid:this._gid,parent:i.dir.getEntryIndex(".")}),a=gt(s,2),o=a[1];i.dir.addEntry(i.name,o)}}},{key:"mkdirp",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.mkdirpSync.bind(this),[t].concat(Re(i.slice(0,a))),o,o)}},{key:"mkdirpSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gs;t=this._getPath(t),t=t.replace(/(.+?)\/+$/,"$1");for(var i=void 0,s=void 0,a=void 0,o=this._navigate(t,!0);;)if(o.target){if(o.target instanceof xe)break;throw new W(F.ENOTDIR,t)}else{if(o.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t);if(!this._checkPermissions(T.W_OK,o.dir.getMetadata()))throw new W(F.EACCES,t);var c=this._iNodeMgr.createINode(xe,{mode:vi(n,this._umask),uid:this._uid,gid:this._gid,parent:o.dir.getEntryIndex(".")}),f=gt(c,2);if(i=f[0],s=f[1],o.dir.addEntry(o.name,s),o.remaining)a=i,o=this._navigateFrom(a,o.remaining,!0);else break}}},{key:"mkdtemp",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.mkdtempSync.bind(this),[t].concat(Re(i.slice(0,a))),function(c){return o(null,c)},o)}},{key:"mknod",value:function(t,n,i,s){for(var a=arguments.length,o=Array(a>4?a-4:0),c=4;c<a;c++)o[c-4]=arguments[c];var f=o.findIndex(function(h){return typeof h=="function"}),l=o[f]||le;f=f>=0?f:o.length,this._callAsync(this.mknodSync.bind(this),[t,n,i,s].concat(Re(o.slice(0,f))),l,l)}},{key:"mknodSync",value:function(t,n,i,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Tt;t=this._getPath(t);var o=this._navigate(t,!1);if(o.target)throw new W(F.EEXIST,t,null,"mknod");if(o.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t,null,"mknod");if(!this._checkPermissions(T.W_OK,o.dir.getMetadata()))throw new W(F.EACCES,t,null,"mknod");var c=void 0;switch(n){case T.S_IFREG:var f=this._iNodeMgr.createINode(vt,{mode:vi(a,this._umask),uid:this._uid,gid:this._gid}),l=gt(f,2);c=l[1];break;case T.S_IFCHR:if(typeof i!="number"||typeof s!="number")throw TypeError("major and minor must set as numbers when creating device nodes");if(i>ed||s>td||s<gc||s<vc)throw new W(F.EINVAL,t,null,"mknod");var h=this._iNodeMgr.createINode(jt,{mode:vi(a,this._umask),uid:this._uid,gid:this._gid,rdev:vr(i,s)}),_=gt(h,2);c=_[1];break;default:throw new W(F.EPERM,t,null,"mknod")}o.dir.addEntry(o.name,c)}},{key:"open",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.openSync.bind(this),[t,n].concat(Re(s.slice(0,o))),function(f){return c(null,f)},c)}},{key:"openSync",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tt;return this._openSync(t,n,i)[1]}},{key:"_openSync",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tt;if(t=this._getPath(t),typeof n=="string")switch(n){case"r":case"rs":n=T.O_RDONLY;break;case"r+":case"rs+":n=T.O_RDWR;break;case"w":n=T.O_WRONLY|T.O_CREAT|T.O_TRUNC;break;case"wx":n=T.O_WRONLY|T.O_CREAT|T.O_TRUNC|T.O_EXCL;break;case"w+":n=T.O_RDWR|T.O_CREAT|T.O_TRUNC;break;case"wx+":n=T.O_RDWR|T.O_CREAT|T.O_TRUNC|T.O_EXCL;break;case"a":n=T.O_WRONLY|T.O_APPEND|T.O_CREAT;break;case"ax":n=T.O_WRONLY|T.O_APPEND|T.O_CREAT|T.O_EXCL;break;case"a+":n=T.O_RDWR|T.O_APPEND|T.O_CREAT;break;case"ax+":n=T.O_RDWR|T.O_APPEND|T.O_CREAT|T.O_EXCL;break;default:throw new TypeError("Unknown file open flag: "+n)}if(typeof n!="number")throw new TypeError("Unknown file open flag: "+n);var s=this._navigate(t,!1);if(s.target instanceof kn){if(n&T.O_NOFOLLOW)throw new W(F.ELOOP,t,null,"open");s=this._navigateFrom(s.dir,s.name+s.remaining,!0,void 0,void 0,t)}var a=s.target;if(a){if(n&T.O_CREAT&&n&T.O_EXCL)throw new W(F.EEXIST,t,null,"open");if(a instanceof xe&&n&(T.O_WRONLY|n&T.O_RDWR))throw new W(F.EISDIR,t,null,"open");if(n&T.O_DIRECTORY&&!(a instanceof xe))throw new W(F.ENOTDIR,t,null,"open");n&T.O_TRUNC&&a instanceof vt&&n&(T.O_WRONLY|T.O_RDWR)&&a.setData(new ArrayBuffer(0));var l=void 0;if(n&T.O_RDWR?l=T.R_OK|T.W_OK:n&T.O_WRONLY?l=T.W_OK:l=T.R_OK,!this._checkPermissions(l,a.getMetadata()))throw new W(F.EACCES,t,null,"open")}else if(!s.remaining&&n&T.O_CREAT){if(s.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t,null,"open");if(!this._checkPermissions(T.W_OK,s.dir.getMetadata()))throw new W(F.EACCES,t,null,"open");var o=void 0,c=this._iNodeMgr.createINode(vt,{mode:vi(i,this._umask),uid:this._uid,gid:this._gid}),f=gt(c,2);a=f[0],o=f[1],s.dir.addEntry(s.name,o)}else throw new W(F.ENOENT,t,null,"open");try{var h=this._fdMgr.createFd(a,n);return h}catch(_){throw _ instanceof W&&(_.setPaths(t),_.setSyscall("open")),_}}},{key:"read",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.readSync.bind(this),[t,n].concat(Re(s.slice(0,o))),function(f){return c(null,f,n)},c)}},{key:"readSync",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,o=this._fdMgr.getFd(t);if(!o)throw new W(F.EBADF,null,null,"read");if(typeof a=="number"&&a<0)throw new W(F.EINVAL,null,null,"read");if(o.getINode().getMetadata().isDirectory())throw new W(F.EISDIR,null,null,"read");var c=o.getFlags();if(c&T.O_WRONLY)throw new W(F.EBADF,null,null,"read");if(i<0||i>n.length)throw new RangeError("Offset is out of bounds");if(s<0||s>n.length)throw new RangeError("Length extends beyond buffer");n=this._getBuffer(n).slice(i,i+s);var f=void 0;try{f=o.read(n,a)}catch(l){throw l instanceof W&&(l.syscall="read"),l}return f}},{key:"readdir",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.readdirSync.bind(this),[t].concat(Re(i.slice(0,a))),function(c){return o(null,c)},o)}},{key:"readFile",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.readFileSync.bind(this),[t].concat(Re(i.slice(0,a))),function(c){return o(null,c)},o)}},{key:"readFileSync",value:function(t,n){n=this._getOptions({encoding:null,flag:"r"},n);var i=void 0;try{var s=new ArrayBuffer(4096),a=new ArrayBuffer(0),o=null;if(typeof t=="number")for(;o!==0;)o=this.readSync(t,s,0,s.length),a=mc(a,s.slice(0,o));else for(i=this.openSync(t,n.flag);o!==0;)o=this.readSync(i,s,0,s.length),a=mc(a,s.slice(0,o));return n.encoding?a.toString(n.encoding):a}finally{i!==void 0&&this.closeSync(i)}}},{key:"readlink",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.readlinkSync.bind(this),[t].concat(Re(i.slice(0,a))),function(c){return o(null,c)},o)}},{key:"rename",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:le;this._callAsync(this.renameSync.bind(this),[t,n],i,i)}},{key:"renameSync",value:function(t,n){t=this._getPath(t),n=this._getPath(n);var i=this._navigate(t,!1),s=this._navigate(n,!1);if(!i.target)throw new W(F.ENOENT,t,n,"rename");if(i.target instanceof xe){if(s.target&&!(s.target instanceof xe))throw new W(F.ENOTDIR,t,n,"rename");if(i.target===this._root||s.target===this._root)throw new W(F.EBUSY,t,n,"rename");if(s.target&&[].concat(Re(s.target.getEntries())).length-2)throw new W(F.ENOTEMPTY,t,n,"rename");if(i.name==="."||i.name===".."||s.name==="."||s.name==="..")throw new W(F.EBUSY,t,n,"rename");if(i.pathStack.length<s.pathStack.length){for(var a=!0,o=0;o<i.pathStack.length;++o)if(i.pathStack[o]!==s.pathStack[o]){a=!1;break}if(a)throw new W(F.EINVAL,t,n,"rename")}}else if(s.target&&s.target instanceof xe)throw new W(F.EISDIR,t,n,"rename");if(!this._checkPermissions(T.W_OK,i.dir.getMetadata())||!this._checkPermissions(T.W_OK,s.dir.getMetadata()))throw new W(F.EACCES,t,n,"rename");if(i.dir===s.dir){i.dir.renameEntry(i.name,s.name);return}var c=i.dir.getEntryIndex(i.name);if(s.target)s.target.getMetadata().ctime=new Date,s.dir.deleteEntry(s.name),s.dir.addEntry(s.name,c);else{if(s.dir.getMetadata().nlink<2)throw new W(F.ENOENT,t,n,"rename");s.dir.addEntry(s.name,c)}i.target.getMetadata().ctime=new Date,i.dir.deleteEntry(i.name)}},{key:"rmdir",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.rmdirSync.bind(this),[t],n,n)}},{key:"rmdirSync",value:function(t){t=this._getPath(t),t=t.replace(/(.+?)\/+$/,"$1");var n=this._navigate(t,!1);if(!n.name)throw new W(F.EBUSY,t,null,"rmdir");if(n.name==="."||n.name==="..")throw new W(F.EINVAL,t,null,"rmdir");if(!n.target)throw new W(F.ENOENT,t,null,"rmdir");if(!(n.target instanceof xe))throw new W(F.ENOTDIR,t,null,"rmdir");if([].concat(Re(n.target.getEntries())).length-2)throw new W(F.ENOTEMPTY,t,null,"rmdir");if(!this._checkPermissions(T.W_OK,n.dir.getMetadata()))throw new W(F.EACCES,t,null,"rmdir");n.dir.deleteEntry(n.name)}},{key:"stat",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.statSync.bind(this),[t],function(i){return n(null,i)},n)}},{key:"statSync",value:function(t){t=this._getPath(t);var n=this._navigate(t,!0).target;if(n)return new Bs(Rn({},n.getMetadata()));throw new W(F.ENOENT,t)}},{key:"symlink",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.symlinkSync.bind(this),[t,n].concat(Re(s.slice(0,o))),c,c)}},{key:"symlinkSync",value:function(t,n){if(t=this._getPath(t),n=this._getPath(n),!t)throw new W(F.ENOENT,n,t,"symlink");var i=this._navigate(n,!1);if(i.target)throw new W(F.EEXIST,n,t,"symlink");if(i.dir.getMetadata().nlink<2)throw new W(F.ENOENT,n,t,"symlink");if(!this._checkPermissions(T.W_OK,i.dir.getMetadata()))throw new W(F.EACCES,n,t,"symlink");var s=this._iNodeMgr.createINode(kn,{mode:Pc,uid:this._uid,gid:this._gid,link:t}),a=gt(s,2),o=a[1];i.dir.addEntry(i.name,o)}},{key:"truncate",value:function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];var a=i.findIndex(function(c){return typeof c=="function"}),o=i[a]||le;a=a>=0?a:i.length,this._callAsync(this.truncateSync.bind(this),[t].concat(Re(i.slice(0,a))),o,o)}},{key:"truncateSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(n<0)throw new W(F.EINVAL,null,null,"ftruncate");if(typeof t=="number")this.ftruncateSync(t,n);else{t=this._getPath(t);var i=void 0;try{i=this.openSync(t,T.O_WRONLY),this.ftruncateSync(i,n)}finally{i!==void 0&&this.closeSync(i)}}}},{key:"unlink",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:le;this._callAsync(this.unlinkSync.bind(this),[t],n,n)}},{key:"unlinkSync",value:function(t){t=this._getPath(t);var n=this._navigate(t,!1);if(!n.target)throw new W(F.ENOENT,t);if(!this._checkPermissions(T.W_OK,n.dir.getMetadata()))throw new W(F.EACCES,t);if(n.target instanceof xe)throw new W(F.EISDIR,t);n.target.getMetadata().ctime=new Date,n.dir.deleteEntry(n.name)}},{key:"utimes",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:le;this._callAsync(this.utimesSync.bind(this),[t,n,i],s,s)}},{key:"utimesSync",value:function(t,n,i){t=this._getPath(t);var s=this._navigate(t,!0).target;if(!s)throw new W(F.ENOENT,t,null,"utimes");var a=s.getMetadata(),o=void 0,c=void 0;if(typeof n=="number")o=new Date(n*1e3);else if(typeof n=="string")o=new Date(parseInt(n)*1e3);else if(n instanceof Date)o=n;else throw TypeError("atime and mtime must be dates or unixtime in seconds");if(typeof i=="number")c=new Date(i*1e3);else if(typeof i=="string")c=new Date(parseInt(i)*1e3);else if(i instanceof Date)c=i;else throw TypeError("atime and mtime must be dates or unixtime in seconds");a.atime=o,a.mtime=c,a.ctime=new Date}},{key:"write",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.writeSync.bind(this),[t,n].concat(Re(s.slice(0,o))),function(f){return c(null,f,n)},c)}},{key:"writeSync",value:function(t,n,i,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,o=this._fdMgr.getFd(t);if(!o)throw new W(F.EBADF,null,null,"write");if(typeof a=="number"&&a<0)throw new W(F.EINVAL,null,null,"write");var c=o.getFlags();if(!(c&(T.O_WRONLY|T.O_RDWR)))throw new W(F.EBADF,null,null,"write");var f=void 0;if(typeof n=="string")a=typeof i=="number"?i:null,s=typeof s=="string"?s:"utf8",f=this._getBuffer(n,s);else{if(i=typeof i=="number"?i:0,i<0||i>n.length)throw new RangeError("Offset is out of bounds");if(s=typeof s=="number"?s:n.length,s<0||s>n.length)throw new RangeError("Length is out of bounds");f=this._getBuffer(n).slice(i,i+s)}try{return o.write(f,a)}catch(l){throw l instanceof RangeError?new W(F.EFBIG,null,null,"write"):(l instanceof W&&l.setSyscall("write"),l)}}},{key:"writeFile",value:function(t,n){for(var i=arguments.length,s=Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];var o=s.findIndex(function(f){return typeof f=="function"}),c=s[o]||le;o=o>=0?o:s.length,this._callAsync(this.writeFileSync.bind(this),[t,n].concat(Re(s.slice(0,o))),c,c)}},{key:"writeFileSync",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"undefined",i=arguments[2];i=this._getOptions({encoding:"utf8",mode:Tt,flag:"w"},i);var s=void 0;try{var a=this._getBuffer(n,i.encoding);typeof t=="number"?this.writeSync(t,a,0,a.length,0):(s=this.openSync(t,i.flag,i.mode),this.writeSync(s,a,0,a.length,0))}finally{s!==void 0&&this.closeSync(s)}}},{key:"_callAsync",value:function(t,n,i,s){at(function(){try{var a=t.apply(void 0,Re(n));a=a===void 0?null:a,i(a)}catch(o){s(o)}})}},{key:"_getPath",value:function(t){if(typeof t=="string")return t;if(t instanceof ArrayBuffer)return new TextDecoder().decode(t);if((typeof t>"u"?"undefined":P_(t))==="object"&&typeof t.pathname=="string")return this._getPathFromURL(t);throw new TypeError("path must be a string or Buffer or URL")}},{key:"_getPathFromURL",value:function(t){if(t.hostname)throw new TypeError("ERR_INVALID_FILE_URL_HOST");var n=t.pathname;if(n.match(/%2[fF]/))throw new TypeError("ERR_INVALID_FILE_URL_PATH");return decodeURIComponent(n)}},{key:"_getOptions",value:function(t,n){return typeof n=="string"?Rn({},t,{encoding:n}):Rn({},t,n)}},{key:"_checkPermissions",value:function(t,n){return this._uid!==Qt?q0(t,this._uid,this._gid,n):!0}},{key:"_parsePath",value:function(t){var n=t.match(/^([\s\S]*?)(?:\/+|$)([\s\S]*)/);if(n){var i=n[1]||"",s=n[2]||"";return{segment:i,rest:s}}else throw new Error("Could not parse pathS: "+t)}},{key:"_navigate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;if(t===void 0)throw new W(F.ENOENT,i);return t=t.replace(/\/+/,"/"),t=t.replace(/\/$/,"/."),t[0]==="/"||t===""?(t=t.substring(1),t?this._navigateFrom(this._root,t,n,[],i):{dir:this._root,target:this._root,name:"",remaining:"",pathStack:[]}):this._navigateFrom(this._cwd.getINode(),t,n,this._cwd.getPathStack(),i)}},{key:"_navigateFrom",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:n;if(!n)throw new W(F.ENOENT,a);if(!this._checkPermissions(T.X_OK,t.getMetadata()))throw new W(F.EACCES,a);var o=this._parsePath(n);o.segment!=="."&&(o.segment===".."?s.pop():s.push(o.segment));var c=void 0,f=void 0,l=t.getEntry(o.segment);if(l instanceof vt||l instanceof jt){if(!o.rest)return{dir:t,target:l,name:o.segment,remaining:"",pathStack:s};throw new W(F.ENOTDIR,a)}else if(l instanceof xe){if(!o.rest)return{dir:t,target:l,name:o.segment,remaining:"",pathStack:s};c=l,f=o.rest}else if(l instanceof kn){if(!i)return{dir:t,target:l,name:o.segment,remaining:o.rest,pathStack:s};if(f=Xu(l.getLink(),o.rest),f[0]==="/")return this._navigate(f,i,a);s.pop(),c=t}else return{dir:t,target:null,name:o.segment,remaining:o.rest,pathStack:s};return this._navigateFrom(c,f,i,s,a)}}]),r}(),BS={setPos:function(e,t,n){e._pos=0},read:function(e,t,n){return 0},write:function(e,t,n,i){return t.length}},US={setPos:function(e,t,n){e._pos=0},read:function(e,t,n){return t.fill(0),t.length},write:function(e,t,n,i){return t.length}},PS={setPos:function(e,t,n){e._pos=0},read:function(e,t,n){return t.fill(0),t.length},write:function(e,t,n,i){throw new W(F.ENOSPC)}},Ei;typeof window<"u"?Ei=window:typeof ln<"u"?Ei=ln:typeof self<"u"?Ei=self:Ei={};var Wn=Ei,Ed={},qu=Object.freeze({default:Ed}),Ju=qu&&Ed||qu;function MS(r){if(Wn.crypto&&Wn.crypto.getRandomValues)return Wn.crypto.getRandomValues(r);if(typeof Wn.msCrypto=="object"&&typeof Wn.msCrypto.getRandomValues=="function")return Wn.msCrypto.getRandomValues(r);if(Ju.randomBytes){if(!(r instanceof Uint8Array))throw new TypeError("expected Uint8Array");if(r.length>65536){var e=new Error;throw e.code=22,e.message="Failed to execute 'getRandomValues' on 'Crypto': The ArrayBufferView's byte length ("+r.length+") exceeds the number of bytes of entropy available via this API (65536).",e.name="QuotaExceededError",e}var t=Ju.randomBytes(r.length);return r.set(t),r}else throw new Error("No secure random number generator available.")}var $S=MS;function GS(){var r=new Uint8Array(1);return $S(r),r[0]}var HS=GS;function YS(r){for(var e="",t=0;t<r;t++)e+=String.fromCharCode(HS());return e}var VS=YS,yd={setPos:function(e,t,n){e._pos=0},read:function(e,t,n){var i=L.from(VS(t.length),"ascii");return i.copy(t),i.length},write:function(e,t,n,i){return t.length}},Hn=new ia;Hn.registerChr(BS,1,3);Hn.registerChr(US,1,5);Hn.registerChr(PS,1,7);Hn.registerChr(yd,1,8);Hn.registerChr(yd,1,9);var ot=new Xc(void 0,void 0,Hn);ot.mkdirSync("/dev");ot.chmodSync("/dev",509);ot.mknodSync("/dev/null",T.S_IFCHR,1,3);ot.mknodSync("/dev/zero",T.S_IFCHR,1,5);ot.mknodSync("/dev/full",T.S_IFCHR,1,7);ot.mknodSync("/dev/random",T.S_IFCHR,1,8);ot.mknodSync("/dev/urandom",T.S_IFCHR,1,9);ot.chmodSync("/dev/null",438);ot.chmodSync("/dev/zero",438);ot.chmodSync("/dev/full",438);ot.chmodSync("/dev/random",438);ot.chmodSync("/dev/urandom",438);ot.mkdirSync("/tmp");ot.chmodSync("/tmp",511);ot.mkdirSync("/root");ot.chmodSync("/root",448);function Qc(r){switch(r.mode&T.S_IFMT){case T.S_IFREG:return 4;case T.S_IFDIR:return 3;case T.S_IFBLK:return 1;case T.S_IFCHR:return 2;case T.S_IFLNK:return 7;case T.S_IFSOCK:return 6;default:return 0}}function Ni(r){return{dev:BigInt(r.dev),ino:BigInt(r.ino),nlink:BigInt(r.nlink),filetype:Qc(r),size:BigInt(r.size),atim:BigInt(r.atime),mtim:BigInt(r.mtime),ctim:BigInt(r.ctime)}}var Yn=class{virtualFs;constructor(){let e=new ia,t=new $c(e),[n,i]=t.createINode(xe,{}),s=new Hc(t);this.virtualFs=new Xc(18,i,e,t,s)}fsname(){return"VirtualFilesystem"}async mkdirat(e,t){let n,i;if(e===void 0)n=this.virtualFs._navigate(t,!1);else if(e instanceof Bt)i=e,n=this.virtualFs._navigateFrom(i.dir,t,!1);else return 28;if(n.target)return 20;let[s,a]=this.virtualFs._iNodeMgr.createINode(xe,{mode:Gs,uid:0,gid:0,parent:n.dir._dir["."]});return n.dir.addEntry(t,a),0}async getFilestat(e){try{let t=this.virtualFs.statSync(e);return{err:0,filestat:Ni(t)}}catch(t){return t.errno}}async unlinkat(e,t,n){try{let i;if(e===void 0)i=this.virtualFs._navigate(t,!1);else if(e instanceof Bt)i=this.virtualFs._navigateFrom(e.dir,t,!1);else return 28;if(!i.target)return 44;if(n)i.target instanceof xe;else if(i instanceof xe)return 31;return i.dir.deleteEntry(i.name),0}catch(i){return i.errno}}async open(e,t,n,i,s,a,o){let c=this.virtualFs._navigate(e,!1);if(c.target){let f,l;c.remaining?(f=54,l=e.length-c.remaining.length-1):(l=-1,n&Ye&&n&Qr?f=20:f=0);let h;return c.target instanceof xe?h=new Bt(a,i,s,c.target,this.virtualFs._iNodeMgr):(c.target instanceof vt||c.target instanceof kn)&&!(n&nt)?h=new ca(a,i,s,this.virtualFs._fdMgr.createFd(c.target,T.O_RDWR)[0]):(h=new Bt(a,i,s,c.dir,this.virtualFs._iNodeMgr),n&nt?f=54:c.target instanceof jt&&(f=43)),{err:f,index:l,desc:h}}else if(n&Ye){let[f,l]=this.virtualFs._iNodeMgr.createINode(vt,{mode:Tt,uid:0,gid:0});c.dir.addEntry(c.name,l);let[h,_]=this.virtualFs._fdMgr.createFd(f,T.O_RDWR);return{err:0,index:-1,desc:new ca(a,i,s,h)}}else return{err:44,index:-1,desc:new Bt(a,i,s,c.dir,this.virtualFs._iNodeMgr)}}async renameat(e,t,n,i){let s,a;if(e===void 0)s=this.virtualFs._navigate(t,!1);else if(e instanceof Bt)a=e,s=this.virtualFs._navigateFrom(a.dir,t,!1);else return 28;let o,c;if(n===void 0)o=this.virtualFs._navigate(i,!1);else if(n instanceof Bt)c=n,o=this.virtualFs._navigateFrom(c.dir,i,!1);else return 28;if(!s.target)return 44;if(o.target)return 20;if(o.remaining.length!==0)return 44;let f=s.dir.getEntryIndex(s.name);return o.dir.addEntry(o.name,f),s.dir.deleteEntry(s.name,f),0}async symlinkat(e,t,n){let i,s;if(t===void 0)i=this.virtualFs._navigate(n,!1);else if(t instanceof Bt)s=t,i=this.virtualFs._navigateFrom(s.dir,n,!1);else return 28;if(i.target)return 20;let[a,o]=this.virtualFs._iNodeMgr.createINode(kn,{mode:Pc,uid:0,gid:0,link:e});return s.dir.addEntry(i.name,o),0}async initialize(e){return 0}async mknodat(e,t,n,i){return 28}};function Id(r,e,t,n,i){r.fdstat={fs_flags:e,fs_rights_base:t,fs_rights_inheriting:n,fs_filetype:Qc(i)}}var Jc=class extends WritableStream{constructor(e){super({async write(t){await e.write(t.buffer),new WritableStream}})}},ca=class extends Cr{desc;cursor;constructor(e,t,n,i){super(),this.desc=i,Id(this,e,t,n,i._iNode.getMetadata()),e&1&&this.fdstat.fs_filetype!==7?this.cursor=i._iNode._data.byteLength:this.cursor=0}async arrayBuffer(){return{err:0,buffer:this.desc._iNode._data}}async pread(e,t){return{err:0,buffer:this.desc._iNode._data.slice(Number(t),e+Number(t))}}async read(e){let t=this.desc._iNode._data.slice(this.cursor,this.cursor+e);return this.cursor+=t.byteLength,{err:0,buffer:t}}async read_str(){let e;return this.fdstat.fs_filetype===4?new TextDecoder().decode(e=this.desc._iNode._data):e=this.desc._iNode._link,{err:0,content:e}}async write(e){try{let t=await this.desc._iNode.write(e,this.cursor);return this.cursor+=t,{err:0,written:t}}catch(t){return{err:t.errno,written:0n}}}async pwrite(e,t){try{return{err:0,written:await this.desc._iNode.write(e,Number(t))}}catch(n){return n.errno}}async seek(e,t){let n;switch(this.fdstat.fs_filetype===7?n=BigInt((await this.desc._iNode._link).length):n=BigInt((await this.desc._iNode._data).byteLength),t){case Tr:if(this.cursor+Number(e)<0n)return{offset:BigInt(this.cursor),err:28};this.cursor+=Number(e);break;case Tn:if(e<0n)return{offset:BigInt(this.cursor),err:28};this.cursor=Number(e);break;case Cn:if(n<-e)return{offset:BigInt(this.cursor),err:28};this.cursor=Number(n+e);break;default:return{offset:BigInt(this.cursor),err:28}}return{err:0,offset:BigInt(this.cursor)}}async truncate(e){try{return this.desc._iNode._data.resize(Number(e)),0}catch(t){return t.errno}}async writableStream(){try{return{err:0,stream:new Jc(this)}}catch(e){return e.errno}}async getFilestat(){return{err:0,filestat:Ni(this.desc._iNode.getMetadata())}}async setFilestatTimes(e,t){return t!==void 0&&(this.desc._iNode._metadata.mtime=t),e!==void 0&&(this.desc._iNode._metadata.atime=e),0}async close(){return 0}addPollSub(e,t,n){return Promise.resolve({userdata:e,eventType:t,error:0,nbytes:BigInt(this.desc._iNode._data.byteLength)})}},Bt=class extends Or{dir;inodeMgr;dirents;constructor(e,t,n,i,s){super(),this.dir=i,this.inodeMgr=s,Id(this,e,t,n,i.getMetadata()),this.dirents=void 0}async readdir(e){try{return(this.dirents===void 0||e)&&(this.dirents=Array.from(this.dir._dir).filter(([t,n])=>t!=="."&&t!=="..").map(([t,n],i)=>({d_next:BigInt(i+1),d_ino:BigInt(n),name:t,d_type:Qc(this.inodeMgr.getINode(n).getMetadata())}))),{err:0,dirents:this.dirents}}catch(t){return{err:t.errno,dirents:[]}}}async getFilestat(){return{err:0,filestat:Ni(this.dir.getMetadata())}}async setFilestatTimes(e,t){return t!==void 0&&(this.dir._metadata.mtime=t),e!==void 0&&(this.dir._metadata.atime=e),0}};var ki=class extends Yn{driverManager;async initialize(e){let t=e;return this.driverManager=t.driverManager,0}fsname(){return"DeviceFilesystem"}async mknodat(e,t,n,i){let s,a;if(e===void 0)s=this.virtualFs._navigate(t,!1);else if(e instanceof Bt)a=e,s=this.virtualFs._navigateFrom(a.dir,t,!1);else return 28;if(s.target)return 20;let[o,c]=this.virtualFs._iNodeMgr.createINode(jt,{mode:Tt,uid:0,gid:0,rdev:n,parent:s.dir._dir["."]});s.dir.addEntry(t,c);let[f,l]=sa(n);return this.driverManager.getDriver(f).initDevice(l,i),0}async open(e,t,n,i,s,a,o){let c=await super.open(e,t,n,i,s,a,o);if(c.err!==43)return c;let f=this.virtualFs._navigateFrom(c.desc.dir,Ve(e),!1),[l,h]=sa(f.target._metadata.rdev),_=this.driverManager.getDriver(l),{err:m,desc:I}=await _.getDesc(h,a,i,s,f.target);return m!==0?c:{err:0,index:-1,desc:I}}},mr=class extends On{ino;constructor(e,t,n,i){super(e,t,n),this.ino=i}async getFilestat(){return{err:0,filestat:Ni(this.ino._metadata)}}};async function wd(r,e,t){let n=new ki;return await r.initialize(e),await n.initialize({driverManager:r}),await n.mknodat(void 0,"null",vr(0,0),{}),await n.mknodat(void 0,"zero",vr(0,1),{}),await n.mknodat(void 0,"urandom",vr(0,2),{}),await n.mknodat(void 0,"ttyH0",vr(1,0),t),await n.mknodat(void 0,"wget0",vr(2,0),{devfs:n}),n}var qS=40,JS={fsa:xn,vfs:Yn,devfs:ki};async function Zc(r,e){let t=JS[r];if(t){let n=new t;return{err:await n.initialize(e),filesystem:n}}return{err:28,filesystem:void 0}}var ua=class{mounts;constructor(){this.mounts={}}abspath(e,t){if(e!==void 0&&!t.startsWith("/")){let n=e.getPath();return t.length===0?n:`${n==="/"?"":n}/${t}`}return t}async getDescInfo(e,t,n=0,i=0,s=Be,a=Be,o=0,c=qS){let f=ou(e),l,h;for(l=f.length;l>0;l=f.lastIndexOf("/",l-1)){let b=f.slice(0,l);if(h=this.mounts[b],h!==void 0)break}if(h===void 0&&(h=this.mounts["/"]),h===void 0)throw new Error("No filesystem mounted at root");let{err:_,index:m,desc:I}=await h.open(f.slice(l),n,i,s,a,o,t);if(I){let b=m>-1?f.slice(0,l+m):f;if(await I.initialize(b)!==0)return{desc:void 0,err:56,fs:void 0,path:f}}if(n&1)switch(_){case 0:case 54:{let b=await I.getFdstat();if(b!==void 0&&b.fs_filetype===7){if(c===0)return{desc:I,err:32,fs:h,path:f};let{err:H,content:M}=await I.read_str();if(H!==0)return{desc:void 0,err:_,fs:h,path:void 0};let K;if(M.startsWith("/"))if(m!==-1){let V=f.slice(l+m);K=M.concat(V)}else K=M;else{let V=m===-1?I.getPath().lastIndexOf("/"):I.getPath().lastIndexOf("/",l+m-1),ie=f.slice(0,V+1);if(_===0)K=ie.concat(M);else{let he=f.slice(l+m);K=ie.concat(M,he)}}return await this.getDescInfo(K,t,n,i,s,a,o,c-1)}break}default:return{desc:void 0,err:_,fs:h,path:void 0}}return _===0?(i&bn&&await I.truncate(0n),{desc:I,err:_,fs:h,path:f}):{desc:void 0,err:_,fs:h,path:f}}async open(e,t=0,n=0,i=0,s=Be,a=Be,o=-1){return await this.getDescInfo(e,o,t,n,s,a,i)}async openat(e,t,n=0,i=0,s=0,a=Be,o=Be,c=-1){let f=this.abspath(e,t);return await this.getDescInfo(f,c,n,i,a,o,s)}async createDir(e,t=void 0,n=-1){let i=this.abspath(t,e);i.endsWith("/")&&(i=i.slice(0,-1));let{desc:s,fs:a,err:o}=await this.getDescInfo(Vt(i),n,1);return o!==0?o:await a.mkdirat(s,Ve(i))}async addSymlink(e,t,n=void 0,i=-1){let s;n!==void 0&&!t.startsWith("/")?s=`${n.getPath()}/${t}`:s=t;let{desc:a,fs:o,err:c}=await this.getDescInfo(Vt(s),i,1);return c!==0?c:o.symlinkat(e,a,Ve(t))}async removeEntry(e,t,n=void 0,i=-1){let s=this.abspath(n,e),{desc:a,fs:o,err:c}=await this.getDescInfo(Vt(s),i,1);return c!==0?c:await o.unlinkat(a,Ve(s),t)}async move(e,t,n,i,s=-1){let a=this.abspath(e,t),o=Vt(a),c=this.abspath(n,i),f=Vt(c);if(Object.keys(this.mounts).some(H=>{H.startsWith(a)})||a.startsWith(c))return 10;let l=await this.getDescInfo(o,s,1,nt);if(l.err!==0)return l.err;let h=await this.getDescInfo(a,s,1);if(h.err!==0)return h.err;let _=await h.desc.getFilestat();if(_.err!==0)return _.err;let m=_.filestat,I=await this.getDescInfo(f,s,1,nt);if(I.err!==0)return I.err;let b=await this.getDescInfo(c,s,1);if(b.err===0){let H=await b.desc.getFilestat();if(H.err!==0)return H.err;let M=H.filestat;if(m.dev!==M.dev)return 75;if(M.filetype===3){if(m.filetype!==3)return 54;let{err:K,dirents:V}=await b.desc.readdir(!1);if(K!==0)return K;if(V.length!==0)return 55}}return I.fs.renameat(l.desc,Ve(a),I.desc,Ve(c))}async addMount(e,t,n,i,s,a,o,c=-1){let f=this.abspath(n,i),l;if(f!=="/"){if(l=await this.getDescInfo(f,c,1,nt),l.err!==0)return l.err;if((await l.desc.readdir(!0)).dirents.length!==0)return 55}else if(this.mounts["/"]!==void 0)return 10;let h=this.abspath(e,t),_;if(h===""){let m=await Zc(s,o);if(m.err!==0)return m.err;_=m.filesystem}else{let m=await this.getDescInfo(h,c,1,nt);if(m.err!==0)return m.err;let I=await m.desc.mountFs(o);if(I.err!==0)return I.err;_=I.fs}return this.mounts[f]=_,0}async addMountFs(e,t,n=-1){if(this.mounts[e]!==void 0)return 10;if(e==="/")return this.mounts[e]=t,0;let i=await this.getDescInfo(e,n,1,nt);return i.err!==0?i.err:(await i.desc.readdir(!0)).dirents.length===0?(this.mounts[e]=t,0):55}removeMount(e){return Object.keys(this.mounts).every(t=>t===e||!t.startsWith(e))?this.mounts[e]?(delete this.mounts[e],0):44:10}async readLink(e,t,n=-1){let{err:i,desc:s}=await this.openat(e,t,0,0,0,Be,Be,n);if(i!==0)return{err:i,path:void 0};if((await s.getFdstat()).fs_filetype!==7)return{err:28,path:void 0};let{err:o,content:c}=await s.read_str();return{err:o,path:c}}getMounts(){return this.mounts}};var la=class extends Cr{procNode;contents;cursor;constructor(e,t,n,i){super(),this.procNode=i,this.fdstat={fs_flags:e,fs_rights_base:t,fs_rights_inheriting:n,fs_filetype:this.procNode.getFilestat().filetype},this.contents=new TextEncoder().encode(this.procNode.read()),this.cursor=0n}addPollSub(e,t,n){return Promise.resolve({userdata:e,eventType:t,nbytes:BigInt(this.contents.byteLength),error:0})}arrayBuffer(){return Promise.resolve({err:0,buffer:this.contents})}close(){return Promise.resolve(0)}getFilestat(){return Promise.resolve({err:0,filestat:this.procNode.getFilestat()})}pread(e,t){let n=this.contents.slice(Number(t),Number(t)+e);return Promise.resolve({err:0,buffer:n})}pwrite(e,t){return Promise.resolve({err:2,written:0n})}read(e,t){let n=this.contents.slice(Number(this.cursor),Number(this.cursor)+e);return this.cursor+=BigInt(n.byteLength),Promise.resolve({err:0,buffer:n})}read_str(){return Promise.resolve({err:0,content:new TextDecoder().decode(this.contents)})}seek(e,t){let n=BigInt(this.contents.byteLength);switch(t){case Tr:if(this.cursor+e<0n)return Promise.resolve({offset:this.cursor,err:28});this.cursor+=e;break;case Tn:if(e<0n)return Promise.resolve({offset:this.cursor,err:28});this.cursor=e;break;case Cn:if(n<-e)return Promise.resolve({offset:this.cursor,err:28});this.cursor=n+e;break;default:return Promise.resolve({offset:this.cursor,err:28})}return Promise.resolve({err:0,offset:this.cursor})}setFilestatTimes(e,t){return Promise.resolve(8)}truncate(e){return Promise.resolve(2)}writableStream(){return Promise.resolve({err:2,stream:void 0})}write(e){return Promise.resolve({err:2,written:0n})}},da=class extends Or{procNode;dirents;constructor(e,t,n,i){super(),this.procNode=i,this.fdstat={fs_flags:e,fs_rights_base:t,fs_rights_inheriting:n,fs_filetype:3}}async readdir(e){if(this.dirents===void 0||e){let t=this.procNode.listNodes();if(t.err!==0)return{err:t.err,dirents:void 0};this.dirents=Object.entries(t.nodes).map(([n,i],s)=>({d_next:BigInt(s+1),d_ino:0n,name:n,d_type:i.getFilestat().filetype}))}return{err:0,dirents:this.dirents}}getFilestat(){return Promise.resolve({err:0,filestat:this.procNode.getFilestat()})}setFilestatTimes(e,t){return Promise.resolve(8)}};var Sa;function Ad(r){Sa=r}function bd(r){return new pa(r)}var ef=class{constructor(){}getFilestat(){return ef.filestat}},ha=ef;fr(ha,"filestat",{dev:0n,ino:0n,filetype:7,nlink:1n,size:0n,mtim:0n,atim:0n,ctim:0n});var tf=class{getFilestat(){return tf.filestat}},_a=tf;fr(_a,"filestat",{dev:0n,ino:0n,filetype:4,nlink:1n,size:0n,mtim:0n,atim:0n,ctim:0n});var rf=class{pid;constructor(e){this.pid=e}getFilestat(){return rf.filestat}},Li=rf;fr(Li,"filestat",{dev:0n,ino:0n,filetype:3,nlink:1n,size:0n,mtim:0n,atim:0n,ctim:0n});var ga=class extends _a{read(){return Object.entries(Sa.filesystem.getMounts()).map(([e,t])=>`${e} ${t.fsname()}`).join(`
`)+`
`}},va=class extends ha{pid;constructor(e){super(),this.pid=e}read(){return this.pid.toString()}},nf=class extends Li{listNodes(){let e={};for(let[t,n]of Object.entries(nf.specialNodes))e[t]=new n(this.pid);for(let t of Object.keys(Sa.processInfos))e[t.toString()]=new Bi(Number(t));return{err:0,nodes:e}}getNode(e){if(e==="")return{err:0,node:this};let t=Number(e);if(isNaN(t)){if(e==="self")return{err:0,node:new va(this.pid)}}else if(Sa.processInfos[t]!==void 0)return{err:0,node:new Bi(t)};return{err:44,node:void 0}}},pa=nf;fr(pa,"specialNodes",{self:va});var sf=class extends Li{listNodes(){let e={};for(let[t,n]of Object.entries(sf.specialNodes))e[t]=new n(this.pid);return{err:0,nodes:e}}getNode(e){switch(e){case"mountinfo":return{err:0,node:new ga};default:return{err:44,node:void 0}}}},Bi=sf;fr(Bi,"specialNodes",{mountinfo:ga});var ma=class{processManager;constructor(e){this.processManager=e,Ad(this.processManager)}fsname(){return"ProcFilesystem"}mkdirat(e,t){return Promise.resolve(2)}getFilestat(e){return Promise.resolve({err:58,filestat:void 0})}open(e,t,n,i,s,a,o){let c=bd(o),f=0,l=-1,h=e.startsWith("/")?0:-1,_=e.indexOf("/",h+1);do{let b=_===-1?e.slice(h+1):e.slice(h+1,_);if(c.getFilestat().filetype!==3){f=54,l=h;break}let H=c.getNode(b);if(H.err!==0){f=H.err,l=_;break}c=H.node;let M=e.indexOf("/",_+1);h=_,_=M}while(h!==-1);h===-1&&(l=-1,f===0?n&nt&&c.getFilestat().filetype!==3?f=54:n&Ye&&n&Qr&&(f=20):f===44&&n&Ye&&(f=2));let m,I=c.getFilestat().filetype;if(I===3)m=new da(a,i,s,c);else{let b=c;m=new la(a,i,s,b)}return Promise.resolve({err:f,index:l,desc:m})}unlinkat(e,t,n){return Promise.resolve(2)}renameat(e,t,n,i){return Promise.resolve(2)}symlinkat(e,t,n){return Promise.resolve(2)}initialize(e){return Promise.resolve(0)}mknodat(e,t,n,i){return Promise.resolve(2)}};var Ea=class{devices;async initDriver(){return this.devices={[0]:Ui,[1]:af,[2]:of},0}async initDevice(e){return 0}async teardownDevice(e){return 0}async teardownDriver(){return 0}async getDesc(e,t,n,i,s){return{desc:new this.devices[e](t,n,i,s),err:0}}},Ui=class extends mr{isatty(){return!1}async read(e,t){return{err:0,buffer:new ArrayBuffer(0)}}async pread(e,t){return{err:0,buffer:new ArrayBuffer(0)}}async arrayBuffer(){return{err:0,buffer:new ArrayBuffer(0)}}async read_str(){return{err:0,content:""}}async write(e){return{err:0,written:BigInt(e.byteLength)}}async pwrite(e,t){return{err:0,written:BigInt(e.byteLength)}}async seek(e,t){return{err:0,offset:0n}}async truncate(e){return 0}},af=class extends Ui{async read(e,t){let n=new ArrayBuffer(e);return new Uint8Array(n).fill(0,0,e),{err:0,buffer:n}}async pread(e,t){return this.read(e)}},of=class extends Ui{async read(e,t){let n=new ArrayBuffer(e),i=new Uint8Array(n);for(var s=0;s<e;s++)i.set([Math.floor(Math.random()*256)],s);return{err:0,buffer:n}}async pread(e,t){return this.read(e)}};var cf=class{bufSize;start;end;buffers;constructor(e=1<<16){this.bufSize=e,this.start=0,this.end=0,this.buffers=[],this.getNewBuffer()}getNewBuffer(){this.buffers.push(new ArrayBuffer(this.bufSize)),this.end=0}discardBuffer(){this.start=0,this.buffers.length===1&&(this.end=0),this.buffers.shift()}push(e){let t=0;for(;t<e.length;){(this.end>=this.bufSize||this.buffers.length===0)&&this.getNewBuffer();let n=new Uint8Array(this.buffers[this.buffers.length-1],this.end,this.bufSize-this.end),{written:i,read:s}=new TextEncoder().encodeInto(e.slice(t),n);if(t+=s,this.end+=i,this.end<this.bufSize&&t<e.length){let a=new TextEncoder().encode(e[t]),o=this.bufSize-this.end;n.set(a.slice(0,o),this.end-n.byteOffset),this.getNewBuffer(),new Uint8Array(this.buffers[this.buffers.length-1],this.end,this.bufSize-this.end).set(a.slice(o)),t++,this.end+=a.length-o}}}pop(e,t){let n=0;for(;n<t;){let i=t-n;if(this.buffers.length===1?i>this.end-this.start&&(i=this.end-this.start):i>this.bufSize-this.start&&(i=this.bufSize-this.start),i===0)break;let s=new Uint8Array(this.buffers[0],this.start,i);e.set(s,n),this.start+=i,n+=i,this.start>=this.bufSize&&this.discardBuffer()}return n}length(){if(this.buffers.length<=1)return this.end-this.start;{let e=this.buffers.length>2?this.buffers.length*this.bufSize:0;return this.bufSize-this.start+this.end+e}}},wa=class{foregroundPid;bufRequestQueue;subs;termios;driverBuffer;driverBufferCursor;userBuffer;constructor(e,t=1<<16){this.bufRequestQueue=[],this.subs=[],this.termios=e,this.driverBuffer="",this.driverBufferCursor=0,this.userBuffer=new cf(t)}splitBuf(e){let t=new ArrayBuffer(e),n=new Uint8Array(t),i=this.userBuffer.pop(n,e);return t.slice(0,i)}detectBreakCondition(e){for(let t=2;t<e.length;++t)if(e.charCodeAt(t)!==0)return t;return e.length}stripOffBytes(e){let t="";for(let n=0;n<e.length;++n){let i=e.charCodeAt(n);t+=String.fromCharCode(i&127)[0]}return t}pushDriverInputBuffer(e){this.termios.lFlag&8&&this.printTerminal(e),this.driverBuffer=this.driverBuffer.slice(0,this.driverBufferCursor)+e+this.driverBuffer.slice(this.driverBufferCursor),this.driverBufferCursor+=e.length}pushNLDriverInputBuffer(){this.driverBuffer+=`
`,this.termios.lFlag&2&&((this.termios.lFlag&8||this.termios.lFlag&64)&&this.printTerminal(`\r
`),this.flushDriverInputBuffer())}flushDriverInputBuffer(){this.userBuffer.push(this.driverBuffer),this.driverBuffer="",this.driverBufferCursor=0}resolveUserReadRequests(){if(this.userBuffer.length()!==0)for(;this.userBuffer.length()!==0&&this.bufRequestQueue.length>0;){let e=this.bufRequestQueue.shift(),t=new ArrayBuffer(e.len),n=new Uint8Array(t),i=this.userBuffer.pop(n,e.len);e.resolve({err:0,buffer:t.slice(0,i)})}else{let e=this.bufRequestQueue.filter(t=>t.pid===this.foregroundPid);this.bufRequestQueue=this.bufRequestQueue.filter(t=>t.pid!==this.foregroundPid),e.forEach(t=>t.resolve({err:0,buffer:new ArrayBuffer(0)}))}}processTerminalInput(e,t){let n=this.termios.iFlag,i=this.termios.cFlag,s=this.termios.lFlag;if(i&128){for(n&32&&(t=this.stripOffBytes(t));t.length>0;){let a=t.charCodeAt(0);if(a===0&&t.length>1&&t.charCodeAt(1)===0){let o=this.detectBreakCondition(t);n&1||(n&2?this.flushDriverInputBuffer():n&8?this.driverBuffer+="\xFF\0\0":this.driverBuffer+="\0"),t=t.slice(o);continue}switch(a){case 10:{s&2?n&64?n&128||(n&256?this.pushNLDriverInputBuffer():this.pushDriverInputBuffer("\r")):this.pushNLDriverInputBuffer():this.pushNLDriverInputBuffer();break}case 13:{s&2?n&128||(n&256?this.pushNLDriverInputBuffer():this.pushDriverInputBuffer("\r")):this.pushDriverInputBuffer("\r");break}case 17:case 19:{n&1024||this.pushDriverInputBuffer(t[0]);break}case 3:case 26:case 28:{s&1?a===3&&this.foregroundPid!==null&&e.publishEvent(Yt,this.foregroundPid):this.pushDriverInputBuffer(t[0]);break}case 4:{s&2?(this.flushDriverInputBuffer(),this.resolveUserReadRequests()):this.pushDriverInputBuffer(t[0]);break}case 21:{s&2&&s&32?this.removeFromCursorToLeft(this.driverBufferCursor):this.pushDriverInputBuffer(t[0]);break}case 127:{s&2&&s&16?this.removeFromCursorToLeft(1):this.pushDriverInputBuffer(t[0]);break}case 27:{if(s&2)if(t[1]==="["){switch(t[2]){case"C":{this.moveCursorRight(1);break}case"D":{this.moveCursorLeft(1);break}default:break}t=t.slice(3);continue}else{t=t.slice(2);continue}else this.pushDriverInputBuffer(t[0]);break}default:{this.pushDriverInputBuffer(t[0]);break}}t=t.slice(1)}if(s&2||this.flushDriverInputBuffer(),this.userBuffer.length()!==0&&this.resolveUserReadRequests(),this.userBuffer.length()!==0){for(let a of this.subs)a.resolve({userdata:a.userdata,error:0,nbytes:BigInt(this.userBuffer.length()),eventType:br});this.subs.length=0}}}dataForUser(){return this.userBuffer.length()}readToUser(e){return this.splitBuf(e)}sendTerminalOutput(e){return this.termios.oFlag&4&&(e=e.replaceAll(`
`,`\r
`)),this.printTerminal(e),e}};var ug={iFlag:5376,oFlag:5,cFlag:176,lFlag:32827},pf=class extends wa{terminal;constructor(e){super({...ug}),this.terminal=e,this.terminal.setInsertMode((this.termios.lFlag&2)!==0)}printTerminal(e){this.terminal.io.print(e)}moveCursorRight(e){let t=e>=this.driverBuffer.length-this.driverBufferCursor?this.driverBuffer.length-this.driverBufferCursor:e;t!==0&&(this.terminal.io.print(`\x1B[${t}C`),this.driverBufferCursor+=t)}moveCursorLeft(e){let t=e>=this.driverBufferCursor?this.driverBufferCursor:e;t!==0&&(this.terminal.io.print(`\x1B[${t}D`),this.driverBufferCursor-=t)}removeFromCursorToLeft(e){let t=e>=this.driverBufferCursor?this.driverBufferCursor:e;t!==0&&(this.terminal.cursorLeft(t),this.terminal.io.print(`\x1B[${t}P`),this.driverBuffer=this.driverBuffer.slice(0,this.driverBufferCursor-t)+this.driverBuffer.slice(this.driverBufferCursor),this.driverBufferCursor-=t)}getScreenSize(){let e=this.terminal.scrollPort_.getScreenSize();return{cellsWidth:this.terminal.screenSize.width,cellsHeight:this.terminal.screenSize.height,pxWidth:e.width,pxHeight:e.height}}},Aa=class{maxTty;freedTerminals;processManager;terminals;async initDriver(e){let t=e;return this.processManager=t.processManager,this.terminals=[],this.freedTerminals=[],this.maxTty=0,0}__initFsaDropImport(e,t,n,i){t.addEventListener("dragover",function(o){o.stopPropagation(),o.preventDefault(),o.dataTransfer.dropEffect="copy"},!1);let s=this;t.addEventListener("drop",async function(a){a.stopPropagation(),a.preventDefault();let o=i.processInfos[s.terminals[e].foregroundPid].cwd;await Promise.all((Object.values(a.dataTransfer.items)||[]).map(async c=>{let f=await c.getAsFileSystemHandle(),l=`${o}/${f.name}`;if(f.kind==="file"){let h=(await f.getFile()).stream(),_=await i.filesystem.open(l,Ye);if(_.err!==0)return;let{err:m,stream:I}=await _.desc.writableStream();return new Promise(async b=>{await h.pipeTo(I),n&&n(l,f.name),b()})}else if(f.kind==="directory"){let h=`/tmp/temp_mount_${f.name}`;await i.filesystem.createDir(h);let{err:_,filesystem:m}=await Zc("fsa",{dir:f,keepMetadata:!1});if(_!==0)return;await i.filesystem.addMountFs(h,m),await i.spawnProcess(0,null,"/usr/bin/wash",new Rr({0:void 0,1:void 0,2:void 0,3:new St((await i.filesystem.open("/")).desc)}),["/usr/bin/wash","-c",`cp -r ${h} ${l} ; umount ${h}`],Es,!1,on)}}))})}__initTerminal(e){let t=new pf(e);t.terminal.installKeyboard(),t.terminal.keyboard.bindings.addBindings({"Ctrl-R":"PASS"});let n=s=>{t.processTerminalInput(this.processManager,s)},i=t.terminal.io.push();return i.onVTKeystroke=n,i.sendString=n,i.onTerminalResize=(s,a)=>{t.foregroundPid!==null&&this.processManager.publishEvent(ru,t.foregroundPid)},t}async initDevice(e,t){let n=t,i=this.freedTerminals.pop();i||(i=this.maxTty++);let s=this.__initTerminal(n.terminal);return this.terminals[i]=s,this.__initFsaDropImport(i,n.terminal.div_.getElementsByTagName("iframe")[0].contentWindow,()=>{},this.processManager),0}async teardownDevice(e){return this.terminals[e]?(delete this.terminals[e],this.freedTerminals.push(e),0):44}async teardownDriver(){return 0}async getDesc(e,t,n,i,s){return this.terminals[e]===void 0?{err:43,desc:void 0}:{err:0,desc:new Sf(t,n,i,s,this.terminals[e])}}async wrapCallback(e){try{await e()}catch(t){throw Object.values(this.terminals).forEach(n=>{n.terminal.io.println(`[ERROR] Unrecoverable kernel error: ${t}`)}),t}}},Sf=class extends mr{hterm;constructor(e,t,n,i,s){super(e,t,n,i),this.hterm=s}isatty(){return!0}async write(e){let t=this.hterm.sendTerminalOutput(new TextDecoder().decode(e));return window.stdoutAttached&&(window.buffer+=t),{err:0,written:BigInt(e.byteLength)}}async read(e,t){return this.hterm.dataForUser()>0?{err:0,buffer:this.hterm.readToUser(e)}:this.fdstat.fs_flags&4?{err:0,buffer:new ArrayBuffer(0)}:new Promise(n=>{this.hterm.bufRequestQueue.push({len:e,pid:t,resolve:n})})}async ioctl(e,t){let n=42;switch(e){case 1:{if(t.byteLength<16)break;let i=new Int32Array(t.buffer,t.byteOffset);i[0]=this.hterm.termios.iFlag,i[1]=this.hterm.termios.oFlag,i[2]=this.hterm.termios.cFlag,i[3]=this.hterm.termios.lFlag,n=0;break}case 2:{if(t.byteLength<16)break;let i=new Int32Array(t.buffer,t.byteOffset);this.hterm.termios.iFlag=i[0],this.hterm.termios.oFlag=i[1],this.hterm.termios.cFlag=i[2],this.hterm.termios.lFlag=i[3],this.hterm.terminal.setInsertMode((this.hterm.termios.lFlag&2)!==0),n=0;break}case 19:{if(t.byteLength<8)break;let i=await this.hterm.getScreenSize(),s=new Uint16Array(t.buffer,t.byteOffset);s[0]=i.cellsHeight,s[1]=i.cellsWidth,s[2]=i.pxWidth,s[3]=i.pxHeight,n=0;break}default:{1<=e&&e<=96&&2147767344<=e&&e<=2147767360&&35073<=e&&e<=35079?n=58:n=28;break}}return n}addPollSub(e,t,n){switch(t){case ls:return Promise.resolve({userdata:e,error:0,eventType:t,nbytes:0n});case br:return this.hterm.dataForUser()===0?new Promise(i=>{this.hterm.subs.push({pid:n,userdata:e,tag:t,resolve:i})}):Promise.resolve({userdata:e,error:0,eventType:t,nbytes:BigInt(this.hterm.dataForUser())});default:return Promise.resolve({userdata:e,error:28,eventType:Ht,nbytes:0n})}}};var ba=class{responses;topResponseId;devfs;initDriver(e){return this.topResponseId=1,this.responses={},Promise.resolve(0)}teardownDriver(e){return Promise.resolve(0)}initDevice(e,t){return e===0&&(this.devfs=t.devfs),Promise.resolve(0)}teardownDevice(e,t){return Promise.resolve(0)}async makeRequest(e){try{return this.responses[this.topResponseId]=await fetch(e),this.devfs.mknodat(void 0,`wget0r${this.topResponseId}`,vr(2,this.topResponseId),{}),{err:0,minor:this.topResponseId++}}catch(t){return console.log(t),{err:28,minor:-1}}}async getDesc(e,t,n,i,s){return e===0?{err:0,desc:new gf(t,n,i,s,this)}:this.responses[e]===void 0?{desc:void 0,err:44}:{err:0,desc:new vf(t,n,i,s,this.responses[e],()=>this.invalidateResponse(e))}}async invalidateResponse(e){return delete this.responses[e],this.devfs.unlinkat(void 0,`wget0r${e}`,!1)}},gf=class extends mr{driver;constructor(e,t,n,i,s){super(e,t,n,i),this.driver=s}isatty(){return!1}async write(e){let t=new TextDecoder().decode(e),{err:n,minor:i}=await this.driver.makeRequest(t);return{err:n,written:BigInt(i)}}},vf=class extends mr{response;invalidate;currentBuffer;body;headers;hCursor;bCursor;constructor(e,t,n,i,s,a){super(e,t,n,i),this.response=s,this.invalidate=a,this.currentBuffer=1,this.hCursor=0,this.bCursor=0;let o=[];for(let[c,f]of this.response.headers.entries())o.push(`${c}: ${f}`);this.headers=new TextEncoder().encode(o.join(`
`))}isatty(){return!1}async read(e,t){let n;return this.currentBuffer===1?(this.body===void 0&&(this.body=await this.response.arrayBuffer()),n=this.body.slice(this.bCursor,this.bCursor+e),this.bCursor+=n.byteLength):(n=this.headers.slice(this.hCursor,this.hCursor+e),this.hCursor+=n.byteLength),{err:0,buffer:n}}close(){return this.invalidate()}async ioctl(e,t){switch(e){case 0:{if(t===void 0||t.byteLength<4)return 42;let n=new Int32Array(t.buffer,t.byteOffset);return n[0]=this.response.status,0}case 2:return this.currentBuffer=1,0;case 1:return this.currentBuffer=0,0;default:return 28}}};var Ta=class{drivers;constructor(){this.drivers={}}async initialize(e){let t=new Ea,n=await t.initDriver();if(n!==0)return n;let i=new Aa;if(n=await i.initDriver({processManager:e}),n!==0)return n;let s=new ba;return n=await s.initDriver({}),n!==0?n:(this.drivers[0]=t,this.drivers[1]=i,this.drivers[2]=s,0)}getDriver(e){return this.drivers[e]}};var lg=URL.createObjectURL(new Blob([function(){function r(){}if(r.prototype={onmessage:function(o){try{if(o.data.type==="extract")this.untarBuffer(o.data.buffer);else throw new Error("Unknown message type: "+o.data.type)}catch(c){this.postError(c)}},postError:function(o){this.postMessage({type:"error",data:{message:o.message}})},postLog:function(o,c){this.postMessage({type:"log",data:{level:o,msg:c}})},untarBuffer:function(o){try{for(var c=new a(o);c.hasNext();){var f=c.next();this.postMessage({type:"extract",data:f},[f.buffer])}this.postMessage({type:"complete"})}catch(l){this.postError(l)}},postMessage:function(o,c){self.postMessage(o,c)}},typeof self<"u"){var e=new r;self.onmessage=function(o){e.onmessage(o)}}function t(o){for(var c="",f=0;f<o.length;){var l=o[f++];if(l>127){if(l>191&&l<224){if(f>=o.length)throw"UTF-8 decode: incomplete 2-byte sequence";l=(l&31)<<6|o[f]&63}else if(l>223&&l<240){if(f+1>=o.length)throw"UTF-8 decode: incomplete 3-byte sequence";l=(l&15)<<12|(o[f]&63)<<6|o[++f]&63}else if(l>239&&l<248){if(f+2>=o.length)throw"UTF-8 decode: incomplete 4-byte sequence";l=(l&7)<<18|(o[f]&63)<<12|(o[++f]&63)<<6|o[++f]&63}else throw"UTF-8 decode: unknown multibyte start 0x"+l.toString(16)+" at index "+(f-1);++f}if(l<=65535)c+=String.fromCharCode(l);else if(l<=1114111)l-=65536,c+=String.fromCharCode(l>>10|55296),c+=String.fromCharCode(l&1023|56320);else throw"UTF-8 decode: code point 0x"+l.toString(16)+" exceeds UTF-16 reach"}return c}function n(o){this._fields=o}n.parse=function(o){for(var c=new Uint8Array(o),f=[];c.length>0;){var l=parseInt(t(c.subarray(0,c.indexOf(32)))),h=t(c.subarray(0,l)),_=h.match(/^\d+ ([^=]+)=(.*)\n$/);if(_===null)throw new Error("Invalid PAX header data format.");var m=_[1],I=_[2];I.length===0?I=null:I.match(/^\d+$/)!==null&&(I=parseInt(I));var b={name:m,value:I};f.push(b),c=c.subarray(l)}return new n(f)},n.prototype={applyHeader:function(o){this._fields.forEach(function(c){var f=c.name,l=c.value;f==="path"?(f="name",o.prefix!==void 0&&delete o.prefix):f==="linkpath"&&(f="linkname"),l===null?delete o[f]:o[f]=l})}};function i(){}function s(o){this._bufferView=new DataView(o),this._position=0}s.prototype={readString:function(o){for(var c=1,f=o*c,l=[],h=0;h<o;++h){var _=this._bufferView.getUint8(this.position()+h*c,!0);if(_!==0)l.push(_);else break}return this.seek(f),String.fromCharCode.apply(null,l)},readBuffer:function(o){var c;if(typeof ArrayBuffer.prototype.slice=="function")c=this._bufferView.buffer.slice(this.position(),this.position()+o);else{c=new ArrayBuffer(o);var f=new Uint8Array(c),l=new Uint8Array(this._bufferView.buffer,this.position(),o);f.set(l)}return this.seek(o),c},seek:function(o){this._position+=o},peekUint32:function(){return this._bufferView.getUint32(this.position(),!0)},position:function(o){if(o===void 0)return this._position;this._position=o},size:function(){return this._bufferView.byteLength}};function a(o){this._stream=new s(o),this._globalPaxHeader=null}a.prototype={hasNext:function(){return this._stream.position()+4<this._stream.size()&&this._stream.peekUint32()!==0},next:function(){return this._readNextFile()},_readNextFile:function(){var o=this._stream,c=new i,f=!1,l=null,h=o.position(),_=h+512;switch(c.name=o.readString(100),c.mode=o.readString(8),c.uid=parseInt(o.readString(8)),c.gid=parseInt(o.readString(8)),c.size=parseInt(o.readString(12),8),c.mtime=parseInt(o.readString(12),8),c.checksum=parseInt(o.readString(8)),c.type=o.readString(1),c.linkname=o.readString(100),c.ustarFormat=o.readString(6),c.ustarFormat.indexOf("ustar")>-1&&(c.version=o.readString(2),c.uname=o.readString(32),c.gname=o.readString(32),c.devmajor=parseInt(o.readString(8)),c.devminor=parseInt(o.readString(8)),c.namePrefix=o.readString(155),c.namePrefix.length>0&&(c.name=c.namePrefix+"/"+c.name)),o.position(_),c.type){case"0":case"":c.buffer=o.readBuffer(c.size);break;case"1":break;case"2":break;case"3":break;case"4":break;case"5":break;case"6":break;case"7":break;case"g":f=!0,this._globalPaxHeader=n.parse(o.readBuffer(c.size));break;case"x":f=!0,l=n.parse(o.readBuffer(c.size));break;default:break}c.buffer===void 0&&(c.buffer=new ArrayBuffer(0));var m=_+c.size;return c.size%512!==0&&(m+=512-c.size%512),o.position(m),f&&(c=this._readNextFile()),this._globalPaxHeader!==null&&this._globalPaxHeader.applyHeader(c),l!==null&&l.applyHeader(c),c}}}.toString().slice(11,-1)],{type:"test/javascript"}));function dg(r){if(typeof Promise!="function")throw new Error("Promise implementation not available in this environment.");var e=[],t=[];function n(a){for(var o=0,c=e.length;o<c;++o)e[o](a);t.push(a)}var i=new Promise(function(a,o){r(a,o,n)});i.progress=function(a){if(typeof a!="function")throw new Error("cb is not a function.");for(var o=0,c=t.length;o<c;++o)a(t[o]);return e.push(a),i};var s=i.then;return i.then=function(a,o,c){return s.call(i,a,o),c!==void 0&&i.progress(c),i},i}var mf=window||void 0,hg=mf.URL||mf.webkitURL;function Od(r){if(!(r instanceof ArrayBuffer))throw new TypeError("arrayBuffer is not an instance of ArrayBuffer.");if(!mf.Worker)throw new Error("Worker implementation is not available in this environment.");return new dg(function(e,t,n){var i=new Worker(lg),s=[];i.onerror=function(a){t(a)},i.onmessage=function(a){switch(a=a.data,a.type){case"log":console[a.data.level]("Worker: "+a.data.msg);break;case"extract":var o=pg(a.data);s.push(o),n(o);break;case"complete":i.terminate(),e(s);break;case"error":i.terminate(),t(new Error(a.data.message));break;default:i.terminate(),t(new Error("Unknown message from worker: "+a.type));break}},i.postMessage({type:"extract",buffer:r},[r])})}var _g={blob:{get:function(){return this._blob||(this._blob=new Blob([this.buffer]))}},getBlobUrl:{value:function(){return this._blobUrl||(this._blobUrl=hg.createObjectURL(this.blob))}},readAsString:{value:function(){for(var r=this.buffer,e=r.byteLength,t=1,n=e*t,i=new DataView(r),s=[],a=0;a<e;++a){var o=i.getUint8(a*t,!0);s.push(o)}return this._string=String.fromCharCode.apply(null,s)}},readAsJSON:{value:function(){return JSON.parse(this.readAsString())}}};function pg(r){return Object.defineProperties(r,_g),r}var Sg="fsa0",Ef="/config.json",gg={fsType:"vfs",opts:{}};async function vg(r){let{err:e,desc:t}=await r.open("/etc/motd",1,Ye|bn);e===0&&(await t.write(new TextEncoder().encode(`
[WARNING] Could not mount filesystem, volatile filesystem used as root for recovery
`)),await t.close())}async function mg(r){let e=[await r.open("/dev/ttyH0",0,0,0,Jf,0n),await r.open("/dev/ttyH0",0,0,1,wo,0n),await r.open("/dev/ttyH0",0,0,1,Qf,0n),await r.open("/")];for(var t=0;t<e.length;t++){if(e[t].err!==0)throw`Cannot open fd=${t}, error code=${e[t].err}!`;if(e[t]===void 0)throw`Cannot open fd=${t}, descriptor is undefined!`}return new Rr({0:new St(e[0].desc),1:new St(e[1].desc),2:new St(e[2].desc),3:new St(e[3].desc)})}async function Eg(r,e,t,n=!0){let{err:i,desc:s}=await r.open(e,1,Ye);if(i!==0)return console.warn(`Unable to resolve path for ${e}`),i;if(n||(await s.getFilestat()).filestat.size===0n){await s.truncate(0n);let a=await fetch(t);if(a.status!=200)return 44;{let{err:o,stream:c}=await s.writableStream();if(o!=0)return o;await a.body?.pipeTo(c)}}return await s.close(),0}function xd(r){let e=new DecompressionStream("gzip");return r.pipeThrough(e)}async function Wd(r,e){let t=await Od(e);for(let n of t)switch(n.type){case"":case"0":{let{err:i,desc:s}=await r.open(n.name,0,Ye);if(i!==0)throw Error("Corrupted rootfs image");let a=(await s.writableStream()).stream;await n.blob.stream().pipeTo(a),await s.close();break}case"5":{if(await r.createDir(n.name)!==0)throw Error("Corrupted rootfs image");break}case"2":{if(await r.addSymlink(n.linkname,n.name)!==0)throw Error("Corrupted rootfs image");break}}}function yg(){return new Promise(r=>{navigator.serviceWorker.register("jswasi.js").then(e=>{e!==void 0&&(e.onupdatefound=()=>r(!0),e.active&&r(!0))},e=>r(!1))})}async function Ig(r){await r.addMount(void 0,"",void 0,"/","fsa",0n,{name:Sg,create:"true",keepMetadata:"false"});let e,{err:t,desc:n}=await r.open(Ef);if(t===0){let{err:i,content:s}=await n.read_str();if(i===0)try{e=JSON.parse(s)}catch{}await n.close()}else{await Eg(r,Ef,"resources/config.json");let{desc:i}=await r.open(Ef),{content:s}=await i.read_str();e=JSON.parse(s)}return r.removeMount("/"),e}function Rd(r,e){return r.addMount(void 0,"",void 0,"/",e.fsType,0n,e.opts)}async function wg(r,e){if(!navigator.storage.getDirectory){r.io.println("Your browser doesn't support File System Access API yet."),r.io.println("We recommend using Chrome for the time being.");return}if(r.io.println(ze("Registering service worker")),!await yg()){r.io.println(ze("Service Worker registration failed"));return}if(typeof SharedArrayBuffer>"u"){r.io.println(ze("SharedArrayBuffer undefined, reloading page")),window.location.href=window.location.href;return}let t=new ua;e==null&&(r.io.println(ze("Reading kernel config")),e=await Ig(t)),await Rd(t,e.mountConfig)!==0&&r.io.println(ze("Failed to mount root filesystem"));let n=new Ta,i=new pi(Hf,t,n);r.io.println(ze("Reading init system"));let{err:s}=await t.open(e.init[0],1);if(s!==0){r.io.println(ze("Init system not present")),r.io.println(ze("Starting rootfs initialization"));let o=e.rootfs;o===void 0&&(r.io.println(ze("Rootfs image not configured in kernel config, using default")),o="https://antmicro.github.io/jswasi-rootfs/rootfs.tar.gz");let c=await fetch(o),f=c.headers.get("Content-Encoding"),l=c.body;f==="gzip"?l=xd(l):f||c.headers.get("Content-Type")==="application/gzip"&&(l=xd(l)),s===56?(r.io.println(ze("Root filesystem corrupted, attempting recovery mode")),t.removeMount("/"),await Rd(t,gg),r.io.println(ze("VirtualFilesystem mounted on /")),await Wd(t,await new Response(l).arrayBuffer()),await vg(t)):await Wd(t,await new Response(l).arrayBuffer()),r.io.println(ze("Rootfs initialized"))}await t.createDir("/dev"),r.io.println(ze("Mounting device filesystem")),await t.addMountFs("/dev",await wd(n,i,{terminal:r,currentProcessId:0})),await t.createDir("/proc"),r.io.println(ze("Mounting proc filesystem")),await t.addMountFs("/proc",new ma(i)),await t.createDir("/tmp"),r.io.println(ze("Mounting temp filesystem")),await t.addMount(void 0,"",void 0,"/tmp","vfs",0n,{});let a;try{r.io.println(ze("Opening file descriptors for the init system")),a=await mg(t)}catch(o){r.io.println(ze(`Cannot create file descriptor table for init process: ${o}`));return}r.io.println(ze("Starting init")),await i.spawnProcess(null,null,"/usr/bin/wash",a,e.init,Es,!1,on,{maj:1,min:0})}async function Ag(r){r("Starting purge...");let e=await navigator.storage.getDirectory();r("Cleaning storage...");for await(let t of e.keys())r(`Removing ${t}...`),await e.removeEntry(t,{recursive:!0});r("Cleaning metadata..."),await new Promise(t=>{window.indexedDB.databases().then(n=>{Promise.all(n.map(i=>{window.indexedDB.deleteDatabase(i.name)})).then(t)})}),r("Purge complete")}Object.defineProperties(window,{jswasiInit:{value:wg,writable:!1},jswasiTeardown:{value:Ag,writable:!1}});
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/**
 * @license BitSet.js v5.0.3 4/3/2018
 * http://www.xarg.org/2014/03/javascript-bit-array/
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
}
